
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>G-Z</title>
    <link rel="icon" href="https://firebasestorage.googleapis.com/v0/b/genz-abb36.firebasestorage.app/o/file_00000000182461f694cccea0b9e89e1f.png?alt=media&token=3fda1ca9-1d47-4b35-9b07-af86c3098c41">
    <link href="https://fonts.googleapis.com/css2?family=Billabong&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#000000">
    <link rel="apple-touch-icon" href="https://firebasestorage.googleapis.com/v0/b/genz-abb36.firebasestorage.app/o/file_00000000182461f694cccea0b9e89e1f.png?alt=media&token=3fda1ca9-1d47-4b35-9b07-af86c3098c41">
    <link rel="manifest" id="manifest-placeholder">
    <style>
        /* Style pour l'écran de chargement en noir */
        body {
            background-color: #000000;
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }
        
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000000;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease-out;
        }
        
        .splash-icon {
            width: 100px;
            height: 100px;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(0.8); opacity: 0.7; }
            50% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0.8); opacity: 0.7; }
        }
    </style>
</head>
<body>
    <!-- Écran de chargement -->
    <div class="splash-screen" id="splash-screen">
        <img src="https://firebasestorage.googleapis.com/v0/b/genz-abb36.firebasestorage.app/o/file_00000000182461f694cccea0b9e89e1f.png?alt=media&token=3fda1ca9-1d47-4b35-9b07-af86c3098c41" alt="Logo" class="splash-icon">
    </div>
    
    <!-- Contenu principal de la page (qui sera affiché après le chargement) -->
    <div id="main-content" style="display: none;">
        <!-- Votre contenu principal ici -->
    </div>
    
    <script>
        // Création dynamique du fichier manifest
        const manifestData = {
            "name": "Flower of life",
            "short_name": "Flower",
            "description": "G-Z Application",
            "start_url": "/",
            "display": "standalone",
            "background_color": "#000000",
            "theme_color": "#000000",
            "icons": [
                {
                    "src": "https://firebasestorage.googleapis.com/v0/b/genz-abb36.firebasestorage.app/o/file_00000000182461f694cccea0b9e89e1f.png?alt=media&token=3fda1ca9-1d47-4b35-9b07-af86c3098c41",
                    "sizes": "192x192",
                    "type": "image/png"
                },
                {
                    "src": "https://firebasestorage.googleapis.com/v0/b/genz-abb36.firebasestorage.app/o/file_00000000182461f694cccea0b9e89e1f.png?alt=media&token=3fda1ca9-1d47-4b35-9b07-af86c3098c41",
                    "sizes": "512x512",
                    "type": "image/png"
                }
            ]
        };
        
        const blob = new Blob([JSON.stringify(manifestData)], {type: 'application/json'});
        const manifestURL = URL.createObjectURL(blob);
        document.querySelector('#manifest-placeholder').setAttribute('href', manifestURL);
        
        // Simulation de chargement et affichage du contenu principal
        window.addEventListener('load', function() {
            // Simuler un temps de chargement (peut être ajusté ou remplacé par votre vrai logique)
            setTimeout(function() {
                // Masquer l'écran de chargement
                const splashScreen = document.getElementById('splash-screen');
                splashScreen.style.opacity = '0';
                
                // Afficher le contenu principal
                setTimeout(function() {
                    splashScreen.style.display = 'none';
                    document.getElementById('main-content').style.display = 'block';
                }, 500); // Attendre que l'animation de fondu soit terminée
            }, 1500); // 2 secondes de chargement simulé
        });
    </script>
</body>
</html>
    <style>
        input, textarea, select, button {
            font-size: 16px;
            touch-action: manipulation;
        }
        
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: white;
            position: relative;
            transition: background-color 0.3s ease;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            -webkit-text-size-adjust: 100%;
        }
        header {
            background-color: white;
            padding: 6px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: background-color 0.3s ease;
        }
        
        h1 {
            margin: 0;
            font-size: 1.4em;
            font-family: 'Billabong', cursive;
            color: #007bff;
            border: 2px solid #007bff;
            padding: 4px;
            border-radius: 12px;
            font-weight: bold;
            transition: color 0.3s ease, border-color 0.3s ease;
        }
        .divider {
            height: 0.6px;
            background-color: #007bff;
            width: 100%;
            margin-top: 5px;
            transition: background-color 0.3s ease;
        }
        .button-container {
            display: flex;
            justify-content: center;
            margin-top: 5px;
            padding: 5px 0;
            overflow-x: auto;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        .button-container::-webkit-scrollbar {
            display: none;
        }
        .button {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 5px 10px;
            margin: 0 3px;
            font-size: 0.8em;
            cursor: pointer;
            text-decoration: none;
            display: flex;
            align-items: center;
            flex-shrink: 0;
            transition: background-color 0.3s ease;
        }
        .button i {
            margin-right: 2px;
        }
        .notification {
            text-align: center;
            margin-top: 10px;
            font-size: 0.8em;
            color: #0056b3;
            font-weight: bold;
            transition: color 0.3s ease;
            padding: 3px 0;
            max-height: 30px;
            overflow: hidden;
        }
        .share-icon {
            color: #007bff;
            cursor: pointer;
            font-size: 1.3em;
            border: 1px solid #007bff;
            border-radius: 7px;
            padding: 4px;
            background-color: white;
            transition: color 0.3s ease, border-color 0.3s ease;
        }
        footer {
            background-color: white;
            color: black;
            padding: 10px 15px;
            margin-top: auto;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo-container {
            display: flex;
        }
        .logo {
            color: #007bff;
            font-size: 1.6em;
            margin-right: 10px;
            border: 1px solid #007bff;
            border-radius: 10px;
            padding: 5px;
            background-color: rgba(0, 119, 190, 0.1);
            transition: background-color 0.3s, color 0.3s, border-color 0.3s;
        }
        .logo:hover {
            background-color: #007bff;
            color: white;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.5);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .modal.show {
            opacity: 1;
        }
        .modal-content {
            background-color: white;
            margin: 50% auto;
            padding: 14px;
            border: 1px solid #007bff;
            border-radius: 60px;
            width: 280px;
            max-width: 70%;
            text-align: center;
            max-height: 60vh;
            overflow-y: auto;
            position: relative;
            transition: background-color 0.3s ease, border-color 0.3s ease, transform 0.3s ease;
            transform: scale(0.8);
        }
        .modal.show .modal-content {
            transform: scale(1);
        }
        .modal-header {
            font-size: 1.8em;
            font-family: 'Billabong', cursive;
            margin-bottom: 10px;
            font-weight: bold;
            color: #007bff;
            text-decoration: underline;
            transition: color 0.3s ease;
        }
        
        .modal-footer {
            margin-top: 15px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 6px;
        }
        .close-button {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 12px;
            padding: 8px 10px;
            cursor: pointer;
            font-size: 0.9em;
            width: 120px;
            margin: 4px;
            transition: background-color 0.3s ease;
        }
        .close-button:hover {
            background-color: #0056b3;
        }
        
        @keyframes flowerRotate {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(15deg); }
            50% { transform: rotate(0deg); }
            75% { transform: rotate(-15deg); }
            100% { transform: rotate(0deg); }
        }
        
        .flower-icon {
            display: inline-block;
            animation: flowerRotate 2s infinite ease-in-out;
            color: #ff69b4;
        }
        
        .billabong-title {
            font-family: 'Billabong', cursive;
            font-size: 1.8em;
            margin-bottom: 8px;
            color: #007bff;
            transition: color 0.3s ease;
        }

        .monthly-motivation {
            margin: 15px 0;
            padding: 10px;
            border: 1px dashed #ff69b4;
            border-radius: 15px;
            background-color: white;
            font-style: italic;
            color: #333;
            font-size: 0.9em;
            line-height: 1.4;
            transition: border-color 0.3s ease, color 0.3s ease, background-color 0.3s ease;
            position: relative;
        }
        
        .flower-code {
            display: block;
            font-weight: bold;
            color: #ff69b4;
            font-size: 0.9em;
            margin-bottom: 8px;
            letter-spacing: 0.5px;
            background-color: #fff0f8;
            padding: 6px;
            border-radius: 8px;
            border: 1px solid #ff69b4;
            max-width: 220px;
            margin-left: auto;
            margin-right: auto;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            transition: color 0.3s ease, background-color 0.3s ease, border-color 0.3s ease;
        }
        
        .copy-icon {
            color: #007bff;
            cursor: pointer;
            margin-left: 10px;
            font-size: 1.2em;
            vertical-align: middle;
            transition: color 0.3s ease;
        }
        
        .header-controls {
            display: flex;
            align-items: center;
        }
        
        .celebrate-icon {
            font-size: 2em;
            color: gold;
            margin-bottom: 8px;
            animation: celebrate 2s infinite alternate;
        }
        
        @keyframes celebrate {
            0% { transform: scale(1); }
            50% { transform: scale(1.1) rotate(5deg); }
            100% { transform: scale(1) rotate(-5deg); }
        }
        
        .modal-close {
            position: absolute;
            top: 10px;
            right: 20px;
            color: #ff0000;
            font-size: 13px;
            cursor: pointer;
            background-color: transparent;
            border: none;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background-color 0.2s;
        }
        
        .modal-close:hover {
            background-color: rgba(255, 0, 0, 0.1);
        }
        
        .share-flower-button {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 14px;
            padding: 8px 16px;
            font-size: 0.9em;
            margin: 290px auto;
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s, border-color 0.3s;
            max-width: 190px;
            position: relative;
            z-index: 1001;
            border: 1px solid #0056b3;
        }
        
        .share-flower-button:hover {
            background-color: #0056b3;
        }
        
        .share-flower-button i {
            margin-left: 8px;
        }
        
        #capturedFlower {
            position: fixed;
            z-index: 1003;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .captured-image-container {
            position: relative;
            max-width: 85%;
            max-height: 60vh;
            margin-bottom: 15px;
        }
        
        .captured-image {
            max-width: 100%;
            max-height: 60vh;
            border-radius: 15px;
            border: 2px solid white;
        }
        
        .share-message {
            background-color: white;
            color: #333;
            padding: 10px 15px;
            border-radius: 15px;
            font-size: 0.9em;
            margin: 10px auto;
            max-width: 90%;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        .share-message i {
            margin-left: 8px;
            color: #007bff;
            transition: color 0.3s ease;
        }
        
        .share-link {
            color: #007bff;
            font-weight: bold;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .capture-controls {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }
        
        .capture-button {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 20px;
            padding: 8px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9em;
            transition: background-color 0.3s ease;
        }
        
        .capture-button i {
            margin-right: 5px;
        }
        
        .close-capture {
            background-color: #f0f0f0;
            color: #333;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        #flowerCaptureContainer {
            position: fixed;
            z-index: -1;
            top: 0;
            left: -9999px;
            background-color: white;
            border: 2px solid #007bff;
            border-radius: 20px;
            padding: 15px;
            width: 300px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }
        
        .capture-flower-header {
            font-family: 'Billabong', cursive;
            color: #007bff;
            font-size: 1.8em;
            margin-bottom: 8px;
            text-align: center;
            font-weight: bold;
            text-shadow: 0px 1px 1px rgba(0, 123, 255, 0.2);
            transition: color 0.3s ease;
        }
        
        .capture-flower-code {
            font-weight: bold;
            color: #ff69b4;
            font-size: 0.8em;
            background-color: #fff0f8;
            padding: 6px;
            border-radius: 10px;
            border: 1px solid #ff69b4;
            margin: 6px auto;
            text-align: center;
            max-width: 80%;
            letter-spacing: 0.5px;
            transition: color 0.3s ease, background-color 0.3s ease, border-color 0.3s ease;
        }
        
        .capture-flower-motivation {
            font-style: italic;
            color: #333;
            font-size: 0.95em;
            line-height: 1.4;
            background-color: #f9f9f9;
            border: 1px dashed #ff69b4;
            border-radius: 12px;
            padding: 12px;
            margin: 12px 0;
            text-align: center;
            transition: color 0.3s ease, background-color 0.3s ease, border-color 0.3s ease;
            position: relative;
        }
        
        .capture-flower-icon {
            text-align: center;
            font-size: 2.5em;
            color: #ff69b4;
            margin: 10px 0;
            transition: color 0.3s ease;
        }
        
        .gz-logo {
            font-family: 'Billabong', cursive;
            color: #007bff;
            font-size: 1.4em;
            text-align: center;
            margin-top: 10px;
            border: 2px solid #007bff;
            border-radius: 12px;
            padding: 4px;
            width: 50px;
            margin-left: auto;
            margin-right: auto;
            font-weight: bold;
            transition: color 0.3s ease, border-color 0.3s ease;
        }
        
        .share-warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
            border-radius: 15px;
            padding: 10px 15px;
            font-size: 0.85em;
            margin: 5px auto 15px auto;
            max-width: 90%;
            text-align: center;
            display: none;
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }
        
        .capture-website-url {
            text-align: center;
            font-size: 0.85em;
            color: #007bff;
            font-weight: bold;
            margin-top: 8px;
            font-family: Arial, sans-serif;
            padding: 3px 0;
            border-top: 1px dashed #007bff;
            transition: color 0.3s ease, border-color 0.3s ease;
        }
        
        .terms-text {
            font-size: 0.8em;
            color: black;
            text-align: center;
            margin: 10px auto;
            width: 330px;
            transition: color 0.3s ease;
        }
        
        .billabong-title {
            margin-bottom: 3px;
        }

        .header-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            padding: 0 1px;
        }

        .header-icon {
            font-size: 1.4em;
            color: #007bff;
            border: 2px solid #007bff;
            padding: 4px;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            transition: color 0.3s ease, border-color 0.3s ease;
        }

        .app-logo {
            font-family: 'Billabong', cursive;
            color: #007bff;
            border: 2px solid #007bff;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 1.4em;
            font-weight: bold;
            transition: color 0.3s ease, border-color 0.3s ease;
        }

        .header-flex {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
        }
        
        .right-controls {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        #welcomeToast {
            position: fixed;
            top: 160px;
            left: 0;
            right: 0;
            background-color: rgba(0,0,0,0.7);
            color: white;
            padding: 10px;
            border-radius: 20px;
            width: 80%;
            max-width: 300px;
            margin: 0 auto;
            text-align: center;
            z-index: 2000;
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease;
            font-family: , cursive;
            font-size: 1.1em;
            border: 2px solid #4CAF50;
        }

        #welcomeModal {
            display: none;
            position: fixed;
            z-index: 10;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        #welcomeModal.show {
            opacity: 1;
        }

        #welcomeModal .modal-content {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            margin: 40% auto;
            padding: 15px 10px;
            border: 2px solid #4CAF50;
            border-radius: 25px;
            width: 85%;
            max-width: 290px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            text-align: center;
            transition: transform 0.3s ease;
            transform: scale(0.8);
        }
        #welcomeModal.show .modal-content {
            transform: scale(1);
        }

        #welcomeModal .close {
            color: red;
            font-size: 18px;
            font-weight: bold;
            display: block;
            text-align: center;
            margin-bottom: 3px;
            cursor: pointer;
        }

        #welcomeModal .welcome-header {
            color: #007bff;
            font-family: 'Billabong', cursive;
            font-size: 1.8em;
            margin-bottom: 8px;
            text-align: center;
            font-weight: bold;
        }

        #welcomeModal .welcome-text {
            margin: 10px 0 15px 0;
            font-size: 0.8em;
            color: #333;
            line-height: 1.4;
            transition: color 0.3s ease;
        }

        .dob-container {
            margin: 10px 0;
        }

        .dob-container label {
            display: block;
            font-size: 0.8em;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }

        .dob-input {
            width: 90%;
            padding: 8px;
            border-radius: 10px;
            border: 1px solid #ccc;
            font-size: 16px;
        }

        .profession-container {
            margin: 12px 0;
            position: relative;
        }

        .profession-container label {
            display: block;
            font-size: 0.8em;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }

        .profession-search {
            width: 90%;
            padding: 8px;
            border-radius: 10px;
            border: 1px solid #ccc;
            font-size: 16px;
        }

        .profession-dropdown {
            display: none;
            position: absolute;
            background-color: white;
            border: 1px solid #ccc;
            border-radius: 10px;
            width: 90%;
            max-height: 150px;
            overflow-y: auto;
            left: 5%;
            z-index: 10;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .profession-option {
            padding: 8px 10px;
            font-size: 0.8em;
            cursor: pointer;
            transition: background-color 0.2s;
            background-color: white;
            color: #333;
        }

        .profession-option:hover {
            background-color: #f5f5f5;
        }

        .name-container {
            margin: 10px 0;
        }

        .name-container label {
            display: block;
            font-size: 0.8em;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }

        .name-input {
            width: 90%;
            padding: 8px;
            border-radius: 10px;
            border: 1px solid #ccc;
            font-size: 16px;
        }

        #createAccountButton {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 10px 25px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: bold;
            margin: 10px auto 5px;
            display: block;
            width: 80%;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 123, 255, 0.3);
        }
        
        #createAccountButton:hover {
            background: linear-gradient(135deg, #0056b3 0%, #003d80 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 123, 255, 0.4);
        }
        
        #createAccountButton:active {
            transform: translateY(0);
            box-shadow: 0 1px 3px rgba(0, 123, 255, 0.3);
        }

        .loading-spinner {
            display: none;
            text-align: center;
            margin: 10px 0;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }

        .loading-dots::after {
            content: '...';
            animation: dots 1.5s infinite;
            display: inline-block;
            width: 20px;
            text-align: left;
        }

        #idModal {
            display: none;
            position: fixed;
            z-index: 1001;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        #idModal.show {
            opacity: 1;
        }

        #idModal .modal-content {
            background-color: #fff;
            margin: 45% auto;
            padding: 15px;
            border: 1px solid #007BFF;
            border-radius: 25px;
            width: 65%;
            max-width: 250px;
            text-align: center;
            transition: transform 0.3s ease;
            transform: scale(0.8);
        }
        #idModal.show .modal-content {
            transform: scale(1);
        }

        .id-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }

        .id-title {
            font-size: 1em;
            color: #007bff;
            margin-bottom: 5px;
            transition: color 0.3s ease;
        }

        .id-display {
            font-weight: bold;
            font-size: 1.2em;
            color: #ff69b4;
            background-color: #fff0f8;
            padding: 6px;
            border-radius: 8px;
            border: 1px solid #ff69b4;
            margin: 5px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            max-width: 80%;
            transition: color 0.3s ease, background-color 0.3s ease, border-color 0.3s ease;
        }

        .delete-account {
            background-color: #ff4d4d;
            color: white;
            border: none;
            border-radius: 12px;
            padding: 6px 10px;
            font-size: 0.7em;
            cursor: pointer;
            transition: background-color 0.3s;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .delete-account:hover {
            background-color: #e60000;
        }

        .copy-icon {
            margin-left: 6px;
        }

        .id-message {
            font-size: 0.7em;
            color: #333;
            margin: 5px 0;
            transition: color 0.3s ease;
        }

        #idModal .close-button {
            margin-top: 8px;
            width: auto;
            padding: 6px 15px;
            font-size: 0.7em;
            height: 28px;
        }

        .menu-link {
            text-decoration: none;
            color: #007bff;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: color 0.3s ease;
        }
        
        .style-selector {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: white;
            padding: 10px 0;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 100;
            transition: background-color 0.3s ease;
        }
        
        .style-selector h3 {
            text-align: center;
            margin: 0 0 10px 0;
            font-size: 1em;
            color: #333;
            transition: color 0.3s ease;
        }
        
        .style-options {
            display: flex;
            justify-content: center;
            gap: 10px;
            padding: 0 5px;
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .style-options::-webkit-scrollbar {
            display: none;
        }
        
        .style-option {
            width: 60px;
            height: 40px;
            border-radius: 10px;
            cursor: pointer;
            flex-shrink: 0;
            position: relative;
            border: 1px solid #ddd;
            overflow: hidden;
        }
        
        .style-option.selected {
            border: 2px solid white;
            box-shadow: 0 0 0 2px #007bff;
        }
        
        .style-option.red-black {
            background: linear-gradient(to right, #FF4500, #8B0000, #121212, #121212);
        }
        
        .style-option.green-blue {
            background: linear-gradient(to right, #3EB489, #14532D, #0A2239, #1A2E4D);
        }
        
        .style-option.orange-pink {
            background: linear-gradient(to right, #FF7F50, #FF6F91, #C71585, #4B0082);
        }
        
        .style-option.yellow-purple {
            background: linear-gradient(to right, #FFD700, #FFA500, #8A2BE2, #4B0082);
        }
        
        .style-option.default {
            background: linear-gradient(to right, #007bff, #0056b3);
        }
        
        .main-content {
            padding-bottom: 80px;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
        }
        
        body.theme-default {
            background-color: white;
            color: #333;
        }
        
        body.theme-default header, 
        body.theme-default footer,
        body.theme-default .style-selector {
            background-color: white;
        }
        
        body.theme-default .app-logo,
        body.theme-default .header-icon,
        body.theme-default .divider,
        body.theme-default .notification,
        body.theme-default .billabong-title,
        body.theme-default .gz-logo,
        body.theme-default .capture-website-url,
        body.theme-default .capture-flower-header,
        body.theme-default .id-title {
            color: #007bff;
            border-color: #007bff;
        }
        
        body.theme-default .notification .notification-text {
            color: #007bff;
        }
        
        body.theme-default .button {
            background-color: #007bff;
        }
        
        body.theme-default .share-flower-button {
            background-color: #007bff;
            color: white;
            border-color: #0056b3;
        }
        
        body.theme-default .flower-code,
        body.theme-default .id-display {
            color: #ff69b4;
            background-color: #fff0f8;
            border-color: #ff69b4;
        }
        
        body.theme-default .monthly-motivation,
        body.theme-default .capture-flower-motivation {
            border-color: #ff69b4;
            color: #333;
            background-color: white;
        }
        
        body.theme-default .modal-content {
            background-color: white;
            border-color: #007bff;
        }
        
        body.theme-red-black {
            background: black;
            color: #E5E5E5;
        }
        
        body.theme-red-black header, 
        body.theme-red-black footer,
        body.theme-red-black .style-selector {
            background-color: black;
        }
        
        body.theme-red-black .app-logo,
        body.theme-red-black .header-icon,
        body.theme-red-black .gz-logo,
        body.theme-red-black .capture-flower-header,
        body.theme-red-black .capture-website-url,
        body.theme-red-black .id-title,
        body.theme-red-black .billabong-title {
            color: #FF4500;
            border-color: #FF4500;
        }
        
        body.theme-red-black .divider {
            background-color: #FF4500;
        }
        
        body.theme-red-black .notification .notification-text {
            color: #FF4500;
        }
        
        body.theme-red-black .notification,
        body.theme-red-black .welcome-text,
        body.theme-red-black .id-message {
            color: #CCCCCC;
        }
        
        body.theme-red-black .button {
            background-color: #8B0000;
        }
        
        body.theme-red-black .share-flower-button {
            background-color: #8B0000;
            color: white;
            border-color: #FF4500;
        }
        
        body.theme-red-black .flower-code,
        body.theme-red-black .id-display {
            color: #FF4500;
            background-color: black;
            border-color: #FF4500;
        }
        
        body.theme-red-black .monthly-motivation,
        body.theme-red-black .capture-flower-motivation {
            border-color: #FF4500;
            color: #E5E5E5;
            background-color: black;
        }
        
        body.theme-red-black .modal-content,
        body.theme-red-black #flowerCaptureContainer {
            background-color: black;
            border-color: #8B0000;
        }
        
        body.theme-green-blue {
            background: #1A2E4D;
            color: #F5F5F5;
        }
        
        body.theme-green-blue header, 
        body.theme-green-blue footer,
        body.theme-green-blue .style-selector {
            background-color: #1A2E4D;
        }
        
        body.theme-green-blue .app-logo,
        body.theme-green-blue .header-icon,
        body.theme-green-blue .gz-logo,
        body.theme-green-blue .capture-flower-header,
        body.theme-green-blue .capture-website-url,
        body.theme-green-blue .id-title,
        body.theme-green-blue .billabong-title {
            color: #3EB489;
            border-color: #3EB489;
        }
        
        body.theme-green-blue .divider {
            background-color: #3EB489;
        }
        
        body.theme-green-blue .notification .notification-text {
            color: #3EB489;
        }
        
        body.theme-green-blue .notification,
        body.theme-green-blue .welcome-text,
        body.theme-green-blue .id-message {
            color: #A0A0A0;
        }
        
        body.theme-green-blue .button {
            background-color: #14532D;
        }
        
        body.theme-green-blue .share-flower-button {
            background-color: #14532D;
            color: white;
            border-color: #3EB489;
        }
        
        body.theme-green-blue .flower-code,
        body.theme-green-blue .id-display {
            color: #3EB489;
            background-color: #36454F;
            border-color: #3EB489;
        }
        
        body.theme-green-blue .monthly-motivation,
        body.theme-green-blue .capture-flower-motivation {
            border-color: #3EB489;
            color: #F5F5F5;
            background-color: #1A2E4D;
        }
        
        body.theme-green-blue .modal-content,
        body.theme-green-blue #flowerCaptureContainer {
            background-color: #1A2E4D;
            border-color: #3EB489;
        }
        
        body.theme-orange-pink {
            background: #4B0082;
            color: #FFFFFF;
        }
        
        body.theme-orange-pink header, 
        body.theme-orange-pink footer,
        body.theme-orange-pink .style-selector {
            background-color: #4B0082;
        }
        
        body.theme-orange-pink .app-logo,
        body.theme-orange-pink .header-icon,
        body.theme-orange-pink .gz-logo,
        body.theme-orange-pink .capture-flower-header,
        body.theme-orange-pink .capture-website-url,
        body.theme-orange-pink .id-title,
        body.theme-orange-pink .billabong-title {
            color: #FF7F50;
            border-color: #FF7F50;
        }
        
        body.theme-orange-pink .divider {
            background-color: #FF7F50;
        }
        
        body.theme-orange-pink .notification .notification-text {
            color: #FF7F50;
        }
        
        body.theme-orange-pink .notification,
        body.theme-orange-pink .welcome-text,
        body.theme-orange-pink .id-message {
            color: #D3D3D3;
        }
        
        body.theme-orange-pink .button {
            background-color: #C71585;
        }
        
        body.theme-orange-pink .share-flower-button {
            background-color: #C71585;
            color: white;
            border-color: #FF7F50;
        }
        
        body.theme-orange-pink .flower-code,
        body.theme-orange-pink .id-display {
            color: #FF7F50;
            background-color: #6A0DAD;
            border-color: #FF7F50;
        }
        
        body.theme-orange-pink .monthly-motivation,
        body.theme-orange-pink .capture-flower-motivation {
            border-color: #FF7F50;
            color: #FFFFFF;
            background-color: #4B0082;
        }
        
        body.theme-orange-pink .modal-content,
        body.theme-orange-pink #flowerCaptureContainer {
            background-color: #4B0082;
            border-color: #FF7F50;
        }

        body.theme-yellow-purple {
            background: #4B0082;
            color: #FFFFFF;
        }
        
        body.theme-yellow-purple header, 
        body.theme-yellow-purple footer,
        body.theme-yellow-purple .style-selector {
            background-color: #4B0082;
        }
        
        body.theme-yellow-purple .app-logo,
        body.theme-yellow-purple .header-icon,
        body.theme-yellow-purple .gz-logo,
        body.theme-yellow-purple .capture-flower-header,
        body.theme-yellow-purple .capture-website-url,
        body.theme-yellow-purple .id-title,
        body.theme-yellow-purple .billabong-title {
            color: #FFD700;
            border-color: #FFD700;
        }
        
        body.theme-yellow-purple .divider {
            background-color: #FFD700;
        }
        
        body.theme-yellow-purple .notification .notification-text {
            color: #FFD700;
        }
        
        body.theme-yellow-purple .notification,
        body.theme-yellow-purple .welcome-text,
        body.theme-yellow-purple .id-message {
            color: #D3D3D3;
        }
        
        body.theme-yellow-purple .button {
            background-color: #8A2BE2;
        }
        
        body.theme-yellow-purple .share-flower-button {
            background-color: #8A2BE2;
            color: white;
            border-color: #FFD700;
        }
        
        body.theme-yellow-purple .flower-code,
        body.theme-yellow-purple .id-display {
            color: #FFD700;
            background-color: #6A0DAD;
            border-color: #FFD700;
        }
        
        body.theme-yellow-purple .monthly-motivation,
        body.theme-yellow-purple .capture-flower-motivation {
            border-color: #FFD700;
            color: #FFFFFF;
            background-color: #4B0082;
        }
        
        body.theme-yellow-purple .modal-content,
        body.theme-yellow-purple #flowerCaptureContainer {
            background-color: #4B0082;
            border-color: #FFD700;
        }
        
        .refresh-motivation {
            position: absolute;
            right: 15px;
            top: 70px;
            color: #007bff;
            cursor: pointer;
            font-size: 1.2em;
            padding: 5px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transition: transform 0.3s ease, color 0.3s ease;
        }
        
        .refresh-motivation:hover {
            transform: rotate(180deg);
        }
        
        body.theme-red-black .refresh-motivation {
            color: #FF4500;
        }
        
        body.theme-green-blue .refresh-motivation {
            color: #3EB489;
        }
        
        body.theme-orange-pink .refresh-motivation {
            color: #FF7F50;
        }
        
        body.theme-yellow-purple .refresh-motivation {
            color: #FFD700;
        }
        
        .user-name {
            font-size: 0.75em;
            font-weight: bold;
        }

        .install-prompt {
            display: none;
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 0.9em;
            z-index: 1000;
            width: 80%;
            max-width: 300px;
            text-align: center;
        }
        
        .install-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .install-btn {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            font-size: 0.8em;
            cursor: pointer;
        }
        
        .dismiss-btn {
            background-color: transparent;
            color: #ccc;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 5px 10px;
            font-size: 0.8em;
            cursor: pointer;
        }
    </style>
</head>
<body class="theme-green-blue">

  <header>
   
    <div class="header-container">
      <div class="app-logo">G-Z</div>
      
      <div class="right-controls">
        
   
        <div class="header-icon" id="showIdButton"><i class="fas fa-user"></i></div>
        
         <a href="https://g-z.online/translate.html" class="header-icon menu-link"><i class="fas fa-globe"></i></a>
        
        <a href="https://g-z.online/us.html" class="header-icon menu-link"><i class="fas fa-bars"></i></a>
      </div>
    </div>
  </header>

  <div class="divider"></div>

  <div class="main-content">
    <div class="button-container">
      <a class="button" href="#" id="flowerButton"><i class="fas fa-spa flower-icon"></i><span>የህይወት አበባ</span></a>
      
    

    </div>

    <div class="divider"></div>
    <div class="notification">
      <span class="notification-text">💠 አበባ -- ህዋስ ለእርስዎ ብቻ የጻፈው መልእክት ¯\_(ツ)_/¯</span>
    </div>

    <div class="divider"></div>
  </div>

  <div class="style-selector">
    <h3>ዘይቤ</h3>
    <div class="style-options">
      <div class="style-option red-black" data-theme="red-black"></div>
      <div class="style-option green-blue selected" data-theme="green-blue"></div>
      <div class="style-option orange-pink" data-theme="orange-pink"></div>
      <div class="style-option yellow-purple" data-theme="yellow-purple"></div>
      <div class="style-option default" data-theme="default"></div>
    </div>
  </div>

  <div id="welcomeToast">
    
    ከሁለቱ 'የህይወት አበባ' አንዱን ጠቅ ያድርጉ
  </div>

  <div id="welcomeModal" class="modal">
    <div class="modal-content">
      <div class="welcome-header">💠 እንኳን ደህና መጡ 💠</div>
      <div class="welcome-text">
         ¯\_(ツ)_/¯
      </div>
      
      <div class="name-container">
        <label for="fullNameInput">ሙሉ ስምዎ:</label>
        <input type="text" id="fullNameInput" class="name-input" placeholder="ሙሉ ስምዎን ያስገቡ...">
      </div>
      
      <div class="dob-container">
        <label for="dobInput">የልደት ቀን:</label>
        <input type="date" id="dobInput" class="dob-input" max="">
      </div>
      
      <div class="profession-container">
        <label for="professionInput">ሙያዎ:</label>
        <input type="text" id="professionInput" class="profession-search" placeholder="ሙያዎን ይጻፉ...">
        <div id="professionDropdown" class="profession-dropdown"></div>
      </div>
      
      <div class="loading-spinner" id="loadingSpinner">
        <span>የእርስዎን ልዩ አበባ በመፍጠር ላይ</span>
        <span class="loading-dots"></span>
      </div>
      
      <button id="createAccountButton">አካውንት ይፍጠሩ</button>
    </div>
  </div>

  <div id="idModal" class="modal">
    <div class="modal-content">
      <div class="id-title">የተጠቃሚ መታወቂያዎ</div>
      <div class="id-display">
        <span id="userIdDisplay"></span>
        <i class="fas fa-copy copy-icon" id="copyIdButton"></i>
      </div>
      <div class="id-message">ይህን መታወቂያ በጥንቃቄ ይያዙ!</div>
      <div class="id-actions">
        <button class="delete-account" id="deleteAccountButton">አካውንት ሰርዝ</button>
        <button class="close-button" id="closeIdModal">ዝጋ</button>
      </div>
    </div>
  </div>

  <div id="flowerModal" class="modal">
    <div class="modal-content">
      <button class="modal-close" id="closeFlowerModal"><i class="fas fa-times"></i></button>
      <div class="billabong-title"><strong id="flowerTypeTitle">የህይወት አበባ</strong></div>
      
      <div id="flowerCodeDisplay" class="flower-code"></div>
      
      <i class="fas fa-sync-alt refresh-motivation" id="refreshMotivation" title="አዲስ ማነሳሻ ፍጠር"></i>
      
      <div class="monthly-motivation" id="monthlyMotivation">
      </div>
      
      <div style="margin: 10px auto; font-size: 3em; color: #ff69b4;" id="flowerIconContainer">
        <i class="fas fa-spa"></i>
      </div>
    </div>
  </div>
  
  <button class="share-flower-button" id="shareFlowerButton">
    <span>አበባዬን አጋራ</span> <i class="fas fa-arrow-right send-icon"></i>
  </button>
  
  <div id="capturedFlower">
    <div class="captured-image-container">
      <img id="capturedImage" class="captured-image" src="" alt="የተያዘ አበባ">
    </div>

    <div class="share-warning" id="shareWarning">
      <i class="fas fa-exclamation-triangle" style="margin-right: 5px;"></i>
      <span>ከgoogle/chrome ለማጋራት ፍጹም።</span>
    </div>
    
    <div class="capture-controls">
      <button class="capture-button" id="shareCapture">
        <i class="fas fa-share"></i> <span>አጋራ</span>
      </button>
      
      <button class="capture-button close-capture" id="closeCapture">
        <i class="fas fa-download"></i> <span>አስቀምጥ</span>
      </button>
    </div>
  </div>
  
  <div id="flowerCaptureContainer">
    <div class="capture-flower-header" id="captureFlowerHeader">የህይወት አበባ</div>
    
    <div id="captureFlowerCode" class="capture-flower-code"></div>
    
    <div id="captureFlowerMotivation" class="capture-flower-motivation">
    </div>
    
    <div class="capture-flower-icon" id="captureFlowerIcon">
      <i class="fas fa-spa"></i>
    </div>
    
    <div class="gz-logo">G-Z</div>
    
    <div class="capture-website-url">የራስዎን በ www.g-z.online ላይ ያግኙ</div>
  </div>

  <div class="install-prompt" id="installPrompt">
    <p>ለተሻለ ልምድ ጂ-ዜድን ወደ ዋና ማያ ገጽዎ ይጨምሩ!</p>
    <div class="install-buttons">
      <button class="install-btn" id="installBtn">ጫን</button>
      <button class="dismiss-btn" id="dismissBtn">በኋላ</button>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCrPKQOqw4zciASa_5PbI_etfkvrBaDPDI",
      authDomain: "genz-abb36.firebaseapp.com",
      databaseURL: "https://genz-abb36-default-rtdb.firebaseio.com",
      projectId: "genz-abb36",
      storageBucket: "genz-abb36.firebasestorage.app",
      messagingSenderId: "405021535683",
      appId: "1:405021535683:web:ee5a28fde27f5558046176",
      measurementId: "G-XZNQND2J00"
    };

    firebase.initializeApp(firebaseConfig);
    
    const auth = firebase.auth();
    const database = firebase.database();
    const firestore = firebase.firestore();
    
    let userUid = null;
    let userFlowerCode = null;
    let currentMotivation = null;
    let currentCountry = null;
    let userCity = null;
    let userUniqueId = null;
    let isAuthenticated = false;
    let isInstalled = false;
    let currentTheme = "green-blue";
    let userDateOfBirth = null;
    let userProfession = null;
    let userFullName = null;
    let seenSubjects = [];
    let shareCount = 0;
    let deferredPrompt = null;

    const professions = [
      "Musician", "Rapper", "Footballer", "Basketball Player", "Boxer", 
      "Student", "Teacher", "Doctor", "Nurse", "Engineer", 
      "Software Developer", "Designer", "Artist", "Writer", "Journalist", 
      "Chef", "Waiter/Waitress", "Housekeeper", "TikToker", "YouTuber", 
      "Influencer", "Photographer", "Videographer", "Dancer", "Actor/Actress", 
      "Model", "Architect", "Lawyer", "Accountant", "Financial Advisor", 
      "Banker", "Entrepreneur", "Business Owner", "Manager", "Executive", 
      "Salesperson", "Marketer", "Social Media Manager", "Driver", "Pilot", 
      "Flight Attendant", "Mechanic", "Electrician", "Plumber", "Construction Worker", 
      "Farmer", "Gardener", "Veterinarian", "Personal Trainer", "Fitness Instructor", 
      "Yoga Teacher", "Therapist", "Psychologist", "Counselor", "Pastor/Religious Leader",
      "Scientist", "Researcher", "Professor", "Police Officer", "Firefighter",
      "Military Personnel", "Security Guard", "Real Estate Agent", "Pharmacist", "Dentist",
      "Optometrist", "Physical Therapist", "Occupational Therapist", "Speech Therapist", "Dietitian",
      "Nutritionist", "Hairdresser", "Makeup Artist", "Esthetician", "Tailor",
      "Fashion Designer", "Retail Worker", "Cashier", "Customer Service Representative", "Call Center Agent",
      "Translator", "Interpreter", "Tour Guide", "Travel Agent", "Hotel Manager",
      "Receptionist", "Secretary", "Administrative Assistant", "Librarian", "Archivist",
      "Historian", "Archaeologist", "Anthropologist", "Sociologist", "Political Scientist",
      "Economist", "Statistician", "Data Analyst", "Data Scientist", "UX/UI Designer",
      "Game Developer", "App Developer", "Web Developer", "Network Administrator", "Cybersecurity Specialist",
      "IT Support", "Technician", "Repair Specialist", "Baker", "Butcher",
      "Fisherman", "Miner", "Forester", "Landscaper", "Interior Designer",
      "Event Planner", "Wedding Planner", "Florist", "Jeweler", "Craftsperson",
      "Programmer", "Web Designer", "Digital Marketer", "SEO Specialist", "Content Creator",
      "Product Manager", "Project Manager", "Quality Assurance", "Business Analyst", "Consultant",
      "Recruiter", "HR Manager", "Career Coach", "Life Coach", "Motivational Speaker",
      "Public Speaker", "Radio Host", "TV Host", "Broadcaster", "Podcaster",
      "Author", "Screenwriter", "Copywriter", "Technical Writer", "Editor",
      "Publisher", "Literary Agent", "Bookstore Owner", "Librarian", "Book Reviewer",
      "Graphic Designer", "Illustrator", "Animator", "3D Artist", "VFX Artist",
      "Film Director", "Producer", "Camera Operator", "Sound Engineer", "Lighting Technician",
      "Film Editor", "Production Assistant", "Set Designer", "Costume Designer", "Makeup Artist for Film",
      "Special Effects Artist", "Stunt Performer", "Voice Actor", "Talent Agent", "Casting Director"
    ];

    const subjectDictionary = {
      "Success": "ስኬት",
      "Achievement": "ውጤት",
      "Victory": "ድል",
      "Triumph": "ድል",
      "Accomplishment": "ስኬት",
      
      "Richest": "ሀብት",
      "Prosperity": "ብልጽግና",
      "Abundance": "ልግስና",
      "Fortune": "ዕድል",
      "Affluence": "ብልጽግና",
      
      "Joy": "ደስታ",
      "Happiness": "ደስታ",
      "Bliss": "እርካታ",
      "Delight": "ሐሴት",
      "Contentment": "እርካታ",
      
      "Growth": "እድገት",
      "Progress": "መሻሻል",
      "Advancement": "እርምጃ",
      "Development": "እድገት",
      "Improvement": "መሻሻል",
      
      "Power": "ኃይል",
      "Strength": "ጥንካሬ",
      "Might": "ብርታት",
      "Force": "ኃይል",
      "Energy": "ጉልበት",
      
      "Wisdom": "ጥበብ",
      "Intelligence": "ብልህነት",
      "Knowledge": "እውቀት",
      "Insight": "ግንዛቤ",
      "Understanding": "መረዳት",
      
      "Creativity": "ፈጠራ",
      "Innovation": "አዲስ ፈጠራ",
      "Imagination": "ሃሳብ",
      "Invention": "ፈጠራ",
      "Originality": "ኦሪጅናልነት",
      
      "Leadership": "መሪነት",
      "Authority": "ስልጣን",
      "Influence": "ተጽእኖ",
      "Command": "ትእዛዝ",
      "Direction": "አቅጣጫ",
      
      "Peace": "ሰላም",
      "Harmony": "መግባባት",
      "Tranquility": "ጸጥታ",
      "Serenity": "ዝግታ",
      "Calm": "ፀጥታ",
      
      "Love": "ፍቅር",
      "Affection": "ፍቅር",
      "Adoration": "አድናቆት",
      "Devotion": "ተቆርቋሪነት",
      "Passion": "ጉጉት",
      
      "Courage": "ድፍረት",
      "Bravery": "ጀግንነት",
      "Valor": "ብርታት",
      "Heroism": "ጀግንነት",
      "Fearlessness": "ፀጋኝነት",
      
      "Health": "ጤና",
      "Vitality": "ጥንካሬ",
      "Wellness": "ደህንነት",
      "Vigor": "ብርታት",
      "Fitness": "ብቃት",
      
      "Freedom": "ነፃነት",
      "Liberty": "ነፃነት",
      "Independence": "ራስ ወደድነት",
      "Autonomy": "ነፃነት",
      "Self-determination": "ራስን መወሰን",
      
      "Purpose": "ዓላማ",
      "Meaning": "ትርጉም",
      "Mission": "ተልዕኮ",
      "Calling": "ጥሪ",
      "Destiny": "ዕጣ ፈንታ",
      
      "Resilience": "ጽናት",
      "Tenacity": "ፅናት",
      "Perseverance": "ተጋድሎ",
      "Endurance": "መቋቋም",
      "Grit": "ጽናት",
      
      "Authenticity": "ትክክለኛነት",
      "Genuineness": "እውነተኛነት",
      "Honesty": "ታማኝነት",
      "Integrity": "ቅንነት",
      "Sincerity": "ልባዊነት",
      
      "Transformation": "ለውጥ",
      "Change": "ለውጥ",
      "Evolution": "እድገት",
      "Rebirth": "ዳግም ልደት",
      "Metamorphosis": "መቀየር",
      
      "Connection": "ግንኙነት",
      "Relationship": "ግንኙነት",
      "Community": "ማህበረሰብ",
      "Belonging": "መካተት",
      "Unity": "አንድነት",
      
      "Gratitude": "ምስጋና",
      "Thankfulness": "ምስጋና",
      "Appreciation": "አድናቆት",
      "Recognition": "እውቅና",
      "Acknowledgment": "ማመስገን",
      
      "Mindfulness": "ንቃተ-ህሊና",
      "Presence": "ተገኝነት",
      "Awareness": "ንቃተ-ህሊና",
      "Consciousness": "ንቃተ-ህሊና",
      "Attentiveness": "ትኩረት",
      
      "Compassion": "ርህራሄ",
      "Empathy": "ርህራሄ",
      "Kindness": "ደግነት",
      "Generosity": "ለጋስነት",
      "Altruism": "ለሰው መልካም መፈለግ",
      
      "Balance": "ሚዛናዊነት",
      "Equilibrium": "ሚዛን",
      "Harmony": "መግባባት",
      "Proportion": "ምጣኔ",
      "Symmetry": "ምጣኔ",
      
      "Inspiration": "ምንጭ",
      "Motivation": "ማነሳሻ",
      "Enthusiasm": "ጉጉት",
      "Excitement": "ጉጉት",
      "Passion": "ስሜት",
      
      "Focus": "ትኩረት",
      "Concentration": "ትኩረት",
      "Attention": "ትኩረት",
      "Discipline": "ስነ-ስርዓት",
      "Dedication": "ቆራጥነት",
      
      "Humility": "ትህትና",
      "Modesty": "ትህትና",
      "Simplicity": "ቀላልነት",
      "Unpretentiousness": "ትህትና",
      "Groundedness": "እርጋታ",
      
      "Patience": "ትዕግስት",
      "Tolerance": "መቻቻል",
      "Forbearance": "ትዕግስት",
      "Endurance": "መቋቋም",
      "Persistence": "ፅናት",
      
      "Joy": "ደስታ",
      "Delight": "ሐሴት",
      "Gladness": "ደስታ",
      "Exultation": "ሐሴት",
      "Jubilation": "ሐሴት",
      
      "Trust": "እምነት",
      "Faith": "እምነት",
      "Confidence": "ራስ መተማመን",
      "Reliance": "መተማመን",
      "Dependability": "ታማኝነት",
      
      "Self-confidence": "በራስ መተማመን",
      "Self-esteem": "ራስን ማድነቅ",
      "Self-belief": "በራስ ማመን",
      "Self-assurance": "ራስን መተማመን",
      "Self-trust": "በራስ መተማመን",
      
      "Enthusiasm": "ጉጉት",
      "Zeal": "ጉጉት",
      "Eagerness": "ጉጉት",
      "Ardor": "ጉጉት",
      "Fervor": "ጉጉት",
      
      "Clarity": "ግልጽነት",
      "Lucidity": "ግልጽነት",
      "Transparency": "ግልጽነት",
      "Precision": "ትክክለኛነት",
      "Sharpness": "ጥራት",
      
      "Adaptability": "መላመድ",
      "Flexibility": "ተለዋዋጭነት",
      "Versatility": "ብቃት",
      "Adjustability": "መስተካከል",
      "Malleability": "ለውጥ",
      
      "Communication": "ግንኙነት",
      "Expression": "መግለጫ",
      "Articulation": "መግለጽ",
      "Dialogue": "ውይይት",
      "Conversation": "ውይይት",
      
      "Career": "ሥራ",
      "Profession": "ሙያ",
      "Vocation": "ሙያ",
      "Occupation": "ሥራ",
      "Calling": "ጥሪ"
    };

    function formatUserName(fullName) {
      if (!fullName) return "";
      
      const nameParts = fullName.trim().split(' ');
      
      if (nameParts.length === 1) {
        return nameParts[0];
      }
      
      const firstName = nameParts[0];
      const lastNameInitial = nameParts[nameParts.length - 1].charAt(0).toUpperCase();
      
      return `👑 ${firstName} ${lastNameInitial}.`;
    }

    function generateUniqueId() {
      const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      const numbers = '0123456789';
      let id = '';
      
      for (let i = 0; i < 3; i++) {
        id += letters.charAt(Math.floor(Math.random() * letters.length));
      }
      
      for (let i = 0; i < 3; i++) {
        id += numbers.charAt(Math.floor(Math.random() * numbers.length));
      }
      
      return id;
    }

    async function detectUserLocation() {
      try {
        const response = await fetch('https://ipapi.co/json/');
        const data = await response.json();
        currentCountry = data.country_name;
        userCity = data.city;
        console.log("Detected user location:", currentCountry, userCity);
        return { country: currentCountry, city: userCity };
      } catch (error) {
        console.error("Error detecting user location:", error);
        return { country: "Unknown", city: "Unknown" };
      }
    }

    function generatePersonalizedMotivation(flowerCode, profession, dob) {
      if (!flowerCode || flowerCode.length < 8) {
        return "This flower motivation is here to inspire and guide you.";
      }
      
      let month = 0;
      if (dob) {
        const dobDate = new Date(dob);
        month = dobDate.getMonth();
      }
      
      const lifeTraits = [
  "ፈጠራ ለምታጋጥሙት ማንኛውም ፈተና አዲስ ሀሳቦችን ያመጣል።",
  "በልብዎ ውስጥ ያለው ደግነት ዙሪያዎን ያሉትን ሰዎች በየቀኑ ያነሳሳል።",
  "ጽናት ሌሎች የማይቻል ብለው የሚያስቡትን እንቅፋቶች እንዲሻገሩ ይረዳዎታል።",
  "ልዩ አመለካከትዎ ችግሮችን በአዲስ መንገድ እንዲፈቱ ያስችልዎታል።",
  "ጉልበት የሞላው ነፍስዎ የሚያገኙትን ሁሉ ቀን ያበራል።",
  "ትዕግስት ሌሎች ማየት በማይችሉበት ጊዜ ትልቁን ስዕል እንዲያዩ ያስችልዎታል።",
  "ድፍረት አዳዲስ ፈተናዎችን በቆራጥነት እንዲገጥሙ ያስችልዎታል።",
  "ጥበብ በአስቸጋሪ ውሳኔዎች ውስጥ በግልጽነት ይመራዎታል።",
  "አዎንታዊ አመለካከት በሚያጋጥምዎ ማንኛውም ሁኔታ ዕድል እንዲያገኙ ይረዳዎታል።",
  "ትኩረት ግቦችን በእርምጃ በእርምጃ በትክክለኛነት እንዲያሳኩ ይገፋፋዎታል።",
  "መቻቻል በሚለዋወጡ ጊዜያት ታላቅ ጥንካሬዎ ይሆናል።",
  "ስሜት ምርጫዎች ግልፅ ባልሆኑበት ጊዜ ወደ ትክክለኛው መንገድ ይመራዎታል።",
  "ርህራሄ ከሌሎች ጋር በጥልቀት በትርጉም ሙላ መንገድ ያገናኝዎታል።",
  "ብርታት ከማንኛውም ችግር በኋላ በጠንካራ ሁኔታ እንዲመለሱ ይረዳዎታል።",
  "ትክክለኛነት ሰዎችን ያለ ማንኛውም ማስመሰል ወደ እውነተኛው ራስዎ ይስባል።",
  "ምስጋና በህይወትዎ ውስጥ ያለውን ደስታ በየቀኑ ያበዛል።",
  "ጉጉት ሌሎች ሊያመልጧቸው ወደሚችሉ አዳዲስ ግኝቶች ይመራል።",
  "የቀልድ ስሜት እጅግ አስቸጋሪ ጊዜያትን እንኳን ያቃልላል።",
  "ለጋስነት የደግነት ሞገዶችን በማህበረሰብዎ ዙሪያ ይፈጥራል።",
  "ቁርጠኝነት ፈተናዎችን ለማክበር የሚያስችሉ ስኬቶች ይቀይራል።",
  "ርህራሄ በዙሪያዎ ያሉትን በቀላል ግን ጠንካራ መንገድ ይፈውሳል።",
  "ግልጽነት ግራ መጋባት በሚከብበት ጊዜ ጥበባዊ ምርጫዎችን እንዲያደርጉ ይረዳዎታል።",
  "ራስ-መተማመን ሌሎች መሪነትዎን የሚከተሉበትን እምነት ያሰርፃል።",
  "ንቃተ ህሊና ሁከትና ዕርግጠኝነት በሌለበት ጊዜም እንኳ ማእከል እንዲቆዩ ያደርግዎታል።",
  "ታማኝነት በእኩዮችዎ እና በመሪዎች መካከል በሚሄዱበት ቦታ ሁሉ አክብሮትን ያስገኝልዎታል።",
  "ጉጉት የእርስዎን ጉልበት የሚመለከቱ ሌሎችን ውስጥ ፍላጎትን ያቀጣጥላል።",
  "ሙቀት ሰዎች በእርስዎ ፊት በአፋጣኝ እንዲሰማቸው ያደርጋል።",
  "ህይለ-ቅኔ ሌሎች ማየት የማይችሉትን እድሎች የሚከፍት በር ነው።",
  "ሚዛናዊነት የህይወትን ውስብስብነት በጸጋ እንዲዳሰሱ ይረዳዎታል።",
  "ራዕይ ሌሎች ሲያጥሩ እርስዎ ከአድማስ ባሻገር እንዲያዩ ያስችልዎታል።",
  "ሳቢነት ሰዎችን ወደ እርስዎ ባለው ተፈጥሯዊ የመሳብ ኃይል ይስባል።",
  "ስነ-ስርዓት በሁሉም ጥረቶች ለስኬት መሰረት ይገነባል።",
  "የመረዳት ባህሪ ሌሎች የሚያመልጧቸውን ቀላል እውነቶች እንዲረዱ ይረዳዎታል።",
  "ቀልደኝነት መንፈስዎን በፈተናዎች ውስጥ ወጣትና ህይወት የሞላው እንዲሆን ይጠብቃል።",
  "የመተንተን አእምሮ ሌሎች ሙሉ በሙሉ የሚያመልጧቸውን መፍትሄዎች ያገኛል።",
  "አሳቢነት ለዘመናት የሚቆዩ ትርጉም ያላቸው ግንኙነቶችን ይፈጥራል።",
  "ስሜታዊነት ሌሎች ሳይጠይቁ የሚፈልጉትን እንዲገነዘቡ ያስችልዎታል።",
  "ወሳኝነት ሌሎች በሚያመነቱበት ጊዜ ፕሮጀክቶችን ወደፊት ይገፋል።",
  "ጠንካራነት በሁሉም ግንኙነቶችዎ ውስጥ በጊዜ ሂደት እምነትን ይገነባል።",
  "መግለጽ እውነትዎን ለዓለም በውብ ሁኔታ ያስተላልፋል።",
  "ብልሃት ገደቦችን ለእድገት እድል ይቀይራል።",
  "ትጋት በሚነኩት ወይም በሚፈጥሩት ነገር ሁሉ ጥራት ያረጋግጣል።",
  "ተለዋዋጭነት ወደ ተለዋዋጭ ሁኔታዎች በልዩ ጸጋ ይላመዳል።",
  "ተግባራዊነት ትልቅ ህልም እያለሙ እርምጃዎችዎን በእውነታ ላይ ያስቀምጣል።",
  "አነጋገር ውስብስብ ሃሳቦችን ለሌሎች በግልጽ እንዲረዱ በግልጽ ያስቀምጣል።",
  "ቅድመ ማሰብ ከመድረሳቸው በፊት ለወደፊት ፈተናዎች እንዲዘጋጁ ይረዳዎታል።",
  "ርህራሄ ቁስሎችን በደቃቅ ልቦች ላይ ጠባሳ ሳያስቀር ይፈውሳል።",
  "ፅኑነት ያለ ማመንታት ለትክክለኛው ነገር ይቆማል።",
  "ነፃነት በችግር ውስጥ በራስ መተማመንና ጥንካሬን ያዳብራል።",
  "ሞራላዊነት ሌሎች ለሚያመልጧቸው ጠቃሚ ዝርዝሮች ትኩረት ይሰጣል።",
  "የአእምሮ ቀልጣፋነት ወደ አዳዲስ ሁኔታዎች በቀላሉ እንዲላመዱ ይረዳዎታል።",
  "ራስን መገንዘብ የእድገትዎን መንገድና መሙላትን ያበራል።",
  "የውስጥ ጥንካሬ በሙከራ አስቸጋሪ ጊዜያት በጣም ይበራል።",
  "ሳቢ ሰውነት ሌሎችን ወደ ቀለብዎ ያለምንም ጥረት ይስባል።",
  "ስሜታዊ ብልህነት ውስብስብ ግንኙነቶችን እንዲዳስሱ ይረዳዎታል።",
  "ፈጣን አስተሳሰብ ሌሎች ችግሮችን ብቻ ሲያዩ መፍትሄዎችን ያገኛል።",
  "ጸጥታ ያለው ራስ-መተማመን ቃል ሳይናገር ብዙ ይናገራል።",
  "ተፈጥሮአዊ አመራር ሌሎች ምርጥ ስሜታቸውን እንዲከተሉ ያነሳሳል።",
  "የማይናወጥ ሥነ-ምግባር በጨለማም ውስጥ ውሳኔዎችን ይመራል።",
  "የሥነ-ጥበብ ስሜት በማይጠበቁ ቦታዎችና ጊዜያት ውስጥ ውበትን ያገኛል።",
  "ስልታዊ አእምሮ የወደፊት ሁኔታዎችን በትክክል ይገምታል።",
  "ድንገተኛነት በአፋጣኝ ወደ ደረቁ ሁኔታዎች አዲስ ጉልበት ያመጣል።",
  "ዝርዝራዊ ትኩረት የወደፊት ውስብስብነቶችን ይከላከላል።",
  "ሰላማዊ ማንነት እጅግ አመጣጣሪ አካባቢዎችን እንኳን ያረጋጋል።",
  "ፈጠራ አስተሳሰብ በተለመዱ ገደቦች ውስጥ ይሰባብራል።",
  "ተፈጥሮአዊ ዲፕሎማሲ ግጭቶችን በጸጋና ፍትሃዊነት ይፈታል።",
  "ታማኝነት ለሚፈልጉት ሰዎች አስተማማኝ ምስጢር ጠባቂ ያደርግዎታል።",
  "ተላላፊ ጉጉት በዙሪያዎ ያሉትን ሁሉ ከፍ ያደርጋል።"
];

const lifeEncouragements = [
  "እነዚህን ስጦታዎች ከዙሪያዎ ካለው ዓለም ጋር መጋራትዎን ይቀጥሉ።",
  "እነዚህን ስሜቶች ይተማመኑ - እነሱ በጣም አልፎ አልፎ ነው የሚያሳቱት።",
  "እነዚህ ተፈጥሯዊ ችሎታዎች ሰፊ ሊካፈሉ የታሰቡ ናቸው።",
  "የቀጣዩ መንገድ ፈተናዎች ሊኖሩት ይችላል፣ ግን ሙሉ በሙሉ ተደራጅተዋል።",
  "ዛሬ ያሉ ትናንሽ እርምጃዎች ወደ ነገ ታላላቅ ስኬቶች ይመራሉ።",
  "በመንገዱ መካከል ባለው እርምጃ መካከል ሁልጊዜ ያክብሩ።",
  "ይህ ልዩ ጉዞ እርስዎ የሚወስዷቸው እርምጃዎች ሁሉ ዋጋ አላቸው።",
  "ውጤቶችን ብቻ ሳይሆን ሂደቱን ማዘናጋት እንዳይረሱ።",
  "ምርጥ ቀናት በዚህ ጀብደኛ ጉዞ ላይ አሁንም ቀጣይ ናቸው።",
  "የዛሬ ጥረቶች የነገን የስኬት ታሪክ እየገነቡ ነው።",
  "በሁሉም ሁኔታዎች እና ፈተናዎች ለራስዎ እውነተኛ ይሁኑ።",
  "ለውጥን እንደ ጠንካራ የማደግ እድል ያቅፉት።",
  "የውስጥ ጥበብን ብዙ ጊዜ ያዳምጡ - መንገዱን ያውቃል።",
  "ሲፈልጉ ያለ ጥፋተኛነት ራስዎን እንዲያርፉ ይፍቀዱ።",
  "በትልቁ ስዕል ውስጥ በእውነት ጠቃሚ በሆነው ላይ ያተኩሩ።",
  "የእርስዎ ማንነት እርስዎን ለማወቅ እድለኛ ለሆኑት ስጦታ ነው።",
  "ምንም ያህል ባተሌ ቢሆኑም ፍላጎቶችን በተከታታይ ያዳብሩ።",
  "በፈተናዎችና ተግዳሮቶች ወቅት ለራስዎ ለዛ ይኑሩ።",
  "ይህ ልዩ መንገድ መሄድ ለሚፈልጉበት ቦታ በትክክል ያስፈልጋል።",
  "የህይወትን ምስጢራዊ ምስጢሮች ለመረዳት ባለው ጊዜ ይተማመኑ።",
  "በየቀኑ ያለማቋረጥ በትናንሽ ቅጽበቶች ውስጥ ደስታን ያግኙ።",
  "ይህ አመለካከት ጠቃሚ ነው - ይበልጥ ይጋሩት።",
  "ትርጉም ያለው ለውጥ ለመፍጠር ባለው ችሎታ ያምኑ።",
  "ይህ ጉዞ በመጀመሪያ ለምን እንደተጀመረ ያስታውሱ።",
  "እያንዳንዱ ቀን አዲስ ጅማሬን ለመጀመር አዲስ እድል ይሰጣል።",
  "ይህ ጽናት ከሚገምቱት በላይ ሌሎችን ያነሳሳል።",
  "በየመንገዱ ትንሽ ድሎችን ለማክበር ጊዜ ይውሰዱ።",
  "የተገጠመው ፈተና ሁሉ ባህሪን በጥልቀት ያጠናክራል።",
  "ኮኖስ ይህን እውነተኛ መንገድ ሙሉ በሙሉ ይደግፋል።",
  "ልቅ ብርሃን እውነተኛነት መንገዱን ሲመራ ብሩህ ይነራል።",
  "ዓለም ይህን ልዩ አስተዋጽኦ እርስዎ ብቻ መስጠት የሚችሉትን ያስፈልጋታል።",
  "ትርጉም ያለው ሥራ ያለ ማብራሪያ ለራሱ ይናገር።",
  "ተከታታይ ጥረት በጊዜ ሂደት ወደ ታላቅነት ይደመራል።",
  "ዛሬ የማይቻል የሚመስለው ነገ እውነታ ይሆናል።",
  "የውስጥ ጥንካሬ ቀጣዩን ፈተና በከፍተኛ ሁኔታ ይበልጣል።",
  "ይህ ጉዞ ከሚታወቀው በላይ ሌሎችን ያነሳሳል።",
  "እንቅፋቶች ወደ የተሻለ መንገድ የሚያመሩ አቅጣጫዎች ብቻ ናቸው።",
  "የባህሪ ጥልቀት በአስቸጋሪ ጊዜያት በጣም በግልጽ ይታያል።",
  "እድገት የሚከሰተው ከምቾት ዞኖች ውጭ እንጂ በውስጣቸው አይደለም።",
  "ትንሽ እድገት እንኳ ድሎች ውዳሴና ዕውቅና ይገባቸዋል።",
  "በአስቸጋሪ ጊዜያት ውስጥ በግል ‹ለምን› ላይ ትኩረት ያድርጉ።",
  "የዕለት ምርጫዎች ለማስታወስ ዋጋ ያለው ዘላቂ ውርስ ይፈጥራሉ።",
  "አሁን የተማሩት ትምህርቶች በበርካታ መንገዶች ለዘላለም ያገለግላሉ።",
  "በሌሎች ላይ ያለውን የደግነት ተጽእኖ በፍጹም አያናንሱ።",
  "እውነተኛ ድምጽ ለመስማት ከሚፈልጉት ጋር ይናገራል።",
  "ዛሬ የተቋቋሙ ፈተናዎች ለነገ ፈተናዎች ጥንካሬ ይገነባሉ።",
  "የወደፊት እድል ወይም እድሎችን የሚወስነው ያለፈው አይደለም።",
  "ምንም ያህል ትንሽ ቢሆን፣ ወደፊት የሚወሰድ እያንዳንዱ እርምጃ ግፊት ይፈጥራል።",
  "ልዩ አቀራረብ ሌሎች የሌላቸውን ተወዳዳሪ ጥቅም ይሆናል።",
  "የአሁኑ አቀማመጥ እድገት መፈጠር በሚፈልግበት ቦታ በትክክል እንደሆነ ይመኑ።",
  "ታላላቅ ስኬቶች ብዙውን ጊዜ የተቋቋሙ ትልቅ ፈተናዎችን ይከተላሉ።",
  "ይህ ታሪክ በፊት ያሉ ምዕራፎች ጋር ሊፃፍ ይቀጥላል።",
  "ኮኖስ እውነተኛ ህልሞችን በመከተል ይደግፋል።",
  "ኃይለኛው ሀብት የማያናውጥ ራስን ማመን ይቀጥላል።",
  "በሌሎች ላይ ያለው ተጽእኖ ከሚለካው በላይ ይዘረጋል።",
  "የአሁኑ ገደቦች ጊዜያዊ ናቸው፣ እድል ደግሞ ላይገደብ ነው።",
  "ዋነኛው ዕውቅና ከውጭ ሳይሆን ከውስጥ ይመጣል።",
  "ስሜት ወደ እውነተኛ ሰሜን የሚጠቁም የውስጥ ማዕዘን ጠቋሚ ነው።",
  "የዛሬ ስነ-ስርዓት የነገን ነፃነትና እድል ይፈጥራል።",
  "እያንዳንዱ ልምድ ለባህሪ እና ጥበብ ጥልቀት ይጨምራል።",
  "የህይወት ዓላማ በደስታም በችግርም እኩል ይከሰታል።",
  "ሰቆቃ የሚስተናገድበት መንገድ እውነተኛ የባህሪን ጥንካሬ ያመለክታል።",
  "ልዩነት በህይወት ውስጥ ታላቁ ተወዳዳሪ ጥቅም ይሆናል።",
  "ህልሞችዎ እና ግቦችዎ በተፈጥሮ ሲያድጉ የግል ዕድገትን ይፍቀዱ።",
  "ለዕድገት ያለዎት ቁርጠኝነት አሁን ጀምሮ የወደፊት ውጤቶችን በአዎንታዊ መንገድ ይቀይራል።",
  "ተከታታይነት ከፍተኛ ግቦችን ምን ያህል ሊወስድ እንደሚችል በፍጹም አይተውት።",
  "ጽናት ማንኛውንም ጊዜያዊ ዝቅ ማለት ያነሳል።",
  "ትክክለኛው መንገድ ሁልጊዜ ቀላል አይደለም፣ ነገር ግን ሁሌም በጣም ዋጋ ያለው ይሆናል።",
  "ለመጀመር ያለው ድፍረት ሌሎች የራሳቸውን ጉዞ እንዲጀምሩ ያነሳሳል።",
  "ምቾትን ከማደግ በላይ መምረጥ እድልን በመጠን ያስፋፋል።",
  "ከፍተኛው እድል በምቾት ክልል ጫፍ ላይ ይጠብቃል።",
  "እያንዳንዱ ፈተና ከአድማስ ባሻገር ለአንዳች ታላቅ ነገር ያዘጋጃል።"
];

const professionMotivations = {
  "Musician": [
    "የሙዚቃ ሙያ ሰላም ለሚፈልግ አመጣጣሪ ዓለም ሰላም ያመጣል።",
    "የሚነገር እያንዳንዱ ኖታ ለመጽናናት ከሚፈልግ ሰው ነፍስ ጋር ይነጋገራል።",
    "እነዚህ ዜማዎች የተሰበሩ መንፈሶችን የመፈወስና የመለወጥ ኃይል አላቸው።",
    "የሥነ-ጥበብ አገላለጽ ቃላት ሊያስተላልፏቸው የማይችሉ አለም አቀፍ እውነቶችን ይናገራል።",
    "በውስጥዎ ያለው ሙዚቃ የሚጠብቁ ታዳሚዎች ሊሰሙት ይገባል።"
  ],
  "Rapper": [
    "የግጥም ቃላት ጠንካራ ታሪኮችን በድፍረት መነገር ያለባቸውን ይስላሉ።",
    "ይህ ፍሰትና ሪዝም ቃላት ብቻ ሊገልጹት የማይችሉትን ስሜት ይይዛል።",
    "እነዚህ ግጥሞች ብዙዎች የሚሰማቸውን ግን ሊገልጹ የማይችሉትን ልምዶች ድምጽ ይሰጣሉ።",
    "እውነተኛ ድምፅ በየማህበረሰቡ ካሉ እውነትን ከሚፈልጉ ጋር ይነጋገራል።",
    "የግጥም ብቃት አእምሮንና ልቦችን ለአዳዲስ አመለካከቶች ይከፍታል።"
  ],
  "Footballer": [
    "በሜዳ ላይ ያለው ቁርጠኝነት ከጨዋታው ባሻገር ያለውን የቡድን ሥራ ያነሳሳል።",
    "የአትሌቲክ ስነ-ስርዓት በቀላሉ ወደ ህይወት ሁሉ ቦታዎች ይተረጎማል።",
    "በሜዳ ላይ ያለው ስልታዊ አስተሳሰብ ተፈጥሯዊ የመሪነት ችሎታዎችን ያሳያል።",
    "ለውብ ጨዋታ ያለው ፍቅር የሚመለከቱትንና የሚጫወቱትን ያሳድጋል።",
    "ሙያዊ ስነ-ምግባር ሌሎች የሚከተሉትንና የሚያከብሩትን ደረጃ ያስቀምጣል።"
  ],
  "Basketball Player": [
    "የሜዳ እይታ ወደ ህይወት ጨዋታዎች ሁሉ ያሉትን እድሎች የማየት ችሎታ ነው።",
    "በጫና ስር መሥራት በሚገጥም ማንኛውም ፈተና ውስጥ ጥሩ ውጤት ያስገኛል።",
    "ቡድን-መጀመሪያ የሚለው አስተሳሰብ በሚፈጠሩ ግንኙነቶች ሁሉ ስኬት ይፈጥራል።",
    "ከፍ ያለ ዝላይ አስደናቂ አዳዲስ ከፍታዎችን ለመድረስ ካለው ምኞት ጋር ይዛመዳል።",
    "የመከላከል ችሎታ በሁሉም ነገር ለምርጥነት ያለውን ቁርጠኝነት ያሳያል።"
  ],
  "Boxer": [
    "የአእምሮ ጥንካሬ እንደ አካላዊ ጥንካሬው ያህል ያስገርማል።",
    "የማሰልጠኛ ስነ-ስርዓት በሁሉም የህይወት ሁኔታዎች ባህሪን ያንጸባርቃል።",
    "ጥቃቶችን ተቀብሎ ወደፊት መሄድ የህይወት ብቸኛ ጥንካሬ ይሆናል።",
    "በሪንግ ውስጥ ያለው እርምጃ የህይወት ፈተናዎችን የመዳሰስ ችሎታን ያንጸባርቃል።",
    "የውጊያ መንፈስ ከቀረቡ ጠቃሚ ፈተናዎች ፈጽሞ ወደኋላ አይመለስም።"
  ],
  "Student": [
    "ጉጉት ለማያቋርጡ ግኝቶችና እድሎች በሮችን ይከፍታል።",
    "ለመማር ያለው ቁርጠኝነት በህይወት ብዙ ምዕራፎች ያገለግላል።",
    "አዲስ አመለካከት መፍትሄ ለሚፈልጉ አሮጌ ችግሮች አዲስ ግንዛቤዎችን ያመጣል።",
    "የትምህርት ጉዞ ገና ለማይታዩ እድሎች ያዘጋጃል።",
    "የአካዴሚክ ስነ-ስርዓት የዕድሜ ልክ ስኬትን የሚያረጋግጡ ልማዶችን ይገነባል።"
  ],
  "Teacher": [
    "ተጽዕኖ ከክፍል ግድግዳዎች ባሻገር ወደማይታዩ ወደፊቶች ይዘረጋል።",
    "ትዕግስት ሌሎች ሊያመልጧቸው ወይም ሊዘነጓቸው የሚችሉ ችሎታዎችን ያዳብራል።",
    "መመሪያ ከዛሬው ትምህርት በኋላ በሙሉ የማይታወቁ ወይም የማይለኩ የወደፊት ሁኔታዎችን ይቀርፃል።",
    "ጥበብ ከዛሬ ትምህርቶች በኋላ ለትውልዶች የሚያብቡ ዘሮችን ይዘራል።",
    "ለእውቀት ያለው ቁርጠኝነት በየቦታው የአዎንታዊ ለውጥ ሞገዶችን ይፈጥራል።"
  ],
  "TikToker": [
    "ፈጠራ ይዘት በዲጂታል ዓለማችን ደስታንና ግንኙነትን ያመጣል።",
    "እውነተኛ ድምጽ በትክክል ይህን መልዕክት አሁን ለሚፈልጉት ይደርሳል።",
    "በአጭሩ መግለጽ ብርቅየና ጠቃሚ ክህሎትን ያሳያል።",
    "ባህላዊ ተጽዕኖ በመላው ዓለም ላሉ ተመልካቾች አዎንታዊ ለውጥን ያመጣል።",
    "ዲጂታል ገፅታ ከስክሪኑ ገደቦች ባሻገር በእውነተኛው ዓለም ላይ ተጽዕኖ ያሳድራል።"
  ],
  "Entrepreneur": [
    "ራዕያዊ አስተሳሰብ ሌሎች እንቅፋቶችን ብቻ በሚያዩበት ቦታ እድሎችን ይፈጥራል።",
    "ታስቦበት ስጋት መውሰድ እውነተኛ አዳዲስ ነገሮችን ከተከታዮች ይለያል።",
    "አዳዲስ መፍትሄዎች ችግሮችን በምንጫቸው ላይ በውጤታማነት ይፈታሉ።",
    "አመራር ሌሎችን የሚያነሳሳ ጠቃሚ ተልዕኮዎችን እንዲከተሉ ያደርጋል።",
    "በፈተናዎች ውስጥ መጽናት የንግድ ሥራ ስኬት ታሪኮችን ይወስናል።"
  ],
  "Doctor": [
    "የማዳን እጆች በስቃይ ጊዜ ታካሚዎች በጣም በሚፈልጉበት ጊዜ መጽናናትን ያመጣሉ።",
    "ለጤና እንክብካቤ ያለው ቁርጠኝነት በየቀኑ ህይወትን በጥልቅ መንገድ ይቀይራል።",
    "ከርህራሄ ጋር የተዋሃደ የሕክምና እውቀት እውነተኛ የመፈወስ ቅጽበቶችን ይፈጥራል።",
    "ለታካሚ እንክብካቤ ያለው ቁርጠኝነት ከፍተኛውን የሙያ ጥሪ ያሳያል።",
    "የምርመራ ችሎታዎች ከርህራሄ ልብ ጋር በፍጹም ሚዛን ይዛመዳሉ።"
  ],
  "Engineer": [
    "ችግሮችን የመፍታት ችሎታዎች ለማይቆጠሩ ህይወቶች የሚጠቅሙ መፍትሄዎችን ይፈጥራሉ።",
    "ቴክኒካዊ ብቃት ለወደፊት ፈጠራዎች መሰረት ይገነባል።",
    "ትንታኔ አእምሮ በውስብስብ ስርዓቶች ውስጥ ሌሎች ሙሉ በሙሉ የሚያመልጧቸውን ስርዓቶች ያያል።",
    "ትክክለኛነት እና ለዝርዝር ትኩረት በሚፈጠር ነገር ሁሉ ጥራትን ያረጋግጣል።",
    "ለፈተናዎች አዲስ አቀራረቦች መላውን መስክ ወደፊት ያስቀድማሉ።"
  ],
  "Software Developer": [
    "ኮድ ከመተግበር በፊት የማይኖሩ እድሎችን ይፈጥራል።",
    "ቴክኒካዊ መፍትሄዎች ማህበረሰቡ የሚገጥመውን እውነተኛ የሰው ችግሮችን ይፈታሉ።",
    "ሎጂካዊ አስተሳሰብ ከፈጠራ ፈጠራ ጋር በአዲስ መንገድ ይዋሃዳል።",
    "ዲጂታል ፈጠራዎች በመድረኮች ዙሪያ ለማይቆጠሩ ተጠቃሚዎች በየቀኑ ተጽዕኖ ያሳድራሉ።",
    "አዳዲስ ቴክኖሎጂዎችን መማር የቴክኖሎጂውን ዘርፍ ግንባር ቀደም ያደርገዋል።"
  ],
  "Artist": [
    "ፈጠራ እይታ ሌሎች ተለምዶ ያሉ ዓለሞችን የማየት አዲስ መንገዶችን ያሳያል።",
    "የሥነ-ጥበብ ሥራ ቃላት መድረስ የማይችሉባቸውን ስሜቶች ይነካል።",
    "ልዩ አመለካከት ለተመልካቾች ለየዕለት ተሞክሮዎች ውበትን ይጨምራል።",
    "ፈጠራ ሥራ በድንበሮች ዙሪያ አስፈላጊ ውይይቶችን ያነሳሳል።",
    "ድፍረት ያለው የሥነ-ጥበብ ሥራ ሌሎች እውነታቸውን በትክክል እንዲገልጹ ያነሳሳል።"
  ],
  "Nurse": [
    "ርህራሄ ያለው እንክብካቤ ከአካላዊ ህመሞች በላይ ይፈውሳል።",
    "ትኩረት ሌሎች በታካሚ እንክብካቤ ሊያመልጧቸው የሚችሉትን ያስተውላል።",
    "ጸጥታ ያለው ማንነት በአስቸጋሪ የጤና እንክብካቤ ቅጽበቶች ውስጥ ምቾትን ይሰጣል።",
    "ቁርጠኝነት በየቀኑ ለማይቆጠሩ ታካሚዎች ልዩነት ያመጣል።",
    "የቴክኒካዊ ክህሎትና የሰብዓዊ ሙቀት ሚዛን ጠቃሚ መሆኑን ያሳያል።"
  ],
  "Writer": [
    "ቃላት በአንባቢዎች አእምሮ ውስጥ ሊጎበኙ የሚጠብቁ ዓለሞችን ይፈጥራሉ።",
    "ታሪክ ማውራት እጅግ በተለያዩ ተሞክሮዎች ያሉ ሰዎችን ያገናኛል።",
    "ብቃት ሌሎች በግልጽ ለመግለጽ ለሚታገሉት ድምጽ ይሰጣል።",
    "የጽሁፍ ግኝቶች ለተለመዱ ፈተናዎች አዲስ አመለካከቶችን ይሰጣሉ።",
    "የሥነ-ጽሁፍ ሙያ ለወደፊት ትውልዶች አስፈላጊ እውነቶችን ይጠብቃል።"
  ],
  "Lawyer": [
    "ጥብቅና በውስብስብ ስርዓቶች ውስጥ ድምጽ ለሚያስፈልጋቸው ፍትህን ያመጣል።",
    "የመተንተን አእምሮ የሕግ ፈተናዎችን በአስገራሚ ትክክለኛነት ይመራል።",
    "ለሕግ መርሆዎች ያለው ቁርጠኝነት የማህበረሰብን መሰረቶች ያጠናክራል።",
    "አሳማኝ ክርክሮች ፍትህ ለሚፈልጉ ደንበኞች ውጤቶችን ይቀይራሉ።",
    "ስነ-ምግባራዊ የሆነ የሕግ አሰራር ለሙያው ደረጃዎችን ያስቀምጣል።"
  ],
  "Chef": [
    "የማብሰል ፈጠራዎች ለታዳሚ ምግብ ሰዎች በሁሉም ስሜቶች በኩል ደስታን ያመጣሉ።",
    "ማብሰል ሰዎችን በዝርያ እና በተለያዩ ባህላዊ ዳራዎች ያገናኛል።",
    "የጣዕም ቅንብሮች የሥነ-ጥበብ ህሊናን እና ቴክኒካዊ ክህሎትን ያሳያሉ።",
    "ለጥራት ንጥረ ነገሮች ያለው ቁርጠኝነት ባህልንና አዲስ ፈጠራን ያከብራል።",
    "የኩሽና አመራር በመላው የምግብ ማብሰያ ቡድኖች ውስጥ ምርጡን ያመጣል።"
  ],
  "Accountant": [
    "የፋይናንስ ብቃት ለደንበኞች ደህንነትንና የአእምሮ እረፍትን ይሰጣል።",
    "ለዝርዝር ትኩረት ሌሎች በእርግጠኝነት የሚያመልጡትን ይይዛል።",
    "የትንተና ክህሎቶች ውስብስብ የፋይናንስ ሁኔታዎችን ግልጽ ያደርጋሉ።",
    "ሙያዊ ቅንነት በሁሉም የንግድ ግንኙነቶች እምነትን ያረጋግጣል።",
    "የማደራጀት ችሎታዎች ከፋይናንስ ውስብስብነት ውስጥ ስርዓትን ይፈጥራሉ።"
  ],
  "Designer": [
    "የእይታ መፍትሄዎች ውበትን ከተግባራዊ ጥቅም ጋር ያለስስት ያዋህዳሉ።",
    "ዲዛይን አስተሳሰብ የተጠቃሚ ልምዶችን በትርጉም ሙላ መንገድ ይቀይራል።",
    "የውበት ስሜት የዕለት ተዕለት ነገሮችንና መስተጋብሮችን ከፍ ያደርጋል።",
    "ፈጠራዊ ሂደት ፈጠራን ከመሰረታዊ ጠቀሜታ ጋር ያመጣጥናል።",
    "የዲዛይን ቋንቋ በድንበሮች ዙሪያ በውጤታማነት ይገናኛል።"
  ],
  "Police Officer": [
    "ለህዝብ ደህንነት ያለው ቁርጠኝነት ማህበረሰቦችን በከፍተኛ ሁኔታ ጠንካራ ያደርጋል።",
    "በፈታኝ ሁኔታዎች ውስጥ ድፍረት ተጋላጭ ዜጎችን ይጠብቃል።",
    "በጫና ስር ፈጣን ውሳኔ መስጠት አስደናቂ ጽናትን ያሳያል።",
    "ለፍትህ ያለው ቁርጠኝነት የሙያ ስነምግባርን በተከታታይ ይመራል።",
    "መገኘት ጣልቃ ገብነትን ለሚፈልጉ አስቸኳይ ሁኔታዎች ደህንነትን ያመጣል።"
  ],
  "Firefighter": [
    "በአደገኛ ሁኔታዎች ውስጥ ያለው ድፍረት ህይወትንና ዋጋ ያላቸውን ንብረቶችን ያድናል።",
    "በከፍተኛ ጫና ስር ፈጣን አስተሳሰብ ልዩ ክህሎትን ያሳያል።",
    "አካላዊና አእምሯዊ ዝግጅት አኩሪ የአደጋ ምላሽን ያስችላል።",
    "በቀውስ ሁኔታዎች ውስጥ የቡድን ሥራ የሰው ልጅ ትብብርን ያመላክታል።",
    "ለማህበረሰብ ደህንነት ያለው ቁርጠኝነት ከአደጋ ሁኔታዎች ባሻገር ይዘረጋል።"
  ],
  "Military Personnel": [
    "አገልግሎት ሌሎችን ለመጠበቅ ከፍተኛ ቁርጠኝነትን ያሳያል።",
    "በአስቸጋሪ ሁኔታዎች ስር ያለው ስነ-ስርዓት ልዩ ደረጃዎችን ያስቀምጣል።",
    "ስልታዊ አስተሳሰብ የተልዕኮ ዓላማዎችን ከቡድን ደህንነት ጋር ያመጣጥናል።",
    "ለተለዋዋጭ ሁኔታዎች ተለዋዋጭነት የተልዕኮን ስኬት በተከታታይ ያረጋግጣል።",
    "ለአሃዱ ያለው ታማኝነት ከተለመደው ወዳጅነት የሚበልጡ ትስስሮችን ይፈጥራል።"
  ],
  "Journalist": [
    "እውነትን መፈለግ በግራ መጋባት እና በውስብስብ ጊዜያት ግልጽነትን ያመጣል።",
    "ታሪክ ማውራት ታዳሚዎች አስፈላጊ ውስብስብ ጉዳዮችን እንዲረዱ ይረዳል።",
    "የምርመራ ክህሎቶች የሚታየት ፍላጎት ያለውን ነገር ይፋ ያደርጋሉ።",
    "ለእውነታዎች ያለው ቁርጠኝነት የመረጃውን ስርዓተ-ምህዳር በኃላፊነት ያመጣጥናል።",
    "የጋዜጠኝነት ድምጽ ለህዝብ ንግግር አስፈላጊ አመለካከት ይጨምራል።"
  ],
  "Psychologist": [
    "በርህራሄ ማዳመጥ ለአስፈላጊ ፈውስ ደህንነቱ የተጠበቀ ቦታን ይፈጥራል።",
    "የውስጥ ግንዛቤዎች ደንበኞች የራሳቸውን የውስጥ አዳራሾች በውጤታማነት እንዲዳስሱ ይረዳሉ።",
    "ሕክምናዊ አቀራረብ ርህራሄን ከማስረጃ ላይ የተመሰረተ ልምምድ ጋር ያመዛዝናል።",
    "በትዕግስት መምራት ሌሎች የራሳቸውን መፍትሄዎች እንዲያገኙ ያስችላል።",
    "ሙያዊ ድንበሮች ዘላቂ የሕክምና ግንኙነቶችን ያስችላሉ።"
  ],
  "Teacher": [
    "መምራት ማየት ከሚቻለው ባሻገር ወደፊቶችን ይቀርጻል።",
    "ከመማር ሂደቶች ጋር ትዕግስት እድገት በተፈጥሮ እንዲከሰት ያስችላል።",
    "ውስብስብ ፅንሰ-ሀሳቦችን የማብራራት ችሎታ እውቀትን ተደራሽ ያደርጋል።",
    "የክፍል አስተዳደር ለአእምሯዊ ጉዞ ደህንነቱ የተጠበቀ ቦታ ይፈጥራል።",
    "የተለያዩ የትምህርት ዘይቤዎችን መገንዘብ ለእያንዳንዱ ተማሪ በተለየ ሁኔታ ይደርሳል።"
  ],
  "Programmer": [
    "የኮዲንግ ክህሎቶች ውስብስብ ሀሳቦችን ወደ ተግባራዊ እውነታ ይቀይራሉ።",
    "ችግር መፍታት ውስብስብ ፈተናዎችን ወደ ሊቆጣጠሩት ቁራጮች ይሰባብራል።",
    "ለዝርዝር ትኩረት በውስብስብ ኮድ ውስጥ የወደፊት ውስብስብነቶችን ይከላከላል።",
    "ቀጣይነት ያለው ትምህርት በፍጥነት በሚለወጥ መስክ ውስጥ ክህሎቶችን አግባብነት ያላቸው ያደርጋል።",
    "ቴክኒካዊ ፈጠራ ለአስቸጋሪ ችግሮች ጥሩ መፍትሄዎችን ያገኛል።"
  ]
};

const monthTraits = [
  "በጥር ወር መወለድ ተፈጥሯዊ የመሪነት ባህሪያትንና ቆራጥ ትኩረትን ይሰጣል።",
  "የየካቲት ወር ልደት ተፈጥሮአዊ ግንዛቤና ሰብዓዊ ራዕይን ይባርካል።",
  "የመጋቢት ወር ልደት የፈጠራ ህሊናንና ተላማጅ ብርታትን ይሰጣል።",
  "የሚያዚያ ወር ልደት ቆራጥ ጽናትንና ድፍረት ያለው ተነሳሽነትን ያጎናጽፋል።",
  "የግንቦት ወር ልደት አሳማኝ የግንኙነት ክህሎቶችንና ተግባራዊ ስሜት ይሰጣል።",
  "የሰኔ ወር ልደት ተለዋዋጭ ተለዋዋጭነትንና ስሜታዊ ብልሃትን ያቀርባል።",
  "የሐምሌ ወር ልደት ርህራሄ ያለው ጽናትንና ጥበቃ የሚሰጥ ማሳደግን ይሰጣል።",
  "የነሐሴ ወር ልደት ማግኔታዊ ሳቢነትንና ለጋስ ራስ መተማመንን ይባርካል።",
  "የመስከረም ወር ልደት ትንታኔያዊ ትክክለኛነትንና ስልታዊ ድርጅትን ይሰጣል።",
  "የጥቅምት ወር ልደት ሚዛናዊ አመለካከትንና ዲፕሎማሲያዊ ስምምነትን ያጎናጽፋል።",
  "የህዳር ወር ልደት ጥልቅ ግንዛቤንና ለውጠ ማምጣ ድፍረትን ይሰጣል።",
  "የታህሳስ ወር ልደት ራዕይ ያለው አዎንታዊ አመለካከትንና ፈላስፋዊ ጥበብን ያቀርባል።"
];

      
      let selectedTrait;
      
      if (profession && professionMotivations[profession] && Math.random() < 0.25) {
        const profMotivations = professionMotivations[profession];
        selectedTrait = profMotivations[Math.floor(Math.random() * profMotivations.length)];
      } 
      else if (dob && Math.random() < 0.2) {
        selectedTrait = monthTraits[month];
      }
      else {
        selectedTrait = lifeTraits[Math.floor(Math.random() * lifeTraits.length)];
      }
      
      const encourageIndex = Math.floor(Math.random() * lifeEncouragements.length);
      
      return selectedTrait + " " + lifeEncouragements[encourageIndex];
    }

    function generateFlowerCode() {
      const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      let code = '';
      for (let i = 0; i < 8; i++) {
        const randomIndex = Math.floor(Math.random() * characters.length);
        code += characters.charAt(randomIndex);
      }
      return code;
    }

    function getRandomSubject() {
      let availableSubjects = Object.keys(subjectDictionary).filter(subject => !seenSubjects.includes(subject));
      
      if (availableSubjects.length === 0) {
        seenSubjects = [];
        availableSubjects = Object.keys(subjectDictionary);
      }
      
      const randomIndex = Math.floor(Math.random() * availableSubjects.length);
      const selectedSubject = availableSubjects[randomIndex];
      
      seenSubjects.push(selectedSubject);
      
      return selectedSubject;
    }

    function updateFlowerDisplay() {
      const flowerCodeElement = document.getElementById('flowerCodeDisplay');
      const motivationElement = document.getElementById('monthlyMotivation');
      
      if (!flowerCodeElement || !motivationElement) {
        console.error("Required elements not found in the DOM");
        return;
      }
      
      let subject = localStorage.getItem('flowerSubject');
      if (!subject) {
        subject = getRandomSubject();
        localStorage.setItem('flowerSubject', subject);
      }
      
      const formattedName = formatUserName(userFullName);
      
      if (formattedName) {
        flowerCodeElement.innerHTML = `የኔ አበባ - ${subjectDictionary[subject] || subject} / ${formattedName}`;
      } else {
        flowerCodeElement.textContent = "የኔ አበባ - " + (subjectDictionary[subject] || subject);
      }
      
      if (!currentMotivation) {
        currentMotivation = generatePersonalizedMotivation(userFlowerCode, userProfession, userDateOfBirth);
      }
      
      motivationElement.textContent = currentMotivation;
      
      const captureCode = document.getElementById('captureFlowerCode');
      const captureMotivation = document.getElementById('captureFlowerMotivation');
      
      if (captureCode) {
        if (formattedName) {
          captureCode.innerHTML = `የኔ አበባ - ${subjectDictionary[subject] || subject} / ${formattedName}`;
        } else {
          captureCode.textContent = "የኔ አበባ - " + (subjectDictionary[subject] || subject);
        }
      }
      
      if (captureMotivation) captureMotivation.textContent = currentMotivation;
      
      return currentMotivation;
    }

    function setCookie(name, value, days) {
      let expires = "";
      if (days) {
        const date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        expires = "; expires=" + date.toUTCString();
      }
      document.cookie = name + "=" + (value || "") + expires + "; path=/; SameSite=Lax";
    }

    function getCookie(name) {
      const nameEQ = name + "=";
      const ca = document.cookie.split(';');
      for (let i = 0; i < ca.length; i++) {
        let c = ca[i];
        while (c.charAt(0) === ' ') c = c.substring(1, c.length);
        if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
      }
      return null;
    }

    function removeCookie(name) {
      document.cookie = name + "=; Max-Age=-99999999; path=/";
    }

    function setTheme(theme) {
      document.body.classList.remove('theme-default', 'theme-red-black', 'theme-green-blue', 'theme-orange-pink', 'theme-yellow-purple');
      
      document.body.classList.add('theme-' + theme);
      
      currentTheme = theme;
      
      localStorage.setItem('preferredTheme', theme);
      setCookie('preferredTheme', theme, 365);
      
      const options = document.querySelectorAll('.style-option');
      options.forEach(option => {
        option.classList.remove('selected');
        if (option.dataset.theme === theme) {
          option.classList.add('selected');
        }
      });
      
      updateCaptureStyles(theme);
      
      let themeColor = '#1A2E4D';
      switch(theme) {
        case 'red-black':
          themeColor = '#000000';
          break;
        case 'green-blue':
          themeColor = '#1A2E4D';
          break;
        case 'orange-pink':
        case 'yellow-purple':
          themeColor = '#4B0082';
          break;
        case 'default':
          themeColor = '#FFFFFF';
          break;
      }
      
      document.querySelector('meta[name="theme-color"]').setAttribute('content', themeColor);
      document.querySelector('meta[name="apple-mobile-web-app-status-bar-style"]').setAttribute('content', theme === 'default' ? 'default' : 'black-translucent');
    }
    
    function updateCaptureStyles(theme) {
      const captureContainer = document.getElementById('flowerCaptureContainer');
      const captureCode = document.getElementById('captureFlowerCode');
      const captureHeader = document.getElementById('captureFlowerHeader');
      const captureWebsiteUrl = document.querySelector('.capture-website-url');
      const captureLogo = document.querySelector('.gz-logo');
      const captureMotivation = document.getElementById('captureFlowerMotivation');
      
      if (!captureContainer || !captureCode || !captureHeader || !captureWebsiteUrl || 
          !captureLogo || !captureMotivation) {
        console.error("One or more capture elements not found");
        return;
      }
      
      captureContainer.style.borderColor = '';
      captureCode.style.borderColor = '';
      captureCode.style.color = '';
      captureCode.style.backgroundColor = '';
      captureHeader.style.color = '';
      captureWebsiteUrl.style.color = '';
      captureLogo.style.color = '';
      captureLogo.style.borderColor = '';
      captureMotivation.style.color = '';
      captureMotivation.style.backgroundColor = '';
      captureMotivation.style.borderColor = '';
      
      switch(theme) {
        case 'red-black':
          captureContainer.style.borderColor = '#8B0000';
          captureContainer.style.backgroundColor = 'black';
          captureCode.style.borderColor = '#FF4500';
          captureCode.style.color = '#FF4500';
          captureCode.style.backgroundColor = 'black';
          captureHeader.style.color = '#FF4500';
          captureWebsiteUrl.style.color = '#FF4500';
          captureLogo.style.color = '#FF4500';
          captureLogo.style.borderColor = '#FF4500';
          captureMotivation.style.color = '#E5E5E5';
          captureMotivation.style.backgroundColor = 'black';
          captureMotivation.style.borderColor = '#FF4500';
          break;
          
        case 'green-blue':
          captureContainer.style.borderColor = '#3EB489';
          captureContainer.style.backgroundColor = '#1A2E4D';
          captureCode.style.borderColor = '#3EB489';
          captureCode.style.color = '#3EB489';
          captureCode.style.backgroundColor = '#36454F';
          captureHeader.style.color = '#3EB489';
          captureWebsiteUrl.style.color = '#3EB489';
          captureLogo.style.color = '#3EB489';
          captureLogo.style.borderColor = '#3EB489';
          captureMotivation.style.color = '#F5F5F5';
          captureMotivation.style.backgroundColor = '#1A2E4D';
          captureMotivation.style.borderColor = '#3EB489';
          break;
          
        case 'orange-pink':
          captureContainer.style.borderColor = '#FF7F50';
          captureContainer.style.backgroundColor = '#4B0082';
          captureCode.style.borderColor = '#FF7F50';
          captureCode.style.color = '#FF7F50';
          captureCode.style.backgroundColor = '#6A0DAD';
          captureHeader.style.color = '#FF7F50';
          captureWebsiteUrl.style.color = '#FF7F50';
          captureLogo.style.color = '#FF7F50';
          captureLogo.style.borderColor = '#FF7F50';
          captureMotivation.style.color = '#FFFFFF';
          captureMotivation.style.backgroundColor = '#4B0082';
          captureMotivation.style.borderColor = '#FF7F50';
          break;
          
        case 'yellow-purple':
          captureContainer.style.borderColor = '#FFD700';
          captureContainer.style.backgroundColor = '#4B0082';
          captureCode.style.borderColor = '#FFD700';
          captureCode.style.color = '#FFD700';
          captureCode.style.backgroundColor = '#6A0DAD';
          captureHeader.style.color = '#FFD700';
          captureWebsiteUrl.style.color = '#FFD700';
          captureLogo.style.color = '#FFD700';
          captureLogo.style.borderColor = '#FFD700';
          captureMotivation.style.color = '#FFFFFF';
          captureMotivation.style.backgroundColor = '#4B0082';
          captureMotivation.style.borderColor = '#FFD700';
          break;
          
        default:
          captureContainer.style.borderColor = '#007bff';
          captureContainer.style.backgroundColor = 'white';
          captureCode.style.borderColor = '#ff69b4';
          captureCode.style.color = '#ff69b4';
          captureCode.style.backgroundColor = '#fff0f8';
          captureHeader.style.color = '#007bff';
          captureWebsiteUrl.style.color = '#007bff';
          captureLogo.style.color = '#007bff';
          captureLogo.style.borderColor = '#007bff';
          captureMotivation.style.color = '#333';
          captureMotivation.style.backgroundColor = 'white';
          captureMotivation.style.borderColor = '#ff69b4';
      }
    }

    function authenticateAnonymously() {
      return new Promise((resolve, reject) => {
        auth.signInAnonymously()
          .then((userCredential) => {
            console.log("User authenticated anonymously:", userCredential.user.uid);
            userUid = userCredential.user.uid;
            isAuthenticated = true;
            resolve(userCredential.user);
          })
          .catch((error) => {
            console.error("Authentication error:", error);
            reject(error);
          });
      });
    }

    auth.onAuthStateChanged((user) => {
      if (user) {
        userUid = user.uid;
        isAuthenticated = true;
        console.log("Auth state changed: user is signed in", user.uid);
      } else {
        isAuthenticated = false;
        console.log("Auth state changed: user is signed out");
      }
    });

    async function submitToFirebase() {
      try {
        if (!isAuthenticated) {
          console.log("User not authenticated, authenticating now...");
          await authenticateAnonymously();
        }
        
        const location = await detectUserLocation();
        
        const userData = {
          date: new Date().toISOString(),
          country: location.country || "Unknown",
          city: location.city || "Unknown",
          uid: userUid,
          uniqueId: userUniqueId,
          flowerCode: userFlowerCode,
          motivation: currentMotivation,
          dateOfBirth: userDateOfBirth,
          profession: userProfession,
          fullName: userFullName,
          formattedName: formatUserName(userFullName),
          timestamp: Date.now(),
          theme: currentTheme,
          subject: localStorage.getItem('flowerSubject') || getRandomSubject(),
          shareCount: shareCount
        };

        console.log("Submitting data to Firebase:", userData);
        
        try {
          const newEntryRef = database.ref('birthdates').push(userData);
          console.log("Data submitted to Realtime Database:", newEntryRef.key);
        } catch (dbError) {
          console.error("Error with Realtime Database:", dbError);
        }
        
        try {
          const docRef = await firestore.collection('flowers').add(userData);
          console.log("Document written to Firestore with ID: ", docRef.id);
        } catch (firestoreError) {
          console.error("Error adding document to Firestore: ", firestoreError);
        }
        
        try {
          await firestore.collection('flowerCodes').doc(userUniqueId).set({
            ...userData,
            createdAt: new Date()
          });
          console.log("Flower code added to specific collection");
        } catch (codeError) {
          console.error("Error adding flower code to collection: ", codeError);
        }
        
        localStorage.setItem('userFlowerData', JSON.stringify(userData));
        localStorage.setItem('isInstalled', 'true');
        setCookie('userUniqueId', userUniqueId, 365);
        setCookie('userFlowerCode', userFlowerCode, 365);
        setCookie('userDateOfBirth', userDateOfBirth, 365);
        setCookie('userProfession', userProfession, 365);
        setCookie('userFullName', userFullName, 365);
        setCookie('isInstalled', 'true', 365);
        isInstalled = true;
        
        return true;
      } catch (error) {
        console.error("Firebase submission error:", error);
        const userData = {
          date: new Date().toISOString(),
          uniqueId: userUniqueId,
          flowerCode: userFlowerCode,
          motivation: currentMotivation,
          dateOfBirth: userDateOfBirth,
          profession: userProfession,
          fullName: userFullName,
          formattedName: formatUserName(userFullName),
          timestamp: Date.now(),
          theme: currentTheme,
          subject: localStorage.getItem('flowerSubject') || getRandomSubject(),
          shareCount: 0
        };
        
        localStorage.setItem('userFlowerData', JSON.stringify(userData));
        localStorage.setItem('isInstalled', 'true');
        setCookie('userUniqueId', userUniqueId, 365);
        setCookie('userFlowerCode', userFlowerCode, 365);
        setCookie('userDateOfBirth', userDateOfBirth, 365);
        setCookie('userProfession', userProfession, 365);
        setCookie('userFullName', userFullName, 365);
        setCookie('isInstalled', 'true', 365);
        isInstalled = true;
        
        return true;
      }
    }

    async function updateShareCount() {
      if (!isAuthenticated || !userUniqueId) return;
      
      try {
        shareCount++;
        
        const savedData = localStorage.getItem('userFlowerData');
        if (savedData) {
          const userData = JSON.parse(savedData);
          userData.shareCount = shareCount;
          localStorage.setItem('userFlowerData', JSON.stringify(userData));
        }
        
        await firestore.collection('flowerCodes').doc(userUniqueId).set({
          shareCount: shareCount,
          lastShared: new Date().toISOString(),
          country: currentCountry || "Unknown",
          city: userCity || "Unknown",
          uid: userUid,
          uniqueId: userUniqueId
        }, { merge: true });
        
        console.log("Share count updated:", shareCount);
      } catch (error) {
        console.error("Error updating share count:", error);
      }
    }

    function checkSavedUserData() {
      const cookieUniqueId = getCookie('userUniqueId');
      const cookieFlowerCode = getCookie('userFlowerCode');
      const cookieInstalled = getCookie('isInstalled');
      const cookieDOB = getCookie('userDateOfBirth');
      const cookieProfession = getCookie('userProfession');
      const cookieFullName = getCookie('userFullName');
      
      if (cookieUniqueId && cookieFlowerCode) {
        userUniqueId = cookieUniqueId;
        userFlowerCode = cookieFlowerCode;
        userDateOfBirth = cookieDOB || null;
        userProfession = cookieProfession || null;
        userFullName = cookieFullName || null;
        isInstalled = cookieInstalled === 'true';
        
        currentMotivation = generatePersonalizedMotivation(userFlowerCode, userProfession, userDateOfBirth);
        
        console.log("Found saved user data in cookies:", { userUniqueId, userFlowerCode, userDateOfBirth, userProfession, userFullName });
        return true;
      }
      
      const savedData = localStorage.getItem('userFlowerData');
      if (savedData) {
        try {
          const userData = JSON.parse(savedData);
          userUniqueId = userData.uniqueId;
          userFlowerCode = userData.flowerCode;
          userDateOfBirth = userData.dateOfBirth || null;
          userProfession = userData.profession || null;
          userFullName = userData.fullName || null;
          shareCount = userData.shareCount || 0;
          currentMotivation = userData.motivation || generatePersonalizedMotivation(userData.flowerCode, userData.profession, userData.dateOfBirth);
          userUid = userData.uid;
          isInstalled = localStorage.getItem('isInstalled') === 'true';
          
          setCookie('userUniqueId', userUniqueId, 365);
          setCookie('userFlowerCode', userFlowerCode, 365);
          setCookie('userDateOfBirth', userDateOfBirth, 365);
          setCookie('userProfession', userProfession, 365);
          setCookie('userFullName', userFullName, 365);
          setCookie('isInstalled', 'true', 365);
          
          console.log("Found saved user data in localStorage:", userData);
          return true;
        } catch (e) {
          console.error("Error parsing saved user data:", e);
          return false;
        }
      }
      return false;
    }

    async function deleteUserAccount() {
      if (!userUniqueId) return false;
      
      try {
        if (!confirm("መላው መረጃዎን መሰረዝ እንደሚፈልጉ እርግጠኛ ነዎት? ይህ እርምጃ የማይቀለበስ ነው።")) {
          return false;
        }
        
        console.log("Suppression du compte utilisateur:", userUniqueId);
        
        try {
          await firestore.collection('flowerCodes').doc(userUniqueId).delete();
          console.log("Données supprimées de la collection flowerCodes");
        } catch (error) {
          console.error("Erreur lors de la suppression de flowerCodes:", error);
        }
        
        try {
          const flowersQuery = await firestore.collection('flowers').where('uniqueId', '==', userUniqueId).get();
          
          const batch = firestore.batch();
          let count = 0;
          
          flowersQuery.forEach((doc) => {
            batch.delete(doc.ref);
            count++;
          });
          
          if (count > 0) {
            await batch.commit();
            console.log(`${count} documents supprimés de la collection flowers`);
          }
        } catch (error) {
          console.error("Erreur lors de la suppression de flowers:", error);
        }
        
        try {
          const birthdatesRef = database.ref('birthdates');
          const query = birthdatesRef.orderByChild('uniqueId').equalTo(userUniqueId);
          
          query.once('value', (snapshot) => {
            snapshot.forEach((childSnapshot) => {
              birthdatesRef.child(childSnapshot.key).remove();
            });
          });
          
          console.log("Données supprimées de la base de données en temps réel");
        } catch (error) {
          console.error("Erreur lors de la suppression de la base de données en temps réel:", error);
        }
        
        localStorage.removeItem('userFlowerData');
        localStorage.removeItem('isInstalled');
        localStorage.removeItem('flowerSubject');
        localStorage.removeItem('preferredTheme');
        
        removeCookie('userUniqueId');
        removeCookie('userFlowerCode');
        removeCookie('isInstalled');
        removeCookie('userDateOfBirth');
        removeCookie('userProfession');
        removeCookie('userFullName');
        removeCookie('preferredTheme');
        
        userUniqueId = null;
        userFlowerCode = null;
        currentMotivation = null;
        userDateOfBirth = null;
        userProfession = null;
        userFullName = null;
        isInstalled = false;
        seenSubjects = [];
        shareCount = 0;
        
        try {
          if (auth.currentUser) {
            await auth.currentUser.delete();
            console.log("Utilisateur Firebase supprimé");
          }
        } catch (authError) {
          console.error("Erreur lors de la suppression de l'authentification:", authError);
        }
        
        console.log("Compte utilisateur complètement supprimé");
        return true;
      } catch (error) {
        console.error("Erreur lors de la suppression du compte:", error);
        return false;
      }
    }
    
    function createWebAppManifest() {
      const manifestData = {
        name: "G-Z Flower",
        short_name: "G-Z",
        description: "Discover your unique Flower of Life",
        start_url: window.location.href,
        display: "standalone",
        background_color: "#1A2E4D",
        theme_color: "#1A2E4D",
        icons: [
          {
            src: "https://firebasestorage.googleapis.com/v0/b/genz-abb36.firebasestorage.app/o/IMG_20250723_083736_652.webp?alt=media&token=0919c124-8818-4376-854c-7e95719e6e76",
            sizes: "192x192",
            type: "image/webp"
          },
          {
            src: "https://firebasestorage.googleapis.com/v0/b/genz-abb36.firebasestorage.app/o/IMG_20250723_083736_652.webp?alt=media&token=0919c124-8818-4376-854c-7e95719e6e76",
            sizes: "512x512",
            type: "image/webp"
          }
        ]
      };
      
      const manifestStr = JSON.stringify(manifestData);
      const manifestBlob = new Blob([manifestStr], {type: 'application/json'});
      const manifestURL = URL.createObjectURL(manifestBlob);
      
      const manifestLink = document.getElementById('manifest-placeholder');
      manifestLink.setAttribute('href', manifestURL);
      manifestLink.setAttribute('rel', 'manifest');
    }
    
    function setupInstallPrompt() {
      window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        
        const isInstallPromptShownBefore = localStorage.getItem('installPromptShown');
        if (!isInstallPromptShownBefore) {
          setTimeout(() => {
            document.getElementById('installPrompt').style.display = 'block';
          }, 3000);
        }
      });
      
      document.getElementById('installBtn').addEventListener('click', async () => {
        if (!deferredPrompt) {
          window.location.href = "https://g-z.online/install.html";
          return;
        }
        
        deferredPrompt.prompt();
        const choiceResult = await deferredPrompt.userChoice;
        
        if (choiceResult.outcome === 'accepted') {
          console.log('User accepted the install prompt');
        } else {
          console.log('User dismissed the install prompt');
        }
        
        deferredPrompt = null;
        document.getElementById('installPrompt').style.display = 'none';
        localStorage.setItem('installPromptShown', 'true');
      });
      
      document.getElementById('dismissBtn').addEventListener('click', () => {
        document.getElementById('installPrompt').style.display = 'none';
        localStorage.setItem('installPromptShown', 'true');
      });
      
      window.addEventListener('appinstalled', (evt) => {
        console.log('App was installed');
        document.getElementById('installPrompt').style.display = 'none';
      });
    }

    window.addEventListener('load', async () => {
      createWebAppManifest();
      setupInstallPrompt();
      
      const today = new Date();
      const twoYearsAgo = new Date(today.getFullYear() - 5, today.getMonth(), today.getDate());
      document.getElementById('dobInput').max = twoYearsAgo.toISOString().split('T')[0];
      
      const savedTheme = localStorage.getItem('preferredTheme') || getCookie('preferredTheme');
      if (savedTheme) {
        setTheme(savedTheme);
      } else {
        setTheme('green-blue');
      }
      
      if (checkSavedUserData()) {
        console.log("User already has data, hiding welcome modal");
        const welcomeToast = document.getElementById('welcomeToast');
        welcomeToast.style.display = 'block';
        setTimeout(() => {
          welcomeToast.style.opacity = '1';
        }, 100);
        setTimeout(() => {
          welcomeToast.style.opacity = '0';
          setTimeout(() => {
            welcomeToast.style.display = 'none';
          }, 500);
        }, 2350);
        
        if (!isAuthenticated) {
          try {
            await authenticateAnonymously();
          } catch (error) {
            console.error("Error during authentication:", error);
          }
        }
      } else {
        console.log("No saved user data found, showing welcome modal");
        const welcomeModal = document.getElementById('welcomeModal');
        welcomeModal.style.display = 'block';
        setTimeout(() => {
          welcomeModal.classList.add('show');
        }, 100);
      }
      
      setupProfessionDropdown();
    });

    function setupProfessionDropdown() {
      const professionInput = document.getElementById('professionInput');
      const professionDropdown = document.getElementById('professionDropdown');
      
      if (!professionInput || !professionDropdown) {
        console.error("Profession dropdown elements not found");
        return;
      }
      
      function filterProfessions(input) {
        if (!input) return [];
        
        input = input.toLowerCase();
        return professions.filter(profession => 
          profession.toLowerCase().includes(input)
        );
      }
      
      function renderDropdownOptions(filteredProfessions) {
        professionDropdown.innerHTML = '';
        
        if (filteredProfessions.length === 0) {
          const option = document.createElement('div');
          option.className = 'profession-option';
          option.textContent = 'No matches found';
          professionDropdown.appendChild(option);
        } else {
          filteredProfessions.forEach(profession => {
            const option = document.createElement('div');
            option.className = 'profession-option';
            option.textContent = profession;
            option.addEventListener('click', () => {
              professionInput.value = profession;
              professionDropdown.style.display = 'none';
            });
            professionDropdown.appendChild(option);
          });
        }
      }
      
      professionInput.addEventListener('input', () => {
        const filtered = filterProfessions(professionInput.value);
        renderDropdownOptions(filtered);
        
        if (filtered.length > 0) {
          professionDropdown.style.display = 'block';
        } else {
          professionDropdown.style.display = 'none';
        }
      });
      
      professionInput.addEventListener('focus', () => {
        if (professionInput.value) {
          const filtered = filterProfessions(professionInput.value);
          renderDropdownOptions(filtered);
          professionDropdown.style.display = 'block';
        }
      });
      
      document.addEventListener('click', (e) => {
        if (!professionInput.contains(e.target) && !professionDropdown.contains(e.target)) {
          professionDropdown.style.display = 'none';
        }
      });
    }

    document.getElementById('flowerButton').addEventListener('click', function() {
      if (!userUniqueId) {
        alert("Please create your flower account first.");
        return;
      }
      
      updateFlowerDisplay();
      const flowerModal = document.getElementById('flowerModal');
      flowerModal.style.display = 'block';
      setTimeout(() => {
        flowerModal.classList.add('show');
      }, 10);
      document.getElementById('shareFlowerButton').style.display = 'flex';
    });

    document.getElementById('shareFlowerButton').addEventListener('click', function() {
      captureFlower();
    });
    
    document.getElementById('showIdButton').addEventListener('click', function() {
      if (userUniqueId) {
        document.getElementById('userIdDisplay').textContent = userUniqueId;
        const idModal = document.getElementById('idModal');
        idModal.style.display = 'block';
        setTimeout(() => {
          idModal.classList.add('show');
        }, 10);
      } else {
        alert("Please create your flower account first to get your unique ID.");
      }
    });
    
    document.getElementById('copyIdButton').addEventListener('click', function() {
      const idText = document.getElementById('userIdDisplay').textContent;
      navigator.clipboard.writeText(idText).then(function() {
        alert('ID copied to clipboard!');
      }).catch(function() {
        alert('Could not copy ID. Please select and copy manually.');
      });
    });
    
    document.getElementById('closeIdModal').addEventListener('click', function() {
      const idModal = document.getElementById('idModal');
      idModal.classList.remove('show');
      setTimeout(() => {
        idModal.style.display = 'none';
      }, 300);
    });
    
    document.getElementById('deleteAccountButton').addEventListener('click', function() {
      deleteUserAccount().then(success => {
        if (success) {
          alert("Compte supprimé avec succès. Vous devrez créer un nouveau compte pour utiliser cette application.");
          const idModal = document.getElementById('idModal');
          idModal.classList.remove('show');
          setTimeout(() => {
            idModal.style.display = 'none';
            const welcomeModal = document.getElementById('welcomeModal');
            welcomeModal.style.display = 'block';
            setTimeout(() => {
              welcomeModal.classList.add('show');
            }, 100);
          }, 300);
        } else {
          alert("Error,  try later");
        }
      });
    });
    
    document.getElementById('refreshMotivation').addEventListener('click', function() {
      const newMotivation = generatePersonalizedMotivation(userFlowerCode, userProfession, userDateOfBirth);
      currentMotivation = newMotivation;
      
      const newSubject = getRandomSubject();
      localStorage.setItem('flowerSubject', newSubject);
      
      const formattedName = formatUserName(userFullName);
      
      const flowerCodeElement = document.getElementById('flowerCodeDisplay');
      if (formattedName) {
        flowerCodeElement.innerHTML = `My Flower - ${newSubject} / ${formattedName}`;
      } else {
        flowerCodeElement.textContent = "My Flower - " + newSubject;
      }
      
      document.getElementById('monthlyMotivation').textContent = newMotivation;
      
      const captureCode = document.getElementById('captureFlowerCode');
      const captureMotivation = document.getElementById('captureFlowerMotivation');
      
      if (captureCode) {
        if (formattedName) {
          captureCode.innerHTML = `My Flower - ${newSubject} / ${formattedName}`;
        } else {
          captureCode.textContent = "My Flower - " + newSubject;
        }
      }
      
      if (captureMotivation) captureMotivation.textContent = newMotivation;
      
      this.style.transition = 'transform 0.5s ease';
      this.style.transform = 'rotate(360deg)';
      
      setTimeout(() => {
        this.style.transition = 'none';
        this.style.transform = 'rotate(0deg)';
      }, 500);
    });
    
    document.getElementById('createAccountButton').addEventListener('click', async function() {
      const dobInput = document.getElementById('dobInput');
      const professionInput = document.getElementById('professionInput');
      const fullNameInput = document.getElementById('fullNameInput');
      
      if (!fullNameInput.value) {
        alert("Please enter your full name.");
        return;
      }
      
      if (!dobInput.value) {
        alert("Please enter your date of birth.");
        return;
      }
      
      if (!professionInput.value) {
        alert("Please enter your profession.");
        return;
      }
      
      document.getElementById('loadingSpinner').style.display = 'block';
      document.getElementById('createAccountButton').disabled = true;
      
      try {
        await authenticateAnonymously();
        
        userFullName = fullNameInput.value;
        userDateOfBirth = dobInput.value;
        userProfession = professionInput.value;
        
        userUniqueId = generateUniqueId();
        console.log("Generated unique ID:", userUniqueId);
        
        userFlowerCode = generateFlowerCode();
        
        const subject = getRandomSubject();
        localStorage.setItem('flowerSubject', subject);
        
        currentMotivation = generatePersonalizedMotivation(userFlowerCode, userProfession, userDateOfBirth);
        
        const createButton = document.getElementById('createAccountButton');
        createButton.innerHTML = '<i class="fas fa-check"></i> Done';
        createButton.style.backgroundColor = '#4CAF50';
        
        const userData = {
          date: new Date().toISOString(),
          uid: userUid,
          uniqueId: userUniqueId,
          flowerCode: userFlowerCode,
          motivation: currentMotivation,
          dateOfBirth: userDateOfBirth,
          profession: userProfession,
          fullName: userFullName,
          formattedName: formatUserName(userFullName),
          timestamp: Date.now(),
          theme: currentTheme,
          subject: subject,
          shareCount: 0
        };
        
        localStorage.setItem('userFlowerData', JSON.stringify(userData));
        localStorage.setItem('isInstalled', 'true');
        setCookie('userUniqueId', userUniqueId, 365);
        setCookie('userFlowerCode', userFlowerCode, 365);
        setCookie('userDateOfBirth', userDateOfBirth, 365);
        setCookie('userProfession', userProfession, 365);
        setCookie('userFullName', userFullName, 365);
        setCookie('isInstalled', 'true', 365);
        isInstalled = true;
        
        setTimeout(() => {
          const welcomeModal = document.getElementById('welcomeModal');
          welcomeModal.classList.remove('show');
          
          setTimeout(() => {
            welcomeModal.style.display = 'none';
            document.getElementById('loadingSpinner').style.display = 'none';
            createButton.innerHTML = 'Create Account';
            createButton.style.backgroundColor = '';
            createButton.disabled = false;
            
            submitToFirebase().then(submitted => {
              console.log("Firebase submission result:", submitted);
              
              const welcomeToast = document.getElementById('welcomeToast');
              welcomeToast.style.display = 'block';
              setTimeout(() => {
                welcomeToast.style.opacity = '1';
              }, 100);
              setTimeout(() => {
                welcomeToast.style.opacity = '0';
                setTimeout(() => {
                  welcomeToast.style.display = 'none';
                }, 500);
              }, 2000);
              
              updateFlowerDisplay();
              const flowerModal = document.getElementById('flowerModal');
              flowerModal.style.display = 'block';
              setTimeout(() => {
                flowerModal.classList.add('show');
              }, 10);
              document.getElementById('shareFlowerButton').style.display = 'flex';
            });
          }, 300);
        }, 2000);
        
        console.log("Setup complete and data stored locally and in cookies");
      } catch (error) {
        console.error("Error during setup:", error);
        document.getElementById('loadingSpinner').style.display = 'none';
        document.getElementById('createAccountButton').disabled = false;
        alert("There was a problem setting up your flower. Please try again.");
      }
    });
    
    async function captureFlower() {
      try {
        const captureContainer = document.getElementById('flowerCaptureContainer');
        
        updateCaptureStyles(currentTheme);
        
        if (typeof html2canvas !== 'function') {
          console.error("html2canvas not loaded or not available as a function");
          alert("Cannot capture flower. The capture library is not loaded.");
          return;
        }
        
        let bgColor = 'white';
        if (currentTheme === 'red-black') bgColor = 'black';
        else if (currentTheme === 'green-blue') bgColor = '#1A2E4D';
        else if (currentTheme === 'orange-pink' || currentTheme === 'yellow-purple') bgColor = '#4B0082';
        
        const canvas = await html2canvas(captureContainer, {
          backgroundColor: bgColor,
          scale: 7,
          logging: true,
          useCORS: true,
          allowTaint: true,
          letterRendering: true
        });
        
        const imageUrl = canvas.toDataURL('image/png');
        
        const capturedImage = document.getElementById('capturedImage');
        if (capturedImage) {
          capturedImage.src = imageUrl;
          document.getElementById('capturedFlower').style.display = 'flex';
          document.getElementById('shareWarning').style.display = 'block';
          
          updateShareCount();
        } else {
          console.error("capturedImage element not found");
        }
      } catch (error) {
        console.error('Error capturing flower:', error);
        alert('Could not capture your flower. Please try again.');
      }
    }
    
    document.getElementById('shareCapture').addEventListener('click', function() {
      const imageUrl = document.getElementById('capturedImage').src;
if (navigator.share) {
        fetch(imageUrl)
          .then(res => res.blob())
          .then(blob => {
            const file = new File([blob], 'my-gz-flower.png', { type: 'image/png' });
            navigator.share({
              title: 'My G-Z Flower',
              text: 'Discover  yours at g-z.online',
              files: [file]
            }).catch(err => {
              console.log('Error sharing:', err);
              fallbackShare();
            });
          })
          .catch(err => {
            console.log('Error preparing image:', err);
            fallbackShare();
          });
      } else {
        fallbackShare();
      }
    });
    
    function fallbackShare() {
      try {
        const shareText = `
Check out my Flower of Life from G-Z: ${userUniqueId}. Discover yours at g-z.online`;
        
        navigator.clipboard.writeText(shareText).then(function() {
          alert('Share text copied to clipboard!');
        }).catch(function() {
          alert('Could not copy share text.');
        });
      } catch (error) {
        console.error('Fallback share error:', error);
        alert('An error occurred.');
      }
    }
    
    document.getElementById('closeCapture').addEventListener('click', function() {
      const imageUrl = document.getElementById('capturedImage').src;
      try {
        // Create an invisible link to trigger download
        const a = document.createElement('a');
        a.href = imageUrl;
        a.download = 'my-flower.png';
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        
        alert('Flower image saved to your device!');
        document.getElementById('capturedFlower').style.display = 'none';
      } catch (error) {
        console.error('Error saving image:', error);
        alert('Could not save the image. Try long-pressing on the image and select "Save image".');
      }
    });
    
    document.getElementById('closeFlowerModal').addEventListener('click', function() {
      const flowerModal = document.getElementById('flowerModal');
      flowerModal.classList.remove('show');
      setTimeout(() => {
        flowerModal.style.display = 'none';
        document.getElementById('shareFlowerButton').style.display = 'none';
      }, 300);
    });

    window.onclick = function(event) {
      const flowerModal = document.getElementById('flowerModal');
      const capturedFlower = document.getElementById('capturedFlower');
      const idModal = document.getElementById('idModal');
      const welcomeModal = document.getElementById('welcomeModal');
      
      if (event.target == flowerModal) {
        flowerModal.classList.remove('show');
        setTimeout(() => {
          flowerModal.style.display = "none";
          document.getElementById('shareFlowerButton').style.display = 'none';
        }, 300);
      }
      
      if (event.target == capturedFlower) {
        capturedFlower.style.display = "none";
      }
      
      if (event.target == idModal) {
        idModal.classList.remove('show');
        setTimeout(() => {
          idModal.style.display = "none";
        }, 300);
      }
      
      if (event.target == welcomeModal && isInstalled) {
        welcomeModal.classList.remove('show');
        setTimeout(() => {
          welcomeModal.style.display = "none";
        }, 300);
      }
    };
    
    document.getElementById('shareFlowerButton').style.display = 'none';
    document.getElementById('shareWarning').style.display = 'none';
    
    document.querySelectorAll('.style-option').forEach(option => {
      option.addEventListener('click', function() {
        const theme = this.dataset.theme;
        setTheme(theme);
      });
    });
  </script>
</body>

</html>
