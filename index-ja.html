<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>G-Z</title>
    <link rel="icon" href="https://firebasestorage.googleapis.com/v0/b/genz-abb36.appspot.com/o/photo_2025-03-09_13-00-43.jpg?alt=media&token=e3d3c543-164c-4c79-8cd1-0a9c710fb002">
    <link href="https://fonts.googleapis.com/css2?family=Billabong&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <style>
        input, textarea, select, button {
            font-size: 16px;
            touch-action: manipulation;
        }
        
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: white;
            position: relative;
            transition: background-color 0.3s ease;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            -webkit-text-size-adjust: 100%;
        }
        header {
            background-color: white;
            padding: 6px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: background-color 0.3s ease;
        }
        
        h1 {
            margin: 0;
            font-size: 1.4em;
            font-family: 'Billabong', cursive;
            color: #007bff;
            border: 2px solid #007bff;
            padding: 4px;
            border-radius: 12px;
            font-weight: bold;
            transition: color 0.3s ease, border-color 0.3s ease;
        }
        .divider {
            height: 0.6px;
            background-color: #007bff;
            width: 100%;
            margin-top: 5px;
            transition: background-color 0.3s ease;
        }
        .button-container {
            display: flex;
            justify-content: center;
            margin-top: 5px;
            padding: 5px 0;
            overflow-x: auto;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        .button-container::-webkit-scrollbar {
            display: none;
        }
        .button {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 5px 10px;
            margin: 0 3px;
            font-size: 0.8em;
            cursor: pointer;
            text-decoration: none;
            display: flex;
            align-items: center;
            flex-shrink: 0;
            transition: background-color 0.3s ease;
        }
        .button i {
            margin-right: 2px;
        }
        .notification {
            text-align: center;
            margin-top: 10px;
            font-size: 0.8em;
            color: #0056b3;
            font-weight: bold;
            transition: color 0.3s ease;
            padding: 3px 0;
            max-height: 30px;
            overflow: hidden;
        }
        .share-icon {
            color: #007bff;
            cursor: pointer;
            font-size: 1.3em;
            border: 1px solid #007bff;
            border-radius: 7px;
            padding: 4px;
            background-color: white;
            transition: color 0.3s ease, border-color 0.3s ease;
        }
        footer {
            background-color: white;
            color: black;
            padding: 10px 15px;
            margin-top: auto;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo-container {
            display: flex;
        }
        .logo {
            color: #007bff;
            font-size: 1.6em;
            margin-right: 10px;
            border: 1px solid #007bff;
            border-radius: 10px;
            padding: 5px;
            background-color: rgba(0, 119, 190, 0.1);
            transition: background-color 0.3s, color 0.3s, border-color 0.3s;
        }
        .logo:hover {
            background-color: #007bff;
            color: white;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.5);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .modal.show {
            opacity: 1;
        }
        .modal-content {
            background-color: white;
            margin: 50% auto;
            padding: 14px;
            border: 1px solid #007bff;
            border-radius: 60px;
            width: 280px;
            max-width: 70%;
            text-align: center;
            max-height: 60vh;
            overflow-y: auto;
            position: relative;
            transition: background-color 0.3s ease, border-color 0.3s ease, transform 0.3s ease;
            transform: scale(0.8);
        }
        .modal.show .modal-content {
            transform: scale(1);
        }
        .modal-header {
            font-size: 1.8em;
            font-family: 'Billabong', cursive;
            margin-bottom: 10px;
            font-weight: bold;
            color: #007bff;
            text-decoration: underline;
            transition: color 0.3s ease;
        }
        
        .modal-footer {
            margin-top: 15px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 6px;
        }
        .close-button {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 12px;
            padding: 8px 10px;
            cursor: pointer;
            font-size: 0.9em;
            width: 120px;
            margin: 4px;
            transition: background-color 0.3s ease;
        }
        .close-button:hover {
            background-color: #0056b3;
        }
        
        @keyframes flowerRotate {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(15deg); }
            50% { transform: rotate(0deg); }
            75% { transform: rotate(-15deg); }
            100% { transform: rotate(0deg); }
        }
        
        .flower-icon {
            display: inline-block;
            animation: flowerRotate 2s infinite ease-in-out;
            color: #ff69b4;
        }
        
        .billabong-title {
            font-family: 'Billabong', cursive;
            font-size: 1.8em;
            margin-bottom: 8px;
            color: #007bff;
            transition: color 0.3s ease;
        }

        .monthly-motivation {
            margin: 15px 0;
            padding: 10px;
            border: 1px dashed #ff69b4;
            border-radius: 15px;
            background-color: white;
            font-style: italic;
            color: #333;
            font-size: 0.9em;
            line-height: 1.4;
            transition: border-color 0.3s ease, color 0.3s ease, background-color 0.3s ease;
            position: relative;
        }
        
        .flower-code {
            display: block;
            font-weight: bold;
            color: #ff69b4;
            font-size: 0.9em;
            margin-bottom: 8px;
            letter-spacing: 0.5px;
            background-color: #fff0f8;
            padding: 6px;
            border-radius: 8px;
            border: 1px solid #ff69b4;
            max-width: 220px;
            margin-left: auto;
            margin-right: auto;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            transition: color 0.3s ease, background-color 0.3s ease, border-color 0.3s ease;
        }
        
        .copy-icon {
            color: #007bff;
            cursor: pointer;
            margin-left: 10px;
            font-size: 1.2em;
            vertical-align: middle;
            transition: color 0.3s ease;
        }
        
        .header-controls {
            display: flex;
            align-items: center;
        }
        
        .celebrate-icon {
            font-size: 2em;
            color: gold;
            margin-bottom: 8px;
            animation: celebrate 2s infinite alternate;
        }
        
        @keyframes celebrate {
            0% { transform: scale(1); }
            50% { transform: scale(1.1) rotate(5deg); }
            100% { transform: scale(1) rotate(-5deg); }
        }
        
        .modal-close {
            position: absolute;
            top: 10px;
            right: 20px;
            color: #ff0000;
            font-size: 13px;
            cursor: pointer;
            background-color: transparent;
            border: none;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background-color 0.2s;
        }
        
        .modal-close:hover {
            background-color: rgba(255, 0, 0, 0.1);
        }
        
        .share-flower-button {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 14px;
            padding: 8px 16px;
            font-size: 0.9em;
            margin: 290px auto;
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s, border-color 0.3s;
            max-width: 190px;
            position: relative;
            z-index: 1001;
            border: 1px solid #0056b3;
        }
        
        .share-flower-button:hover {
            background-color: #0056b3;
        }
        
        .share-flower-button i {
            margin-left: 8px;
        }
        
        #capturedFlower {
            position: fixed;
            z-index: 1003;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .captured-image-container {
            position: relative;
            max-width: 85%;
            max-height: 60vh;
            margin-bottom: 15px;
        }
        
        .captured-image {
            max-width: 100%;
            max-height: 60vh;
            border-radius: 15px;
            border: 2px solid white;
        }
        
        .share-message {
            background-color: white;
            color: #333;
            padding: 10px 15px;
            border-radius: 15px;
            font-size: 0.9em;
            margin: 10px auto;
            max-width: 90%;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        .share-message i {
            margin-left: 8px;
            color: #007bff;
            transition: color 0.3s ease;
        }
        
        .share-link {
            color: #007bff;
            font-weight: bold;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .capture-controls {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }
        
        .capture-button {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 20px;
            padding: 8px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9em;
            transition: background-color 0.3s ease;
        }
        
        .capture-button i {
            margin-right: 5px;
        }
        
        .close-capture {
            background-color: #f0f0f0;
            color: #333;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        #flowerCaptureContainer {
            position: fixed;
            z-index: -1;
            top: 0;
            left: -9999px;
            background-color: white;
            border: 2px solid #007bff;
            border-radius: 20px;
            padding: 15px;
            width: 300px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }
        
        .capture-flower-header {
            font-family: 'Billabong', cursive;
            color: #007bff;
            font-size: 1.8em;
            margin-bottom: 8px;
            text-align: center;
            font-weight: bold;
            text-shadow: 0px 1px 1px rgba(0, 123, 255, 0.2);
            transition: color 0.3s ease;
        }
        
        .capture-flower-code {
            font-weight: bold;
            color: #ff69b4;
            font-size: 0.8em;
            background-color: #fff0f8;
            padding: 6px;
            border-radius: 10px;
            border: 1px solid #ff69b4;
            margin: 6px auto;
            text-align: center;
            max-width: 80%;
            letter-spacing: 0.5px;
            transition: color 0.3s ease, background-color 0.3s ease, border-color 0.3s ease;
        }
        
        .capture-flower-motivation {
            font-style: italic;
            color: #333;
            font-size: 0.95em;
            line-height: 1.4;
            background-color: #f9f9f9;
            border: 1px dashed #ff69b4;
            border-radius: 12px;
            padding: 12px;
            margin: 12px 0;
            text-align: center;
            transition: color 0.3s ease, background-color 0.3s ease, border-color 0.3s ease;
            position: relative;
        }
        
        .capture-flower-icon {
            text-align: center;
            font-size: 2.5em;
            color: #ff69b4;
            margin: 10px 0;
            transition: color 0.3s ease;
        }
        
        .gz-logo {
            font-family: 'Billabong', cursive;
            color: #007bff;
            font-size: 1.4em;
            text-align: center;
            margin-top: 10px;
            border: 2px solid #007bff;
            border-radius: 12px;
            padding: 4px;
            width: 50px;
            margin-left: auto;
            margin-right: auto;
            font-weight: bold;
            transition: color 0.3s ease, border-color 0.3s ease;
        }
        
        .share-warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
            border-radius: 15px;
            padding: 10px 15px;
            font-size: 0.85em;
            margin: 5px auto 15px auto;
            max-width: 90%;
            text-align: center;
            display: none;
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }
        
        .capture-website-url {
            text-align: center;
            font-size: 0.85em;
            color: #007bff;
            font-weight: bold;
            margin-top: 8px;
            font-family: Arial, sans-serif;
            padding: 3px 0;
            border-top: 1px dashed #007bff;
            transition: color 0.3s ease, border-color 0.3s ease;
        }
        
        .terms-text {
            font-size: 0.8em;
            color: black;
            text-align: center;
            margin: 10px auto;
            width: 330px;
            transition: color 0.3s ease;
        }
        
        .billabong-title {
            margin-bottom: 3px;
        }

        .header-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            padding: 0 1px;
        }

        .header-icon {
            font-size: 1.4em;
            color: #007bff;
            border: 2px solid #007bff;
            padding: 4px;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            transition: color 0.3s ease, border-color 0.3s ease;
        }

        .app-logo {
            font-family: 'Billabong', cursive;
            color: #007bff;
            border: 2px solid #007bff;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 1.4em;
            font-weight: bold;
            transition: color 0.3s ease, border-color 0.3s ease;
        }

        .header-flex {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
        }
        
        .right-controls {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        #welcomeToast {
            position: fixed;
            top: 160px;
            left: 0;
            right: 0;
            background-color: rgba(0,0,0,0.7);
            color: white;
            padding: 10px;
            border-radius: 20px;
            width: 80%;
            max-width: 300px;
            margin: 0 auto;
            text-align: center;
            z-index: 2000;
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease;
            font-family: , cursive;
            font-size: 1.1em;
            border: 2px solid #4CAF50;
        }

        #welcomeModal {
            display: none;
            position: fixed;
            z-index: 10;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        #welcomeModal.show {
            opacity: 1;
        }

        #welcomeModal .modal-content {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            margin: 40% auto;
            padding: 15px 10px;
            border: 2px solid #4CAF50;
            border-radius: 25px;
            width: 85%;
            max-width: 290px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            text-align: center;
            transition: transform 0.3s ease;
            transform: scale(0.8);
        }
        #welcomeModal.show .modal-content {
            transform: scale(1);
        }

        #welcomeModal .close {
            color: red;
            font-size: 18px;
            font-weight: bold;
            display: block;
            text-align: center;
            margin-bottom: 3px;
            cursor: pointer;
        }

        #welcomeModal .welcome-header {
            color: #007bff;
            font-family: 'Billabong', cursive;
            font-size: 1.8em;
            margin-bottom: 8px;
            text-align: center;
            font-weight: bold;
        }

        #welcomeModal .welcome-text {
            margin: 10px 0 15px 0;
            font-size: 0.8em;
            color: #333;
            line-height: 1.4;
            transition: color 0.3s ease;
        }

        .dob-container {
            margin: 10px 0;
        }

        .dob-container label {
            display: block;
            font-size: 0.8em;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }

        .dob-input {
            width: 90%;
            padding: 8px;
            border-radius: 10px;
            border: 1px solid #ccc;
            font-size: 16px;
        }

        .profession-container {
            margin: 12px 0;
            position: relative;
        }

        .profession-container label {
            display: block;
            font-size: 0.8em;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }

        .profession-search {
            width: 90%;
            padding: 8px;
            border-radius: 10px;
            border: 1px solid #ccc;
            font-size: 16px;
        }

        .profession-dropdown {
            display: none;
            position: absolute;
            background-color: white;
            border: 1px solid #ccc;
            border-radius: 10px;
            width: 90%;
            max-height: 150px;
            overflow-y: auto;
            left: 5%;
            z-index: 10;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .profession-option {
            padding: 8px 10px;
            font-size: 0.8em;
            cursor: pointer;
            transition: background-color 0.2s;
            background-color: white;
            color: #333;
        }

        .profession-option:hover {
            background-color: #f5f5f5;
        }

        .name-container {
            margin: 10px 0;
        }

        .name-container label {
            display: block;
            font-size: 0.8em;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }

        .name-input {
            width: 90%;
            padding: 8px;
            border-radius: 10px;
            border: 1px solid #ccc;
            font-size: 16px;
        }

        #createAccountButton {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 10px 25px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: bold;
            margin: 10px auto 5px;
            display: block;
            width: 80%;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 123, 255, 0.3);
        }
        
        #createAccountButton:hover {
            background: linear-gradient(135deg, #0056b3 0%, #003d80 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 123, 255, 0.4);
        }
        
        #createAccountButton:active {
            transform: translateY(0);
            box-shadow: 0 1px 3px rgba(0, 123, 255, 0.3);
        }

        .loading-spinner {
            display: none;
            text-align: center;
            margin: 10px 0;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }

        .loading-dots::after {
            content: '...';
            animation: dots 1.5s infinite;
            display: inline-block;
            width: 20px;
            text-align: left;
        }

        #idModal {
            display: none;
            position: fixed;
            z-index: 1001;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        #idModal.show {
            opacity: 1;
        }

        #idModal .modal-content {
            background-color: #fff;
            margin: 45% auto;
            padding: 15px;
            border: 1px solid #007BFF;
            border-radius: 25px;
            width: 65%;
            max-width: 250px;
            text-align: center;
            transition: transform 0.3s ease;
            transform: scale(0.8);
        }
        #idModal.show .modal-content {
            transform: scale(1);
        }

        .id-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }

        .id-title {
            font-size: 1em;
            color: #007bff;
            margin-bottom: 5px;
            transition: color 0.3s ease;
        }

        .id-display {
            font-weight: bold;
            font-size: 1.2em;
            color: #ff69b4;
            background-color: #fff0f8;
            padding: 6px;
            border-radius: 8px;
            border: 1px solid #ff69b4;
            margin: 5px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            max-width: 80%;
            transition: color 0.3s ease, background-color 0.3s ease, border-color 0.3s ease;
        }

        .delete-account {
            background-color: #ff4d4d;
            color: white;
            border: none;
            border-radius: 12px;
            padding: 6px 10px;
            font-size: 0.7em;
            cursor: pointer;
            transition: background-color 0.3s;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .delete-account:hover {
            background-color: #e60000;
        }

        .copy-icon {
            margin-left: 6px;
        }

        .id-message {
            font-size: 0.7em;
            color: #333;
            margin: 5px 0;
            transition: color 0.3s ease;
        }

        #idModal .close-button {
            margin-top: 8px;
            width: auto;
            padding: 6px 15px;
            font-size: 0.7em;
            height: 28px;
        }

        .menu-link {
            text-decoration: none;
            color: #007bff;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: color 0.3s ease;
        }
        
        .style-selector {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: white;
            padding: 10px 0;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 100;
            transition: background-color 0.3s ease;
        }
        
        .style-selector h3 {
            text-align: center;
            margin: 0 0 10px 0;
            font-size: 1em;
            color: #333;
            transition: color 0.3s ease;
        }
        
        .style-options {
            display: flex;
            justify-content: center;
            gap: 10px;
            padding: 0 5px;
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .style-options::-webkit-scrollbar {
            display: none;
        }
        
        .style-option {
            width: 60px;
            height: 40px;
            border-radius: 10px;
            cursor: pointer;
            flex-shrink: 0;
            position: relative;
            border: 1px solid #ddd;
            overflow: hidden;
        }
        
        .style-option.selected {
            border: 2px solid white;
            box-shadow: 0 0 0 2px #007bff;
        }
        
        .style-option.red-black {
            background: linear-gradient(to right, #FF4500, #8B0000, #121212, #121212);
        }
        
        .style-option.green-blue {
            background: linear-gradient(to right, #3EB489, #14532D, #0A2239, #1A2E4D);
        }
        
        .style-option.orange-pink {
            background: linear-gradient(to right, #FF7F50, #FF6F91, #C71585, #4B0082);
        }
        
        .style-option.yellow-purple {
            background: linear-gradient(to right, #FFD700, #FFA500, #8A2BE2, #4B0082);
        }
        
        .style-option.default {
            background: linear-gradient(to right, #007bff, #0056b3);
        }
        
        .main-content {
            padding-bottom: 80px;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
        }
        
        body.theme-default {
            background-color: white;
            color: #333;
        }
        
        body.theme-default header, 
        body.theme-default footer,
        body.theme-default .style-selector {
            background-color: white;
        }
        
        body.theme-default .app-logo,
        body.theme-default .header-icon,
        body.theme-default .divider,
        body.theme-default .notification,
        body.theme-default .billabong-title,
        body.theme-default .gz-logo,
        body.theme-default .capture-website-url,
        body.theme-default .capture-flower-header,
        body.theme-default .id-title {
            color: #007bff;
            border-color: #007bff;
        }
        
        body.theme-default .notification .notification-text {
            color: #007bff;
        }
        
        body.theme-default .button {
            background-color: #007bff;
        }
        
        body.theme-default .share-flower-button {
            background-color: #007bff;
            color: white;
            border-color: #0056b3;
        }
        
        body.theme-default .flower-code,
        body.theme-default .id-display {
            color: #ff69b4;
            background-color: #fff0f8;
            border-color: #ff69b4;
        }
        
        body.theme-default .monthly-motivation,
        body.theme-default .capture-flower-motivation {
            border-color: #ff69b4;
            color: #333;
            background-color: white;
        }
        
        body.theme-default .modal-content {
            background-color: white;
            border-color: #007bff;
        }
        
        body.theme-red-black {
            background: black;
            color: #E5E5E5;
        }
        
        body.theme-red-black header, 
        body.theme-red-black footer,
        body.theme-red-black .style-selector {
            background-color: black;
        }
        
        body.theme-red-black .app-logo,
        body.theme-red-black .header-icon,
        body.theme-red-black .gz-logo,
        body.theme-red-black .capture-flower-header,
        body.theme-red-black .capture-website-url,
        body.theme-red-black .id-title,
        body.theme-red-black .billabong-title {
            color: #FF4500;
            border-color: #FF4500;
        }
        
        body.theme-red-black .divider {
            background-color: #FF4500;
        }
        
        body.theme-red-black .notification .notification-text {
            color: #FF4500;
        }
        
        body.theme-red-black .notification,
        body.theme-red-black .welcome-text,
        body.theme-red-black .id-message {
            color: #CCCCCC;
        }
        
        body.theme-red-black .button {
            background-color: #8B0000;
        }
        
        body.theme-red-black .share-flower-button {
            background-color: #8B0000;
            color: white;
            border-color: #FF4500;
        }
        
        body.theme-red-black .flower-code,
        body.theme-red-black .id-display {
            color: #FF4500;
            background-color: black;
            border-color: #FF4500;
        }
        
        body.theme-red-black .monthly-motivation,
        body.theme-red-black .capture-flower-motivation {
            border-color: #FF4500;
            color: #E5E5E5;
            background-color: black;
        }
        
        body.theme-red-black .modal-content,
        body.theme-red-black #flowerCaptureContainer {
            background-color: black;
            border-color: #8B0000;
        }
        
        body.theme-green-blue {
            background: #1A2E4D;
            color: #F5F5F5;
        }
        
        body.theme-green-blue header, 
        body.theme-green-blue footer,
        body.theme-green-blue .style-selector {
            background-color: #1A2E4D;
        }
        
        body.theme-green-blue .app-logo,
        body.theme-green-blue .header-icon,
        body.theme-green-blue .gz-logo,
        body.theme-green-blue .capture-flower-header,
        body.theme-green-blue .capture-website-url,
        body.theme-green-blue .id-title,
        body.theme-green-blue .billabong-title {
            color: #3EB489;
            border-color: #3EB489;
        }
        
        body.theme-green-blue .divider {
            background-color: #3EB489;
        }
        
        body.theme-green-blue .notification .notification-text {
            color: #3EB489;
        }
        
        body.theme-green-blue .notification,
        body.theme-green-blue .welcome-text,
        body.theme-green-blue .id-message {
            color: #A0A0A0;
        }
        
        body.theme-green-blue .button {
            background-color: #14532D;
        }
        
        body.theme-green-blue .share-flower-button {
            background-color: #14532D;
            color: white;
            border-color: #3EB489;
        }
        
        body.theme-green-blue .flower-code,
        body.theme-green-blue .id-display {
            color: #3EB489;
            background-color: #36454F;
            border-color: #3EB489;
        }
        
        body.theme-green-blue .monthly-motivation,
        body.theme-green-blue .capture-flower-motivation {
            border-color: #3EB489;
            color: #F5F5F5;
            background-color: #1A2E4D;
        }
        
        body.theme-green-blue .modal-content,
        body.theme-green-blue #flowerCaptureContainer {
            background-color: #1A2E4D;
            border-color: #3EB489;
        }
        
        body.theme-orange-pink {
            background: #4B0082;
            color: #FFFFFF;
        }
        
        body.theme-orange-pink header, 
        body.theme-orange-pink footer,
        body.theme-orange-pink .style-selector {
            background-color: #4B0082;
        }
        
        body.theme-orange-pink .app-logo,
        body.theme-orange-pink .header-icon,
        body.theme-orange-pink .gz-logo,
        body.theme-orange-pink .capture-flower-header,
        body.theme-orange-pink .capture-website-url,
        body.theme-orange-pink .id-title,
        body.theme-orange-pink .billabong-title {
            color: #FF7F50;
            border-color: #FF7F50;
        }
        
        body.theme-orange-pink .divider {
            background-color: #FF7F50;
        }
        
        body.theme-orange-pink .notification .notification-text {
            color: #FF7F50;
        }
        
        body.theme-orange-pink .notification,
        body.theme-orange-pink .welcome-text,
        body.theme-orange-pink .id-message {
            color: #D3D3D3;
        }
        
        body.theme-orange-pink .button {
            background-color: #C71585;
        }
        
        body.theme-orange-pink .share-flower-button {
            background-color: #C71585;
            color: white;
            border-color: #FF7F50;
        }
        
        body.theme-orange-pink .flower-code,
        body.theme-orange-pink .id-display {
            color: #FF7F50;
            background-color: #6A0DAD;
            border-color: #FF7F50;
        }
        
        body.theme-orange-pink .monthly-motivation,
        body.theme-orange-pink .capture-flower-motivation {
            border-color: #FF7F50;
            color: #FFFFFF;
            background-color: #4B0082;
        }
        
        body.theme-orange-pink .modal-content,
        body.theme-orange-pink #flowerCaptureContainer {
            background-color: #4B0082;
            border-color: #FF7F50;
        }

        body.theme-yellow-purple {
            background: #4B0082;
            color: #FFFFFF;
        }
        
        body.theme-yellow-purple header, 
        body.theme-yellow-purple footer,
        body.theme-yellow-purple .style-selector {
            background-color: #4B0082;
        }
        
        body.theme-yellow-purple .app-logo,
        body.theme-yellow-purple .header-icon,
        body.theme-yellow-purple .gz-logo,
        body.theme-yellow-purple .capture-flower-header,
        body.theme-yellow-purple .capture-website-url,
        body.theme-yellow-purple .id-title,
        body.theme-yellow-purple .billabong-title {
            color: #FFD700;
            border-color: #FFD700;
        }
        
        body.theme-yellow-purple .divider {
            background-color: #FFD700;
        }
        
        body.theme-yellow-purple .notification .notification-text {
            color: #FFD700;
        }
        
        body.theme-yellow-purple .notification,
        body.theme-yellow-purple .welcome-text,
        body.theme-yellow-purple .id-message {
            color: #D3D3D3;
        }
        
        body.theme-yellow-purple .button {
            background-color: #8A2BE2;
        }
        
        body.theme-yellow-purple .share-flower-button {
            background-color: #8A2BE2;
            color: white;
            border-color: #FFD700;
        }
        
        body.theme-yellow-purple .flower-code,
        body.theme-yellow-purple .id-display {
            color: #FFD700;
            background-color: #6A0DAD;
            border-color: #FFD700;
        }
        
        body.theme-yellow-purple .monthly-motivation,
        body.theme-yellow-purple .capture-flower-motivation {
            border-color: #FFD700;
            color: #FFFFFF;
            background-color: #4B0082;
        }
        
        body.theme-yellow-purple .modal-content,
        body.theme-yellow-purple #flowerCaptureContainer {
            background-color: #4B0082;
            border-color: #FFD700;
        }
        
        .refresh-motivation {
            position: absolute;
            right: 15px;
            top: 70px;
            color: #007bff;
            cursor: pointer;
            font-size: 1.2em;
            padding: 5px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transition: transform 0.3s ease, color 0.3s ease;
        }
        
        .refresh-motivation:hover {
            transform: rotate(180deg);
        }
        
        body.theme-red-black .refresh-motivation {
            color: #FF4500;
        }
        
        body.theme-green-blue .refresh-motivation {
            color: #3EB489;
        }
        
        body.theme-orange-pink .refresh-motivation {
            color: #FF7F50;
        }
        
        body.theme-yellow-purple .refresh-motivation {
            color: #FFD700;
        }
        
        .user-name {
            font-size: 0.75em;
            font-weight: bold;
        }
    </style>
</head>
<body class="theme-green-blue">

  <header>
   
    <div class="header-container">
      <div class="app-logo" translate="no">G-Z</div>
      
      <div class="right-controls">
      
        <a href="https://g-z.online/language.html" class="header-icon menu-link"><i class="fas fa-globe"></i></a>
        
      <div class="right-controls">
        <div class="header-icon" id="showIdButton"><i class="fas fa-user"></i></div>
  
        
        <a href="https://g-z.online/us.html" class="header-icon menu-link"><i class="fas fa-bars"></i></a>
      </div>
    </div>
  </header>

  <div class="divider"></div>

  <div class="main-content">
    <div class="button-container">
      <a class="button" href="#" id="flowerButton"><i class="fas fa-spa flower-icon"></i><span>Flor da vida</span></a>
    </div>

    <div class="divider"></div>
    <div class="notification">
      <span class="notification-text">üí† Flor -- A mensagem que o universo escreveu s√≥ para voc√™ ¬Ø\_(„ÉÑ)_/¬Ø</span>
    </div>

    <div class="divider"></div>
  </div>

  <div class="style-selector">
    <h3>Estilo</h3>
    <div class="style-options">
      <div class="style-option red-black" data-theme="red-black"></div>
      <div class="style-option green-blue selected" data-theme="green-blue"></div>
      <div class="style-option orange-pink" data-theme="orange-pink"></div>
      <div class="style-option yellow-purple" data-theme="yellow-purple"></div>
      <div class="style-option default" data-theme="default"></div>
    </div>
  </div>

  <div id="welcomeToast" translate="no">
    Bem-vindo ¬Ø\_(„ÉÑ)_/¬Ø
  </div>

  <div id="welcomeModal" class="modal">
    <div class="modal-content">
      <div class="welcome-header">üí† Bem-vindo üí†</div>
      <div class="welcome-text">
        A cria√ß√£o de uma conta requer sua data de nascimento, profiss√£o e nome para criar sua flor √∫nica.
      </div>
      
      <div class="name-container">
        <label for="fullNameInput">Seu Nome Completo:</label>
        <input type="text" id="fullNameInput" class="name-input" placeholder="Digite seu nome completo...">
      </div>
      
      <div class="dob-container">
        <label for="dobInput">Data de Nascimento:</label>
        <input type="date" id="dobInput" class="dob-input" max="">
      </div>
      
      <div class="profession-container">
        <label for="professionInput">Sua Profiss√£o:</label>
        <input type="text" id="professionInput" class="profession-search" placeholder="Digite sua profiss√£o...">
        <div id="professionDropdown" class="profession-dropdown"></div>
      </div>
      
      <div class="loading-spinner" id="loadingSpinner">
        <span>Criando sua flor √∫nica</span>
        <span class="loading-dots"></span>
      </div>
      
      <button id="createAccountButton">Criar Conta</button>
    </div>
  </div>

  <div id="idModal" class="modal">
    <div class="modal-content">
      <div class="id-title">Seu ID de Usu√°rio</div>
      <div class="id-display">
        <span id="userIdDisplay"></span>
        <i class="fas fa-copy copy-icon" id="copyIdButton"></i>
      </div>
      <div class="id-message">Mantenha este ID seguro!</div>
      <div class="id-actions">
        <button class="delete-account" id="deleteAccountButton">Excluir Conta</button>
        <button class="close-button" id="closeIdModal">Fechar</button>
      </div>
    </div>
  </div>

  <div id="flowerModal" class="modal">
    <div class="modal-content">
      <button class="modal-close" id="closeFlowerModal"><i class="fas fa-times"></i></button>
      <div class="billabong-title"><strong id="flowerTypeTitle">Flor da Vida</strong></div>
      
      <div id="flowerCodeDisplay" class="flower-code"></div>
      
      <i class="fas fa-sync-alt refresh-motivation" id="refreshMotivation" title="Gerar nova motiva√ß√£o"></i>
      
      <div class="monthly-motivation" id="monthlyMotivation">
      </div>
      
      <div style="margin: 10px auto; font-size: 3em; color: #ff69b4;" id="flowerIconContainer">
        <i class="fas fa-spa"></i>
      </div>
    </div>
  </div>
  
  <button class="share-flower-button" id="shareFlowerButton">
    <span>Compartilhar minha Flor</span> <i class="fas fa-arrow-right send-icon"></i>
  </button>
  
  <div id="capturedFlower">
    <div class="captured-image-container">
      <img id="capturedImage" class="captured-image" src="" alt="Flor Capturada">
    </div>

    <div class="share-warning" id="shareWarning">
      <i class="fas fa-exclamation-triangle" style="margin-right: 5px;"></i>
      <span>Perfeito para compartilhar, apenas ajuste.</span>
    </div>
    
    <div class="capture-controls">
      <button class="capture-button" id="shareCapture">
        <i class="fas fa-share"></i> <span>Compartilhar</span>
      </button>
      
      <button class="capture-button close-capture" id="closeCapture">
        <i class="fas fa-download"></i> <span>Salvar</span>
      </button>
    </div>
  </div>
  
  <div id="flowerCaptureContainer">
    <div class="capture-flower-header" id="captureFlowerHeader">Flor da Vida</div>
    
    <div id="captureFlowerCode" class="capture-flower-code"></div>
    
    <div id="captureFlowerMotivation" class="capture-flower-motivation">
    </div>
    
    <div class="capture-flower-icon" id="captureFlowerIcon">
      <i class="fas fa-spa"></i>
    </div>
    
    <div class="gz-logo" translate="no">G-Z</div>
  <div class="capture-website-url">
  Descubra a sua em <span translate="no">www.g-z.online</span>
</div>

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCrPKQOqw4zciASa_5PbI_etfkvrBaDPDI",
      authDomain: "genz-abb36.firebaseapp.com",
      databaseURL: "https://genz-abb36-default-rtdb.firebaseio.com",
      projectId: "genz-abb36",
      storageBucket: "genz-abb36.firebasestorage.app",
      messagingSenderId: "405021535683",
      appId: "1:405021535683:web:ee5a28fde27f5558046176",
      measurementId: "G-XZNQND2J00"
    };

    firebase.initializeApp(firebaseConfig);
    
    const auth = firebase.auth();
    const database = firebase.database();
    const firestore = firebase.firestore();
    
    let userUid = null;
    let userFlowerCode = null;
    let currentMotivation = null;
    let currentCountry = null;
    let userCity = null;
    let userUniqueId = null;
    let isAuthenticated = false;
    let isInstalled = false;
    let currentTheme = "green-blue";
    let userDateOfBirth = null;
    let userProfession = null;
    let userFullName = null;
    let seenSubjects = [];
    let shareCount = 0;
    let userRank = 0;
    let userEmoji = "üëë";

    const rankEmojis = ["üëë", "üåü", "üî•", "‚ö°Ô∏è", "‚≠êÔ∏è", "‚ùÑÔ∏è", "‚ú®Ô∏è", "üéñ", "üóø"];

    const professions = [
      "M√∫sico", "Rapper", "Jogador de Futebol", "Jogador de Basquete", "Boxeador", 
      "Estudante", "Professor", "M√©dico", "Enfermeiro", "Engenheiro", 
      "Desenvolvedor", "Designer", "Artista", "Escritor", "Jornalista", 
      "Chef de cozinha", "Gar√ßom/Gar√ßonete", "Empregada dom√©stica", "TikToker", "YouTuber", 
      "Influenciador", "Fot√≥grafo", "Vide√≥grafo", "Dan√ßarino", "Ator/Atriz", 
      "Modelo", "Arquiteto", "Advogado", "Contador", "Consultor financeiro", 
      "Banc√°rio", "Empreendedor", "Propriet√°rio de empresa", "Gerente", "Executivo", 
      "Vendedor", "Marqueteiro", "Gerente de m√≠dia social", "Motorista", "Piloto", 
      "Comiss√°rio de bordo", "Mec√¢nico", "Eletricista", "Encanador", "Oper√°rio da constru√ß√£o", 
      "Agricultor", "Jardineiro", "Veterin√°rio", "Treinador esportivo", "Instrutor de fitness", 
      "Professor de yoga", "Terapeuta", "Psic√≥logo", "Conselheiro", "Pastor/L√≠der religioso",
      "Cientista", "Pesquisador", "Professor universit√°rio", "Policial", "Bombeiro",
      "Militar", "Seguran√ßa", "Corretor de im√≥veis", "Farmac√™utico", "Dentista",
      "Optometrista", "Fisioterapeuta", "Terapeuta ocupacional", "Fonoaudi√≥logo", "Nutricionista",
      "Nutricionista cl√≠nico", "Cabeleireiro", "Maquiador", "Esteticista", "Alfaiate",
      "Designer de moda", "Funcion√°rio de loja", "Caixa", "Atendimento ao cliente", "Atendente de call center",
      "Tradutor", "Int√©rprete", "Guia tur√≠stico", "Agente de viagens", "Gerente de hotel",
      "Recepcionista", "Secret√°rio", "Assistente administrativo", "Bibliotec√°rio", "Arquivista",
      "Historiador", "Arque√≥logo", "Antrop√≥logo", "Soci√≥logo", "Cientista pol√≠tico",
      "Economista", "Estat√≠stico", "Analista de dados", "Cientista de dados", "Designer UX/UI",
      "Desenvolvedor de jogos", "Desenvolvedor de aplicativos", "Desenvolvedor web", "Administrador de rede", "Especialista em ciberseguran√ßa",
      "Suporte t√©cnico", "T√©cnico", "Especialista em reparos", "Padeiro", "A√ßougueiro",
      "Pescador", "Minerador", "Silvicultor", "Paisagista", "Decorador de interiores",
      "Organizador de eventos", "Organizador de casamentos", "Florista", "Joalheiro", "Artes√£o",
      "Programador", "Webdesigner", "Especialista em marketing digital", "Especialista SEO", "Criador de conte√∫do",
      "Gerente de produto", "Gerente de projeto", "Controle de qualidade", "Analista de neg√≥cios", "Consultor",
      "Recrutador", "Gerente de RH", "Coach de carreira", "Coach de vida", "Palestrante motivacional",
      "Palestrante", "Locutor de r√°dio", "Apresentador de TV", "Jornalista de TV", "Podcaster",
      "Autor", "Roteirista", "Redator", "Redator t√©cnico", "Editor",
      "Editor de livros", "Agente liter√°rio", "Livreiro", "Bibliotec√°rio", "Cr√≠tico liter√°rio",
      "Designer gr√°fico", "Ilustrador", "Animador", "Artista 3D", "Artista VFX",
      "Diretor", "Produtor", "Operador de c√¢mera", "Engenheiro de som", "T√©cnico de ilumina√ß√£o",
      "Editor de v√≠deo", "Assistente de produ√ß√£o", "Cen√≥grafo", "Figurinista", "Maquiador de cinema",
      "Artista de efeitos especiais", "Dubl√™", "Dublador", "Agente art√≠stico", "Diretor de elenco"
    ];

    const subjectDictionary = {
    "Sucesso": "Sucesso",
    "Conquista": "Conquista",
    "Vit√≥ria": "Vit√≥ria",
    "Triunfo": "Triunfo",
    "Realiza√ß√£o": "Realiza√ß√£o",
    
    "Riqueza": "Riqueza",
    "Prosperidade": "Prosperidade",
    "Abund√¢ncia": "Abund√¢ncia",
    "Fortuna": "Fortuna",
    "Aflu√™ncia": "Aflu√™ncia",
    
    "Alegria": "Alegria",
    "Felicidade": "Felicidade",
    "√äxtase": "√äxtase",
    "Deleite": "Deleite",
    "Contentamento": "Contentamento",
    
    "Crescimento": "Crescimento",
    "Progresso": "Progresso",
    "Avan√ßo": "Avan√ßo",
    "Desenvolvimento": "Desenvolvimento",
    "Melhoria": "Melhoria",
    
    "Poder": "Poder",
    "For√ßa": "For√ßa",
    "Pot√™ncia": "Pot√™ncia",
    "Energia": "Energia",
    
    "Sabedoria": "Sabedoria",
    "Intelig√™ncia": "Intelig√™ncia",
    "Conhecimento": "Conhecimento",
    "Perspic√°cia": "Perspic√°cia",
    "Compreens√£o": "Compreens√£o",
    
    "Criatividade": "Criatividade",
    "Inova√ß√£o": "Inova√ß√£o",
    "Imagina√ß√£o": "Imagina√ß√£o",
    "Inven√ß√£o": "Inven√ß√£o",
    "Originalidade": "Originalidade",
    
    "Lideran√ßa": "Lideran√ßa",
    "Autoridade": "Autoridade",
    "Influ√™ncia": "Influ√™ncia",
    "Comando": "Comando",
    "Dire√ß√£o": "Dire√ß√£o",
    
    "Paz": "Paz",
    "Harmonia": "Harmonia",
    "Tranquilidade": "Tranquilidade",
    "Serenidade": "Serenidade",
    "Calma": "Calma",
    
    "Amor": "Amor",
    "Afei√ß√£o": "Afei√ß√£o",
    "Adora√ß√£o": "Adora√ß√£o",
    "Devo√ß√£o": "Devo√ß√£o",
    "Paix√£o": "Paix√£o",
    
    "Coragem": "Coragem",
    "Bravura": "Bravura",
    "Valor": "Valor",
    "Hero√≠smo": "Hero√≠smo",
    "Destemor": "Destemor",
    
    "Sa√∫de": "Sa√∫de",
    "Vitalidade": "Vitalidade",
    "Bem-estar": "Bem-estar",
    "Vigor": "Vigor",
    "Forma f√≠sica": "Forma f√≠sica",
    
    "Liberdade": "Liberdade",
    "Independ√™ncia": "Independ√™ncia",
    "Autonomia": "Autonomia",
    "Autodetermina√ß√£o": "Autodetermina√ß√£o",
    
    "Prop√≥sito": "Prop√≥sito",
    "Significado": "Significado",
    "Miss√£o": "Miss√£o",
    "Voca√ß√£o": "Voca√ß√£o",
    "Destino": "Destino",
    
    "Resili√™ncia": "Resili√™ncia",
    "Tenacidade": "Tenacidade",
    "Perseveran√ßa": "Perseveran√ßa",
    "Resist√™ncia": "Resist√™ncia",
    "Determina√ß√£o": "Determina√ß√£o",
    
    "Autenticidade": "Autenticidade",
    "Genuinidade": "Genuinidade",
    "Honestidade": "Honestidade",
    "Integridade": "Integridade",
    "Sinceridade": "Sinceridade",
    
    "Transforma√ß√£o": "Transforma√ß√£o",
    "Mudan√ßa": "Mudan√ßa",
    "Evolu√ß√£o": "Evolu√ß√£o",
    "Renascimento": "Renascimento",
    "Metamorfose": "Metamorfose",
    
    "Conex√£o": "Conex√£o",
    "Relacionamento": "Relacionamento",
    "Comunidade": "Comunidade",
    "Pertencimento": "Pertencimento",
    "Unidade": "Unidade",
    
    "Gratid√£o": "Gratid√£o",
    "Agradecimento": "Agradecimento",
    "Aprecia√ß√£o": "Aprecia√ß√£o",
    "Reconhecimento": "Reconhecimento",
    "Reconhecimento": "Reconhecimento",
    
    "Aten√ß√£o plena": "Aten√ß√£o plena",
    "Presen√ßa": "Presen√ßa",
    "Consci√™ncia": "Consci√™ncia",
    "Consci√™ncia": "Consci√™ncia",
    "Aten√ß√£o": "Aten√ß√£o",
    
    "Compaix√£o": "Compaix√£o",
    "Empatia": "Empatia",
    "Bondade": "Bondade",
    "Generosidade": "Generosidade",
    "Altru√≠smo": "Altru√≠smo",
    
    "Equil√≠brio": "Equil√≠brio",
    "Equil√≠brio": "Equil√≠brio",
    "Harmonia": "Harmonia",
    "Propor√ß√£o": "Propor√ß√£o",
    "Simetria": "Simetria",
    
    "Inspira√ß√£o": "Inspira√ß√£o",
    "Motiva√ß√£o": "Motiva√ß√£o",
    "Entusiasmo": "Entusiasmo",
    "Excita√ß√£o": "Excita√ß√£o",
    "Paix√£o": "Paix√£o",
    
    "Foco": "Foco",
    "Concentra√ß√£o": "Concentra√ß√£o",
    "Aten√ß√£o": "Aten√ß√£o",
    "Disciplina": "Disciplina",
    "Dedica√ß√£o": "Dedica√ß√£o",
    
    "Humildade": "Humildade",
    "Mod√©stia": "Mod√©stia",
    "Simplicidade": "Simplicidade",
    "Simplicidade": "Simplicidade",
    "Fundamenta√ß√£o": "Fundamenta√ß√£o",
    
    "Paci√™ncia": "Paci√™ncia",
    "Toler√¢ncia": "Toler√¢ncia",
    "Paci√™ncia": "Paci√™ncia",
    "Resist√™ncia": "Resist√™ncia",
    "Persist√™ncia": "Persist√™ncia",
    
    "Alegria": "Alegria",
    "Deleite": "Deleite",
    "Contentamento": "Contentamento",
    "Exulta√ß√£o": "Exulta√ß√£o",
    "J√∫bilo": "J√∫bilo",
    
    "Confian√ßa": "Confian√ßa",
    "F√©": "F√©",
    "Confian√ßa": "Confian√ßa",
    "Confian√ßa": "Confian√ßa",
    "Confiabilidade": "Confiabilidade",
    
    "Autoconfian√ßa": "Autoconfian√ßa",
    "Autoestima": "Autoestima",
    "Autocren√ßa": "Autocren√ßa",
    "Autoconfian√ßa": "Autoconfian√ßa",
    "Autoconfian√ßa": "Autoconfian√ßa",
    
    "Entusiasmo": "Entusiasmo",
    "Zelo": "Zelo",
    "Avidez": "Avidez",
    "Ardor": "Ardor",
    "Fervor": "Fervor",
    
    "Clareza": "Clareza",
    "Lucidez": "Lucidez",
    "Transpar√™ncia": "Transpar√™ncia",
    "Precis√£o": "Precis√£o",
    "Nitidez": "Nitidez",
    
    "Adaptabilidade": "Adaptabilidade",
    "Flexibilidade": "Flexibilidade",
    "Versatilidade": "Versatilidade",
    "Adaptabilidade": "Adaptabilidade",
    "Maleabilidade": "Maleabilidade",
    
    "Comunica√ß√£o": "Comunica√ß√£o",
    "Express√£o": "Express√£o",
    "Articula√ß√£o": "Articula√ß√£o",
    "Di√°logo": "Di√°logo",
    "Conversa": "Conversa",
    
    "Carreira": "Carreira",
    "Profiss√£o": "Profiss√£o",
    "Voca√ß√£o": "Voca√ß√£o",
    "Ocupa√ß√£o": "Ocupa√ß√£o",
    "Voca√ß√£o": "Voca√ß√£o"
};

    async function getUserRankAndEmoji() {
      try {
        const userCount = await getUserCount();
        userRank = userCount % rankEmojis.length;
        userEmoji = rankEmojis[userRank];
        console.log(`User rank: ${userRank}, emoji: ${userEmoji}`);
        return userEmoji;
      } catch (error) {
        console.error("Erro ao obter classifica√ß√£o do usu√°rio:", error);
        return "üëë";
      }
    }

    async function getUserCount() {
      try {
        const snapshot = await firestore.collection('flowerCodes').get();
        return snapshot.size;
      } catch (error) {
        console.error("Erro ao contar usu√°rios:", error);
        return 0;
      }
    }

    function formatUserName(fullName) {
      if (!fullName) return "";
      
      const nameParts = fullName.trim().split(' ');
      
      if (nameParts.length === 1) {
        return nameParts[0];
      }
      
      const firstName = nameParts[0];
      const lastNameInitial = nameParts[nameParts.length - 1].charAt(0).toUpperCase();
      
      return `${firstName} ${lastNameInitial}.`;
    }

    function generateUniqueId() {
      const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      const numbers = '0123456789';
      let id = '';
      
      for (let i = 0; i < 3; i++) {
        id += letters.charAt(Math.floor(Math.random() * letters.length));
      }
      
      for (let i = 0; i < 3; i++) {
        id += numbers.charAt(Math.floor(Math.random() * numbers.length));
      }
      
      return id;
    }

    async function detectUserLocation() {
      try {
        const response = await fetch('https://ipapi.co/json/');
        const data = await response.json();
        currentCountry = data.country_name;
        userCity = data.city;
        console.log("Localiza√ß√£o do usu√°rio detectada:", currentCountry, userCity);
        return { country: currentCountry, city: userCity };
      } catch (error) {
        console.error("Erro ao detectar localiza√ß√£o:", error);
        return { country: "Desconhecido", city: "Desconhecido" };
      }
    }

    function generatePersonalizedMotivation(flowerCode, profession, dob) {
      if (!flowerCode || flowerCode.length < 8) {
        return "Sua motiva√ß√£o floral est√° aqui para inspirar e guiar voc√™.";
      }
      
      let month = 0;
      if (dob) {
        const dobDate = new Date(dob);
        month = dobDate.getMonth();
      }
      
      const lifeTraits = [
        "Sua criatividade traz ideias frescas para cada desafio.",
        "Sua gentileza inspira os outros ao seu redor.",
        "Sua perseveran√ßa ajuda voc√™ a superar obst√°culos.",
        "Sua perspectiva √∫nica resolve problemas de novas maneiras.",
        "Sua energia ilumina o dia de todos que voc√™ encontra.",
        "Sua paci√™ncia ajuda voc√™ a ver o quadro geral.",
        "Sua coragem permite que voc√™ encare novos desafios.",
        "Sua sabedoria guia voc√™ atrav√©s de decis√µes dif√≠ceis.",
        "Seu otimismo ajuda voc√™ a encontrar oportunidades em todas as situa√ß√µes.",
        "Seu foco ajuda voc√™ a alcan√ßar seus objetivos passo a passo.",
        "Sua adaptabilidade √© sua maior for√ßa.",
        "Sua intui√ß√£o guia voc√™ para o caminho certo.",
        "Sua empatia conecta voc√™ profundamente com os outros.",
        "Sua resili√™ncia ajuda voc√™ a se recuperar mais forte.",
        "Sua autenticidade atrai pessoas para seu verdadeiro eu.",
        "Sua gratid√£o multiplica a alegria em sua vida.",
        "Sua curiosidade leva a novas descobertas.",
        "Seu senso de humor ilumina at√© os momentos dif√≠ceis.",
        "Sua generosidade cria ondas de bondade.",
        "Sua determina√ß√£o transforma desafios em sucessos.",
        "Sua compaix√£o cura aqueles ao seu redor.",
        "Sua clareza ajuda voc√™ a fazer escolhas s√°bias.",
        "Sua confian√ßa inspira confian√ßa nos outros.",
        "Sua aten√ß√£o plena mant√©m voc√™ centrado no caos.",
        "Sua integridade faz voc√™ ganhar respeito onde quer que v√°.",
        "Seu entusiasmo acende paix√£o nos outros.",
        "Seu calor faz as pessoas se sentirem instantaneamente bem-vindas.",
        "Sua imagina√ß√£o abre portas para possibilidades.",
        "Seu equil√≠brio ajuda voc√™ a navegar nas complexidades da vida.",
        "Sua vis√£o permite que voc√™ veja al√©m do horizonte.",
        "Seu carisma atrai pessoas para sua energia.",
        "Sua disciplina constr√≥i a base para o sucesso.",
        "Sua natureza intuitiva ajuda voc√™ a entender verdades sutis.",
        "Sua alegria mant√©m seu esp√≠rito jovem e vibrante.",
        "Sua mente anal√≠tica encontra solu√ß√µes que outros perdem.",
        "Sua considera√ß√£o cria conex√µes significativas.",
        "Sua sensibilidade permite que voc√™ perceba o que os outros precisam.",
        "Sua decis√£o avan√ßa projetos eficientemente.",
        "Sua consist√™ncia constr√≥i confian√ßa ao longo do tempo.",
        "Sua expressividade comunica sua verdade magnificamente.",
        "Sua engenhosidade transforma limita√ß√µes em oportunidades.",
        "Sua dilig√™ncia garante qualidade em tudo o que voc√™ faz.",
        "Sua flexibilidade se adapta a circunst√¢ncias em mudan√ßa com gra√ßa.",
        "Seu pragmatismo ancora suas a√ß√µes na realidade.",
        "Sua eloqu√™ncia articula ideias complexas claramente.",
        "Sua previs√£o ajuda voc√™ a se preparar para desafios futuros.",
        "Sua suavidade cura feridas sem deixar cicatrizes.",
        "Sua assertividade defende o que √© certo.",
        "Sua independ√™ncia promove autonomia e for√ßa.",
        "Sua consci√™ncia presta aten√ß√£o a detalhes importantes.",
        "Sua agilidade mental ajuda voc√™ a se adaptar rapidamente a novas situa√ß√µes.",
        "Sua autoconsci√™ncia ilumina seu caminho para o crescimento.",
        "Sua for√ßa interior brilha mais intensamente durante tempos dif√≠ceis.",
        "Sua personalidade magn√©tica atrai pessoas para sua √≥rbita.",
        "Sua intelig√™ncia emocional ajuda voc√™ a navegar por relacionamentos complexos.",
        "Sua rapidez mental encontra solu√ß√µes quando outros s√≥ veem problemas.",
        "Sua confian√ßa tranquila fala volumes sem dizer uma palavra.",
        "Sua lideran√ßa natural inspira outros a seguirem seus melhores instintos.",
        "Sua √©tica inabal√°vel guia suas decis√µes mesmo quando ningu√©m est√° olhando.",
        "Sua sensibilidade art√≠stica encontra beleza em lugares inesperados.",
        "Sua mente estrat√©gica antecipa desenvolvimentos futuros com not√°vel precis√£o.",
        "Sua espontaneidade traz energia fresca para situa√ß√µes estagnadas.",
        "Sua aten√ß√£o meticulosa aos detalhes previne complica√ß√µes futuras.",
        "Sua presen√ßa pac√≠fica acalma at√© os ambientes mais ca√≥ticos.",
        "Seu pensamento inovador quebra limita√ß√µes convencionais.",
        "Sua diplomacia natural resolve conflitos com gra√ßa e equidade.",
        "Sua confiabilidade faz de voc√™ um confidente para aqueles que precisam.",
        "Seu entusiasmo contagiante eleva todos ao seu redor.",
        "Sua mente aberta acolhe novas perspectivas e possibilidades."
      ];
      
      const lifeEncouragements = [
        "Continue compartilhando seus dons com o mundo.",
        "Confie em seus instintos - eles raramente o levam na dire√ß√£o errada.",
        "Seus talentos naturais s√£o feitos para serem compartilhados.",
        "O caminho √† frente pode ter desafios, mas voc√™ est√° pronto para enfrent√°-los.",
        "Pequenos passos hoje levam a grandes realiza√ß√µes amanh√£.",
        "N√£o se esque√ßa de celebrar seu progresso ao longo do caminho.",
        "Sua jornada √∫nica vale cada passo.",
        "Lembre-se de desfrutar do processo, n√£o apenas dos resultados.",
        "Seus melhores dias ainda est√£o √† frente.",
        "Seus esfor√ßos de hoje constroem seu amanh√£.",
        "Permane√ßa fiel a si mesmo em todas as situa√ß√µes.",
        "Abrace a mudan√ßa como uma oportunidade de crescer.",
        "Ou√ßa sua sabedoria interior com mais frequ√™ncia.",
        "Permita-se descansar quando necess√°rio.",
        "Mantenha seu foco no que realmente importa.",
        "Sua presen√ßa √© um presente para aqueles ao seu redor.",
        "Alimente suas paix√µes constantemente.",
        "Seja gentil consigo mesmo durante os desafios.",
        "Seu caminho √∫nico √© exatamente o que voc√™ precisa.",
        "Confie no tempo do desenrolar da sua vida.",
        "Encontre alegria nos pequenos momentos todos os dias.",
        "Sua perspectiva √© valiosa - compartilhe-a.",
        "Acredite em sua capacidade de criar mudan√ßas.",
        "Lembre-se do motivo pelo qual voc√™ come√ßou esta jornada.",
        "Cada dia oferece um novo come√ßo.",
        "Sua resili√™ncia √© inspiradora para os outros.",
        "Reserve tempo para celebrar pequenas vit√≥rias.",
        "Cada desafio que voc√™ enfrenta o fortalece.",
        "O universo apoia seu caminho aut√™ntico.",
        "Sua luz brilha mais intensamente quando voc√™ √© voc√™ mesmo.",
        "O mundo precisa da sua contribui√ß√£o √∫nica.",
        "Deixe seu trabalho falar por si mesmo.",
        "Seu esfor√ßo constante se multiplica com o tempo.",
        "O que parece imposs√≠vel hoje ser√° sua realidade amanh√£.",
        "A for√ßa dentro de voc√™ √© maior que os desafios √† sua frente.",
        "Sua jornada inspira outros mais do que voc√™ percebe.",
        "Obst√°culos s√£o redirecionamentos para um caminho melhor.",
        "A profundidade do seu car√°ter se mostra em momentos dif√≠ceis.",
        "Seu crescimento acontece fora da sua zona de conforto.",
        "Mesmo um pequeno progresso ainda √© progresso e merece ser celebrado.",
        "Mantenha o foco no seu 'porqu√™' durante tempos dif√≠ceis.",
        "Suas escolhas di√°rias criam seu legado.",
        "As li√ß√µes que voc√™ aprende agora o servir√£o para sempre.",
        "Nunca subestime o impacto da sua gentileza.",
        "Sua voz aut√™ntica ressoa com aqueles que precisam ouvi-la.",
        "Os desafios que voc√™ supera hoje constroem sua for√ßa para amanh√£.",
        "Seu passado n√£o define seu potencial futuro.",
        "Cada passo √† frente, por menor que seja, ainda √© movimento para frente.",
        "Sua abordagem √∫nica √© sua vantagem competitiva.",
        "Confie que voc√™ est√° exatamente onde precisa estar neste momento.",
        "Suas maiores realiza√ß√µes frequentemente v√™m ap√≥s seus maiores desafios.",
        "Sua hist√≥ria ainda est√° sendo escrita - torne-a not√°vel.",
        "O universo conspira a favor dos seus sonhos aut√™nticos.",
        "Seu recurso mais poderoso √© sua cren√ßa inabal√°vel em si mesmo.",
        "O impacto que voc√™ tem nos outros √© maior do que voc√™ sabe.",
        "Suas limita√ß√µes atuais s√£o tempor√°rias, mas seu potencial √© permanente.",
        "A aprova√ß√£o mais importante vem de dentro de voc√™ mesmo.",
        "Sua intui√ß√£o √© sua b√∫ssola interna - confie em sua dire√ß√£o.",
        "A disciplina de hoje cria a liberdade de amanh√£.",
        "Cada experi√™ncia, boa ou dif√≠cil, adiciona profundidade ao seu car√°ter.",
        "O prop√≥sito da sua vida se revela atrav√©s da alegria e da dificuldade.",
        "A maneira como voc√™ lida com a adversidade revela sua verdadeira for√ßa.",
        "Sua singularidade √© sua maior vantagem competitiva.",
        "Permita-se evoluir √† medida que seus sonhos evoluem.",
        "Seu compromisso com o crescimento j√° est√° mudando seu futuro.",
        "Nunca subestime at√© onde a consist√™ncia pode lev√°-lo.",
        "Sua determina√ß√£o supera qualquer rev√©s tempor√°rio.",
        "O caminho certo nem sempre √© o mais f√°cil, mas sempre vale a pena seguir.",
        "Sua coragem de come√ßar inspira outros a fazerem o mesmo.",
        "Cada vez que voc√™ escolhe o crescimento em vez do conforto, voc√™ expande seu potencial.",
        "Seu maior potencial o aguarda logo al√©m da sua zona de conforto.",
        "Cada desafio que voc√™ enfrenta o prepara para algo maior."
      ];
      
      const professionMotivations = {
        "M√∫sico": [
          "Seu talento musical traz harmonia a um mundo ca√≥tico.",
          "Cada nota que voc√™ toca ressoa com a alma de algu√©m.",
          "Suas melodias t√™m o poder de curar e transformar.",
          "Sua express√£o art√≠stica expressa verdades universais.",
          "A m√∫sica em voc√™ merece ser ouvida."
        ],
        "Rapper": [
          "Suas palavras pintam hist√≥rias poderosas que precisam ser contadas.",
          "Seu flow e ritmo capturam emo√ß√µes que palavras sozinhas n√£o podem expressar.",
          "Seus versos d√£o voz a experi√™ncias que muitos sentem mas n√£o conseguem articular.",
          "Sua voz aut√™ntica ressoa com buscadores da verdade.",
          "Sua proeza l√≠rica abre mentes e cora√ß√µes."
        ],
        "Jogador de Futebol": [
          "Sua dedica√ß√£o em campo inspira trabalho em equipe fora do campo.",
          "Sua disciplina atl√©tica se traduz em todas as √°reas da vida.",
          "Seu pensamento estrat√©gico em campo mostra sua lideran√ßa natural.",
          "Sua paix√£o pelo jogo bonito eleva aqueles ao seu redor.",
          "Seu esp√≠rito esportivo estabelece o padr√£o para os outros."
        ],
        "Jogador de Basquete": [
          "Sua vis√£o de jogo se traduz na capacidade de ver oportunidades na vida.",
          "Sua capacidade de se apresentar sob press√£o serve voc√™ em cada desafio.",
          "Sua mentalidade de equipe cria sucesso em todos os seus relacionamentos.",
          "Seu salto vertical √© igualado por sua ambi√ß√£o de alcan√ßar novos patamares.",
          "Sua tenacidade na defesa mostra seu compromisso com a excel√™ncia."
        ],
        "Boxeador": [
          "Sua for√ßa mental √© t√£o impressionante quanto sua for√ßa f√≠sica.",
          "Sua disciplina no treinamento reflete seu car√°ter na vida.",
          "Sua capacidade de aguentar golpes e continuar avan√ßando √© seu superpoder.",
          "Seu jogo de p√©s no ringue reflete sua capacidade de navegar pelos desafios da vida.",
          "Seu esp√≠rito combativo nunca recua de desafios que valem a pena."
        ],
        "Estudante": [
          "Sua curiosidade abre portas para possibilidades infinitas.",
          "Seu compromisso com o aprendizado servir√° voc√™ por toda a vida.",
          "Sua perspectiva fresca traz novas ideias para problemas antigos.",
          "Sua jornada educacional prepara voc√™ para oportunidades ainda invis√≠veis.",
          "Sua disciplina acad√™mica constr√≥i h√°bitos para o sucesso ao longo da vida."
        ],
        "Professor": [
          "Sua influ√™ncia se estende muito al√©m da sala de aula.",
          "Sua paci√™ncia nutre um potencial que outros podem perder.",
          "Sua orienta√ß√£o molda futuros de uma maneira que voc√™ talvez nunca veja completamente.",
          "Sua sabedoria planta sementes que florescer√£o por gera√ß√µes.",
          "Sua dedica√ß√£o ao conhecimento cria ondas de mudan√ßa positiva."
        ],
        "TikToker": [
          "Seu conte√∫do criativo traz alegria e conex√£o em um mundo digital.",
          "Sua voz aut√™ntica alcan√ßa aqueles que precisam da sua mensagem.",
          "Sua capacidade de comunicar de forma concisa √© uma habilidade rara e valiosa.",
          "Sua influ√™ncia cultural pode ser direcionada para mudan√ßas positivas.",
          "Sua presen√ßa digital tem impacto no mundo real."
        ],
        "Empreendedor": [
          "Sua vis√£o cria oportunidades onde outros veem obst√°culos.",
          "Sua capacidade de assumir riscos calculados o distingue.",
          "Seu pensamento inovador resolve problemas em sua raiz.",
          "Sua lideran√ßa inspira outros a se juntarem √† sua miss√£o.",
          "Sua persist√™ncia atrav√©s dos desafios define seu sucesso."
        ],
        "M√©dico": [
          "Suas m√£os curadoras trazem conforto em momentos de ang√∫stia.",
          "Seu compromisso com a sa√∫de muda vidas todos os dias.",
          "Seu conhecimento m√©dico combinado com empatia cria verdadeira cura.",
          "Sua dedica√ß√£o ao cuidado dos pacientes exemplifica a mais alta voca√ß√£o.",
          "Suas habilidades de diagn√≥stico s√£o igualadas por seu cora√ß√£o compassivo."
        ],
        "Engenheiro": [
          "Suas habilidades de resolu√ß√£o de problemas criam solu√ß√µes que melhoram vidas.",
          "Sua experi√™ncia t√©cnica constr√≥i funda√ß√µes para o futuro.",
          "Sua mente anal√≠tica v√™ padr√µes que outros perdem.",
          "Sua precis√£o e aten√ß√£o aos detalhes garantem qualidade em tudo o que voc√™ cria.",
          "Suas abordagens inovadoras aos desafios fazem avan√ßar todo o seu campo."
        ],
        "Desenvolvedor": [
          "Seu c√≥digo cria possibilidades que n√£o existiam antes.",
          "Suas solu√ß√µes t√©cnicas resolvem problemas humanos reais.",
          "Seu pensamento l√≥gico se combina lindamente com inova√ß√£o criativa.",
          "Suas cria√ß√µes digitais impactam in√∫meras vidas diariamente.",
          "Sua capacidade de aprender novas tecnologias mant√©m voc√™ na vanguarda."
        ],
        "Artista": [
          "Sua vis√£o criativa mostra aos outros novas maneiras de ver o mundo.",
          "Sua express√£o art√≠stica toca emo√ß√µes que palavras n√£o podem alcan√ßar.",
          "Sua perspectiva √∫nica adiciona beleza √†s experi√™ncias cotidianas.",
          "Seu trabalho provoca conversas importantes al√©m das fronteiras.",
          "Sua coragem criativa inspira outros a expressarem sua verdade."
        ],
        "Enfermeiro": [
          "Seus cuidados compassivos curam mais do que males f√≠sicos.",
          "Sua aten√ß√£o percebe o que outros poderiam perder.",
          "Sua presen√ßa calma traz conforto em momentos dif√≠ceis.",
          "Sua dedica√ß√£o ao cuidado dos pacientes faz diferen√ßa em cada turno.",
          "Seu equil√≠brio entre habilidade t√©cnica e calor humano √© inestim√°vel."
        ],
        "Escritor": [
          "Suas palavras criam mundos na mente de seus leitores.",
          "Sua narrativa conecta pessoas atrav√©s de diferentes experi√™ncias.",
          "Sua eloqu√™ncia d√° voz ao que outros lutam para expressar.",
          "Suas ideias escritas oferecem novas perspectivas sobre desafios familiares.",
          "Sua arte liter√°ria preserva verdades importantes para gera√ß√µes futuras."
        ],
        "Advogado": [
          "Sua defesa traz justi√ßa para aqueles que precisam de uma voz.",
          "Sua mente anal√≠tica navega por desafios jur√≠dicos complexos com precis√£o.",
          "Seu compromisso com princ√≠pios legais fortalece os fundamentos da sociedade.",
          "Sua capacidade de construir argumentos convincentes muda resultados.",
          "Sua abordagem √©tica da pr√°tica jur√≠dica estabelece o padr√£o para outros."
        ],
        "Chef de cozinha": [
          "Suas cria√ß√µes culin√°rias trazem alegria atrav√©s de todos os sentidos.",
          "Sua culin√°ria conecta pessoas atrav√©s de mesas e culturas.",
          "Suas combina√ß√µes de sabores demonstram sua intui√ß√£o art√≠stica.",
          "Sua dedica√ß√£o a ingredientes de qualidade honra tanto a tradi√ß√£o quanto a inova√ß√£o.",
          "Sua lideran√ßa na cozinha traz o melhor de toda a sua equipe."
        ],
        "Contador": [
          "Sua experi√™ncia financeira proporciona seguran√ßa e tranquilidade.",
          "Sua aten√ß√£o aos detalhes captura o que outros poderiam perder.",
          "Suas habilidades anal√≠ticas trazem clareza a situa√ß√µes financeiras complexas.",
          "Sua integridade garante confian√ßa em todos os seus relacionamentos profissionais.",
          "Suas habilidades organizacionais criam ordem a partir da complexidade financeira."
        ],
        "Designer": [
          "Suas solu√ß√µes visuais combinam beleza e fun√ß√£o pr√°tica.",
          "Seu pensamento de design transforma experi√™ncias do usu√°rio para melhor.",
          "Sua sensibilidade est√©tica eleva objetos e intera√ß√µes cotidianos.",
          "Seu processo criativo equilibra inova√ß√£o e usabilidade.",
          "Sua linguagem de design comunica atrav√©s de barreiras e fronteiras."
        ],
        "Policial": [
          "Seu compromisso com a seguran√ßa p√∫blica torna as comunidades mais fortes.",
          "Sua coragem em situa√ß√µes dif√≠ceis protege aqueles que mais precisam.",
          "Sua tomada de decis√£o r√°pida sob press√£o demonstra not√°vel frieza.",
          "Sua dedica√ß√£o √† justi√ßa guia sua conduta profissional.",
          "Sua presen√ßa traz seguran√ßa em situa√ß√µes tensas."
        ],
        "Bombeiro": [
          "Sua bravura em situa√ß√µes perigosas salva vidas e propriedades.",
          "Seu pensamento r√°pido sob press√£o extrema √© extraordin√°rio.",
          "Sua prepara√ß√£o f√≠sica e mental permite sua resposta heroica.",
          "Seu trabalho em equipe em crises exemplifica o melhor da coopera√ß√£o humana.",
          "Seu compromisso com a seguran√ßa da comunidade se estende al√©m da resposta a emerg√™ncias."
        ],
        "Militar": [
          "Seu servi√ßo demonstra a mais alta forma de compromisso com os outros.",
          "Sua disciplina em condi√ß√µes dif√≠ceis o distingue.",
          "Seu pensamento estrat√©gico equilibra objetivos de miss√£o com seguran√ßa da equipe.",
          "Sua adaptabilidade a situa√ß√µes em mudan√ßa garante o sucesso da miss√£o.",
          "Sua lealdade √† sua unidade cria la√ßos que transcendem a amizade comum."
        ],
        "Jornalista": [
          "Sua busca pela verdade traz clareza em tempos confusos.",
          "Sua narrativa ajuda outros a entenderem quest√µes complexas.",
          "Suas habilidades investigativas descobrem o que precisa ser visto.",
          "Seu compromisso com os fatos equilibra o ecossistema de informa√ß√µes.",
          "Sua voz adiciona uma perspectiva importante ao discurso p√∫blico."
        ],
        "Psic√≥logo": [
          "Sua escuta emp√°tica cria espa√ßo para a cura.",
          "Seus insights ajudam outros a navegarem por suas paisagens interiores.",
          "Sua abordagem terap√™utica equilibra compaix√£o e pr√°tica baseada em evid√™ncias.",
          "Sua paci√™ncia permite que outros descubram suas pr√≥prias solu√ß√µes.",
          "Seus limites profissionais permitem relacionamentos de cura duradouros."
        ],
        "Professor": [
          "Sua orienta√ß√£o molda futuros al√©m do que voc√™ jamais poder√° ver.",
          "Sua paci√™ncia com o processo de aprendizagem permite que o crescimento se desenvolva naturalmente.",
          "Sua capacidade de explicar conceitos complexos torna o conhecimento acess√≠vel.",
          "Seu gerenciamento de sala de aula cria espa√ßos seguros para explora√ß√£o intelectual.",
          "Seu reconhecimento de diferentes estilos de aprendizagem alcan√ßa cada aluno."
        ],
        "Programador": [
          "Suas habilidades de codifica√ß√£o transformam ideias abstratas em realidade funcional.",
          "Sua abordagem de resolu√ß√£o de problemas decomp√µe desafios complexos em partes gerenci√°veis.",
          "Sua aten√ß√£o aos detalhes previne complica√ß√µes futuras em seu c√≥digo.",
          "Seu aprendizado cont√≠nuo mant√©m suas habilidades relevantes em um campo em mudan√ßa.",
          "Sua criatividade t√©cnica encontra solu√ß√µes elegantes para problemas dif√≠ceis."
        ]
      };
      
      const monthTraits = [
        "Seu nascimento em janeiro lhe confere qualidades de lideran√ßa natural e foco determinado.",
        "Seu nascimento em fevereiro o aben√ßoa com compreens√£o intuitiva e vis√£o humanit√°ria.",
        "Seu nascimento em mar√ßo lhe proporciona criatividade imaginativa e resili√™ncia adapt√°vel.",
        "Seu nascimento em abril o dota de persist√™ncia determinada e iniciativa corajosa.",
        "Seu nascimento em maio lhe concede habilidades de comunica√ß√£o persuasivas e sensibilidade pr√°tica.",
        "Seu nascimento em junho lhe oferece versatilidade adapt√°vel e intelig√™ncia emocional.",
        "Seu nascimento em julho lhe d√° empatia compassiva e instinto protetor.",
        "Seu nascimento em agosto o aben√ßoa com carisma magn√©tico e confian√ßa generosa.",
        "Seu nascimento em setembro lhe proporciona precis√£o anal√≠tica e organiza√ß√£o met√≥dica.",
        "Seu nascimento em outubro o dota de perspectiva equilibrada e harmonia diplom√°tica.",
        "Seu nascimento em novembro lhe concede perspic√°cia penetrante e intensidade transformadora.",
        "Seu nascimento em dezembro lhe oferece otimismo vision√°rio e sabedoria filos√≥fica."
      ];
      
      let selectedTrait;
      
      if (profession && professionMotivations[profession] && Math.random() < 0.25) {
        const profMotivations = professionMotivations[profession];
        selectedTrait = profMotivations[Math.floor(Math.random() * profMotivations.length)];
      } 
      else if (dob && Math.random() < 0.2) {
        selectedTrait = monthTraits[month];
      }
      else {
        selectedTrait = lifeTraits[Math.floor(Math.random() * lifeTraits.length)];
      }
      
      const encourageIndex = Math.floor(Math.random() * lifeEncouragements.length);
      
      return selectedTrait + " " + lifeEncouragements[encourageIndex];
    }

    function generateFlowerCode() {
      const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      let code = '';
      for (let i = 0; i < 8; i++) {
        const randomIndex = Math.floor(Math.random() * characters.length);
        code += characters.charAt(randomIndex);
      }
      return code;
    }

    function getRandomSubject() {
      let availableSubjects = Object.keys(subjectDictionary).filter(subject => !seenSubjects.includes(subject));
      
      if (availableSubjects.length === 0) {
        seenSubjects = [];
        availableSubjects = Object.keys(subjectDictionary);
      }
      
      const randomIndex = Math.floor(Math.random() * availableSubjects.length);
      const selectedSubject = availableSubjects[randomIndex];
      
      seenSubjects.push(selectedSubject);
      
      return selectedSubject;
    }

    async function updateFlowerDisplay() {
      const flowerCodeElement = document.getElementById('flowerCodeDisplay');
      const motivationElement = document.getElementById('monthlyMotivation');
      
      if (!flowerCodeElement || !motivationElement) {
        console.error("Elementos necess√°rios n√£o encontrados no DOM");
        return;
      }
      
      let subject = localStorage.getItem('flowerSubject');
      if (!subject) {
        subject = getRandomSubject();
        localStorage.setItem('flowerSubject', subject);
      }
      
      let translatedSubject = subjectDictionary[subject] || subject;
      
      const formattedName = formatUserName(userFullName);
      
      if (formattedName) {
        flowerCodeElement.innerHTML = `Minha Flor - ${translatedSubject} / ${formattedName} ${userEmoji}`;
      } else {
        flowerCodeElement.textContent = "Minha Flor - " + translatedSubject;
      }
      
      if (!currentMotivation) {
        currentMotivation = generatePersonalizedMotivation(userFlowerCode, userProfession, userDateOfBirth);
      }
      
      motivationElement.textContent = currentMotivation;
      
      const captureCode = document.getElementById('captureFlowerCode');
      const captureMotivation = document.getElementById('captureFlowerMotivation');
      
      if (captureCode) {
        if (formattedName) {
          captureCode.innerHTML = `Minha Flor - ${translatedSubject} / ${formattedName} ${userEmoji}`;
        } else {
          captureCode.textContent = "Minha Flor - " + translatedSubject;
        }
      }
      
      if (captureMotivation) captureMotivation.textContent = currentMotivation;
      
      return currentMotivation;
    }

    function setCookie(name, value, days) {
      let expires = "";
      if (days) {
        const date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        expires = "; expires=" + date.toUTCString();
      }
      document.cookie = name + "=" + (value || "") + expires + "; path=/; SameSite=Lax";
    }

    function getCookie(name) {
      const nameEQ = name + "=";
      const ca = document.cookie.split(';');
      for (let i = 0; i < ca.length; i++) {
        let c = ca[i];
        while (c.charAt(0) === ' ') c = c.substring(1, c.length);
        if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
      }
      return null;
    }

    function removeCookie(name) {
      document.cookie = name + "=; Max-Age=-99999999; path=/";
    }

    function setTheme(theme) {
      document.body.classList.remove('theme-default', 'theme-red-black', 'theme-green-blue', 'theme-orange-pink', 'theme-yellow-purple');
      
      document.body.classList.add('theme-' + theme);
      
      currentTheme = theme;
      
      localStorage.setItem('preferredTheme', theme);
      setCookie('preferredTheme', theme, 365);
      
      const options = document.querySelectorAll('.style-option');
      options.forEach(option => {
        option.classList.remove('selected');
        if (option.dataset.theme === theme) {
          option.classList.add('selected');
        }
      });
      
      updateCaptureStyles(theme);
    }
    
    function updateCaptureStyles(theme) {
      const captureContainer = document.getElementById('flowerCaptureContainer');
      const captureCode = document.getElementById('captureFlowerCode');
      const captureHeader = document.getElementById('captureFlowerHeader');
      const captureWebsiteUrl = document.querySelector('.capture-website-url');
      const captureLogo = document.querySelector('.gz-logo');
      const captureMotivation = document.getElementById('captureFlowerMotivation');
      
      if (!captureContainer || !captureCode || !captureHeader || !captureWebsiteUrl || 
          !captureLogo || !captureMotivation) {
        console.error("Um ou mais elementos de captura n√£o encontrados");
        return;
      }
      
      captureContainer.style.borderColor = '';
      captureCode.style.borderColor = '';
      captureCode.style.color = '';
      captureCode.style.backgroundColor = '';
      captureHeader.style.color = '';
      captureWebsiteUrl.style.color = '';
      captureLogo.style.color = '';
      captureLogo.style.borderColor = '';
      captureMotivation.style.color = '';
      captureMotivation.style.backgroundColor = '';
      captureMotivation.style.borderColor = '';
      
      switch(theme) {
        case 'red-black':
          captureContainer.style.borderColor = '#8B0000';
          captureContainer.style.backgroundColor = 'black';
          captureCode.style.borderColor = '#FF4500';
          captureCode.style.color = '#FF4500';
          captureCode.style.backgroundColor = 'black';
          captureHeader.style.color = '#FF4500';
          captureWebsiteUrl.style.color = '#FF4500';
          captureLogo.style.color = '#FF4500';
          captureLogo.style.borderColor = '#FF4500';
          captureMotivation.style.color = '#E5E5E5';
          captureMotivation.style.backgroundColor = 'black';
          captureMotivation.style.borderColor = '#FF4500';
          break;
          
        case 'green-blue':
          captureContainer.style.borderColor = '#3EB489';
          captureContainer.style.backgroundColor = '#1A2E4D';
          captureCode.style.borderColor = '#3EB489';
          captureCode.style.color = '#3EB489';
          captureCode.style.backgroundColor = '#36454F';
          captureHeader.style.color = '#3EB489';
          captureWebsiteUrl.style.color = '#3EB489';
          captureLogo.style.color = '#3EB489';
          captureLogo.style.borderColor = '#3EB489';
          captureMotivation.style.color = '#F5F5F5';
          captureMotivation.style.backgroundColor = '#1A2E4D';
          captureMotivation.style.borderColor = '#3EB489';
          break;
          
        case 'orange-pink':
          captureContainer.style.borderColor = '#FF7F50';
          captureContainer.style.backgroundColor = '#4B0082';
          captureCode.style.borderColor = '#FF7F50';
          captureCode.style.color = '#FF7F50';
          captureCode.style.backgroundColor = '#6A0DAD';
          captureHeader.style.color = '#FF7F50';
          captureWebsiteUrl.style.color = '#FF7F50';
          captureLogo.style.color = '#FF7F50';
          captureLogo.style.borderColor = '#FF7F50';
          captureMotivation.style.color = '#FFFFFF';
          captureMotivation.style.backgroundColor = '#4B0082';
          captureMotivation.style.borderColor = '#FF7F50';
          break;
          
        case 'yellow-purple':
          captureContainer.style.borderColor = '#FFD700';
          captureContainer.style.backgroundColor = '#4B0082';
          captureCode.style.borderColor = '#FFD700';
          captureCode.style.color = '#FFD700';
          captureCode.style.backgroundColor = '#6A0DAD';
          captureHeader.style.color = '#FFD700';
          captureWebsiteUrl.style.color = '#FFD700';
          captureLogo.style.color = '#FFD700';
          captureLogo.style.borderColor = '#FFD700';
          captureMotivation.style.color = '#FFFFFF';
          captureMotivation.style.backgroundColor = '#4B0082';
          captureMotivation.style.borderColor = '#FFD700';
          break;
          
        default:
          captureContainer.style.borderColor = '#007bff';
          captureContainer.style.backgroundColor = 'white';
          captureCode.style.borderColor = '#ff69b4';
          captureCode.style.color = '#ff69b4';
          captureCode.style.backgroundColor = '#fff0f8';
          captureHeader.style.color = '#007bff';
          captureWebsiteUrl.style.color = '#007bff';
          captureLogo.style.color = '#007bff';
          captureLogo.style.borderColor = '#007bff';
          captureMotivation.style.color = '#333';
          captureMotivation.style.backgroundColor = 'white';
          captureMotivation.style.borderColor = '#ff69b4';
      }
    }

    function authenticateAnonymously() {
      return new Promise((resolve, reject) => {
        auth.signInAnonymously()
          .then((userCredential) => {
            console.log("Usu√°rio autenticado anonimamente:", userCredential.user.uid);
            userUid = userCredential.user.uid;
            isAuthenticated = true;
            resolve(userCredential.user);
          })
          .catch((error) => {
            console.error("Erro de autentica√ß√£o:", error);
            reject(error);
          });
      });
    }

    auth.onAuthStateChanged((user) => {
      if (user) {
        userUid = user.uid;
        isAuthenticated = true;
        console.log("Estado de autentica√ß√£o alterado: usu√°rio conectado", user.uid);
      } else {
        isAuthenticated = false;
        console.log("Estado de autentica√ß√£o alterado: usu√°rio desconectado");
      }
    });

    async function submitToFirebase() {
      try {
        if (!isAuthenticated) {
          console.log("Usu√°rio n√£o autenticado, autenticando...");
          await authenticateAnonymously();
        }
        
        const location = await detectUserLocation();
        
        await getUserRankAndEmoji();
        
        const userData = {
          date: new Date().toISOString(),
          country: location.country || "Desconhecido",
          city: location.city || "Desconhecido",
          uid: userUid,
          uniqueId: userUniqueId,
          flowerCode: userFlowerCode,
          motivation: currentMotivation,
          dateOfBirth: userDateOfBirth,
          profession: userProfession,
          fullName: userFullName,
          formattedName: formatUserName(userFullName),
          timestamp: Date.now(),
          theme: currentTheme,
          subject: localStorage.getItem('flowerSubject') || getRandomSubject(),
          shareCount: shareCount,
          rank: userRank,
          emoji: userEmoji
        };

        console.log("Enviando dados para o Firebase:", userData);
        
        try {
          const newEntryRef = database.ref('birthdates').push(userData);
          console.log("Dados enviados para o banco de dados em tempo real:", newEntryRef.key);
        } catch (dbError) {
          console.error("Erro com o banco de dados em tempo real:", dbError);
        }
        
        try {
          const docRef = await firestore.collection('flowers').add(userData);
          console.log("Documento escrito no Firestore com ID: ", docRef.id);
        } catch (firestoreError) {
          console.error("Erro ao adicionar documento ao Firestore: ", firestoreError);
        }
        
        try {
          await firestore.collection('flowerCodes').doc(userUniqueId).set({
            ...userData,
            createdAt: new Date()
          });
          console.log("C√≥digo de flor adicionado √† cole√ß√£o espec√≠fica");
        } catch (codeError) {
          console.error("Erro ao adicionar c√≥digo de flor √† cole√ß√£o: ", codeError);
        }
        
        localStorage.setItem('userFlowerData', JSON.stringify(userData));
        localStorage.setItem('isInstalled', 'true');
        setCookie('userUniqueId', userUniqueId, 365);
        setCookie('userFlowerCode', userFlowerCode, 365);
        setCookie('userDateOfBirth', userDateOfBirth, 365);
        setCookie('userProfession', userProfession, 365);
        setCookie('userFullName', userFullName, 365);
        setCookie('userEmoji', userEmoji, 365);
        setCookie('userRank', userRank.toString(), 365);
        setCookie('isInstalled', 'true', 365);
        isInstalled = true;
        
        return true;
      } catch (error) {
        console.error("Erro de envio para o Firebase:", error);
        await getUserRankAndEmoji();
        
        const userData = {
          date: new Date().toISOString(),
          uniqueId: userUniqueId,
          flowerCode: userFlowerCode,
          motivation: currentMotivation,
          dateOfBirth: userDateOfBirth,
          profession: userProfession,
          fullName: userFullName,
          formattedName: formatUserName(userFullName),
          timestamp: Date.now(),
          theme: currentTheme,
          subject: localStorage.getItem('flowerSubject') || getRandomSubject(),
          shareCount: 0,
          rank: userRank,
          emoji: userEmoji
        };
        
        localStorage.setItem('userFlowerData', JSON.stringify(userData));
        localStorage.setItem('isInstalled', 'true');
        setCookie('userUniqueId', userUniqueId, 365);
        setCookie('userFlowerCode', userFlowerCode, 365);
        setCookie('userDateOfBirth', userDateOfBirth, 365);
        setCookie('userProfession', userProfession, 365);
        setCookie('userFullName', userFullName, 365);
        setCookie('userEmoji', userEmoji, 365);
        setCookie('userRank', userRank.toString(), 365);
        setCookie('isInstalled', 'true', 365);
        isInstalled = true;
        
        return true;
      }
    }

    async function updateShareCount() {
      if (!isAuthenticated || !userUniqueId) return;
      
      try {
        shareCount++;
        
        const savedData = localStorage.getItem('userFlowerData');
        if (savedData) {
          const userData = JSON.parse(savedData);
          userData.shareCount = shareCount;
          localStorage.setItem('userFlowerData', JSON.stringify(userData));
        }
        
        await firestore.collection('flowerCodes').doc(userUniqueId).set({
          shareCount: shareCount,
          lastShared: new Date().toISOString(),
          country: currentCountry || "Desconhecido",
          city: userCity || "Desconhecido",
          uid: userUid,
          uniqueId: userUniqueId
        }, { merge: true });
        
        console.log("Contador de compartilhamentos atualizado:", shareCount);
      } catch (error) {
        console.error("Erro ao atualizar contador de compartilhamentos:", error);
      }
    }

    function checkSavedUserData() {
      const cookieUniqueId = getCookie('userUniqueId');
      const cookieFlowerCode = getCookie('userFlowerCode');
      const cookieInstalled = getCookie('isInstalled');
      const cookieDOB = getCookie('userDateOfBirth');
      const cookieProfession = getCookie('userProfession');
      const cookieFullName = getCookie('userFullName');
      const cookieEmoji = getCookie('userEmoji');
      const cookieRank = getCookie('userRank');
      
      if (cookieUniqueId && cookieFlowerCode) {
        userUniqueId = cookieUniqueId;
        userFlowerCode = cookieFlowerCode;
        userDateOfBirth = cookieDOB || null;
        userProfession = cookieProfession || null;
        userFullName = cookieFullName || null;
        userEmoji = cookieEmoji || "üëë";
        userRank = cookieRank ? parseInt(cookieRank) : 0;
        isInstalled = cookieInstalled === 'true';
        
        currentMotivation = generatePersonalizedMotivation(userFlowerCode, userProfession, userDateOfBirth);
        
        console.log("Dados do usu√°rio encontrados nos cookies:", { userUniqueId, userFlowerCode, userDateOfBirth, userProfession, userFullName, userEmoji, userRank });
        return true;
      }
      
      const savedData = localStorage.getItem('userFlowerData');
      if (savedData) {
        try {
          const userData = JSON.parse(savedData);
          userUniqueId = userData.uniqueId;
          userFlowerCode = userData.flowerCode;
          userDateOfBirth = userData.dateOfBirth || null;
          userProfession = userData.profession || null;
          userFullName = userData.fullName || null;
          shareCount = userData.shareCount || 0;
          userEmoji = userData.emoji || "üëë";
          userRank = userData.rank || 0;
          currentMotivation = userData.motivation || generatePersonalizedMotivation(userData.flowerCode, userData.profession, userData.dateOfBirth);
          userUid = userData.uid;
          isInstalled = localStorage.getItem('isInstalled') === 'true';
          
          setCookie('userUniqueId', userUniqueId, 365);
          setCookie('userFlowerCode', userFlowerCode, 365);
          setCookie('userDateOfBirth', userDateOfBirth, 365);
          setCookie('userProfession', userProfession, 365);
          setCookie('userFullName', userFullName, 365);
          setCookie('userEmoji', userEmoji, 365);
          setCookie('userRank', userRank.toString(), 365);
          setCookie('isInstalled', 'true', 365);
          
          console.log("Dados do usu√°rio encontrados no localStorage:", userData);
          return true;
        } catch (e) {
          console.error("Erro ao analisar dados do usu√°rio salvos:", e);
          return false;
        }
      }
      return false;
    }

    async function deleteUserAccount() {
      if (!userUniqueId) return false;
      
      try {
        if (!confirm("Tem certeza de que deseja excluir TODOS os seus dados? Esta a√ß√£o √© irrevers√≠vel.")) {
          return false;
        }
        
        console.log("Excluindo conta de usu√°rio:", userUniqueId);
        
        try {
          await firestore.collection('flowerCodes').doc(userUniqueId).delete();
          console.log("Dados exclu√≠dos da cole√ß√£o flowerCodes");
        } catch (error) {
          console.error("Erro ao excluir de flowerCodes:", error);
        }
        
        try {
          const flowersQuery = await firestore.collection('flowers').where('uniqueId', '==', userUniqueId).get();
          
          const batch = firestore.batch();
          let count = 0;
          
          flowersQuery.forEach((doc) => {
            batch.delete(doc.ref);
            count++;
          });
          
          if (count > 0) {
            await batch.commit();
            console.log(`${count} documentos exclu√≠dos da cole√ß√£o flowers`);
          }
        } catch (error) {
          console.error("Erro ao excluir de flowers:", error);
        }
        
        try {
          const birthdatesRef = database.ref('birthdates');
          const query = birthdatesRef.orderByChild('uniqueId').equalTo(userUniqueId);
          
          query.once('value', (snapshot) => {
            snapshot.forEach((childSnapshot) => {
              birthdatesRef.child(childSnapshot.key).remove();
            });
          });
          
          console.log("Dados exclu√≠dos do banco de dados em tempo real");
        } catch (error) {
          console.error("Erro ao excluir do banco de dados em tempo real:", error);
        }
        
        localStorage.removeItem('userFlowerData');
        localStorage.removeItem('isInstalled');
        localStorage.removeItem('flowerSubject');
        localStorage.removeItem('preferredTheme');
        
        removeCookie('userUniqueId');
        removeCookie('userFlowerCode');
        removeCookie('isInstalled');
        removeCookie('userDateOfBirth');
        removeCookie('userProfession');
        removeCookie('userFullName');
        removeCookie('userEmoji');
        removeCookie('userRank');
        removeCookie('preferredTheme');
        
        userUniqueId = null;
        userFlowerCode = null;
        currentMotivation = null;
        userDateOfBirth = null;
        userProfession = null;
        userFullName = null;
        userEmoji = null;
        userRank = null;
        isInstalled = false;
        seenSubjects = [];
        shareCount = 0;
        
        try {
          if (auth.currentUser) {
            await auth.currentUser.delete();
            console.log("Usu√°rio do Firebase exclu√≠do");
          }
        } catch (authError) {
          console.error("Erro ao excluir autentica√ß√£o:", authError);
        }
        
        console.log("Conta de usu√°rio completamente exclu√≠da");
        return true;
      } catch (error) {
        console.error("Erro ao excluir conta:", error);
        return false;
      }
    }

    window.addEventListener('load', async () => {
      const today = new Date();
      const twoYearsAgo = new Date(today.getFullYear() - 5, today.getMonth(), today.getDate());
      document.getElementById('dobInput').max = twoYearsAgo.toISOString().split('T')[0];
      
      const savedTheme = localStorage.getItem('preferredTheme') || getCookie('preferredTheme');
      if (savedTheme) {
        setTheme(savedTheme);
      } else {
        setTheme('green-blue');
      }
      
      if (checkSavedUserData()) {
        console.log("O usu√°rio j√° tem dados, ocultando a janela de boas-vindas");
        const welcomeToast = document.getElementById('welcomeToast');
        welcomeToast.style.display = 'block';
        setTimeout(() => {
          welcomeToast.style.opacity = '1';
        }, 100);
        setTimeout(() => {
          welcomeToast.style.opacity = '0';
          setTimeout(() => {
            welcomeToast.style.display = 'none';
          }, 500);
        }, 2000);
        
        if (!isAuthenticated) {
          try {
            await authenticateAnonymously();
          } catch (error) {
            console.error("Erro ao autenticar:", error);
          }
        }
      } else {
        console.log("Nenhum dado de usu√°rio salvo encontrado, exibindo a janela de boas-vindas");
        const welcomeModal = document.getElementById('welcomeModal');
        welcomeModal.style.display = 'block';
        setTimeout(() => {
          welcomeModal.classList.add('show');
        }, 100);
      }
      
      setupProfessionDropdown();
    });

    function setupProfessionDropdown() {
      const professionInput = document.getElementById('professionInput');
      const professionDropdown = document.getElementById('professionDropdown');
      
      if (!professionInput || !professionDropdown) {
        console.error("Elementos do menu suspenso de profiss√µes n√£o encontrados");
        return;
      }
      
      function filterProfessions(input) {
        if (!input) return [];
        
        input = input.toLowerCase();
        return professions.filter(profession => 
          profession.toLowerCase().includes(input)
        );
      }
      
      function renderDropdownOptions(filteredProfessions) {
        professionDropdown.innerHTML = '';
        
        if (filteredProfessions.length === 0) {
          const option = document.createElement('div');
          option.className = 'profession-option';
          option.textContent = 'Nenhuma correspond√™ncia encontrada';
          professionDropdown.appendChild(option);
        } else {
          filteredProfessions.forEach(profession => {
            const option = document.createElement('div');
            option.className = 'profession-option';
            option.textContent = profession;
            option.addEventListener('click', () => {
              professionInput.value = profession;
              professionDropdown.style.display = 'none';
            });
            professionDropdown.appendChild(option);
          });
        }
      }
      
      professionInput.addEventListener('input', () => {
        const filtered = filterProfessions(professionInput.value);
        renderDropdownOptions(filtered);
        
        if (filtered.length > 0) {
          professionDropdown.style.display = 'block';
        } else {
          professionDropdown.style.display = 'none';
        }
      });
      
      professionInput.addEventListener('focus', () => {
        if (professionInput.value) {
          const filtered = filterProfessions(professionInput.value);
          renderDropdownOptions(filtered);
          professionDropdown.style.display = 'block';
        }
      });
      
      document.addEventListener('click', (e) => {
        if (!professionInput.contains(e.target) && !professionDropdown.contains(e.target)) {
          professionDropdown.style.display = 'none';
        }
      });
    }

    document.getElementById('flowerButton').addEventListener('click', function() {
      if (!userUniqueId) {
        alert("Por favor, crie sua conta de flor primeiro.");
        return;
      }
      
      updateFlowerDisplay();
      const flowerModal = document.getElementById('flowerModal');
      flowerModal.style.display = 'block';
      setTimeout(() => {
        flowerModal.classList.add('show');
      }, 10);
      document.getElementById('shareFlowerButton').style.display = 'flex';
    });

    document.getElementById('shareFlowerButton').addEventListener('click', function() {
      captureFlower();
    });
    
    document.getElementById('showIdButton').addEventListener('click', function() {
      if (userUniqueId) {
        document.getElementById('userIdDisplay').textContent = userUniqueId;
        const idModal = document.getElementById('idModal');
        idModal.style.display = 'block';
        setTimeout(() => {
          idModal.classList.add('show');
        }, 10);
      } else {
        alert("Por favor, crie sua conta de flor primeiro para obter seu ID √∫nico.");
      }
    });
    
    document.getElementById('copyIdButton').addEventListener('click', function() {
      const idText = document.getElementById('userIdDisplay').textContent;
      navigator.clipboard.writeText(idText).then(function() {
        alert('ID copiado para a √°rea de transfer√™ncia!');
      }).catch(function() {
        alert('N√£o foi poss√≠vel copiar o ID. Por favor, selecione e copie manualmente.');
      });
    });
    
    document.getElementById('closeIdModal').addEventListener('click', function() {
      const idModal = document.getElementById('idModal');
      idModal.classList.remove('show');
      setTimeout(() => {
        idModal.style.display = 'none';
      }, 300);
    });
    
    document.getElementById('deleteAccountButton').addEventListener('click', function() {

      deleteUserAccount().then(success => {
        if (success) {
          alert("Conta exclu√≠da com sucesso. Voc√™ precisar√° criar uma nova conta para usar este aplicativo.");
          const idModal = document.getElementById('idModal');
          idModal.classList.remove('show');
          setTimeout(() => {
            idModal.style.display = 'none';
            const welcomeModal = document.getElementById('welcomeModal');
            welcomeModal.style.display = 'block';
            setTimeout(() => {
              welcomeModal.classList.add('show');
            }, 100);
          }, 300);
        } else {
          alert("Erro, tente mais tarde");
        }
      });
    });
    
    document.getElementById('refreshMotivation').addEventListener('click', function() {
      const newMotivation = generatePersonalizedMotivation(userFlowerCode, userProfession, userDateOfBirth);
      currentMotivation = newMotivation;
      
      const newSubject = getRandomSubject();
      localStorage.setItem('flowerSubject', newSubject);
      
      const formattedName = formatUserName(userFullName);
      
      const flowerCodeElement = document.getElementById('flowerCodeDisplay');
      if (formattedName) {
        flowerCodeElement.innerHTML = `Minha Flor - ${newSubject} / ${formattedName} ${userEmoji}`;
      } else {
        flowerCodeElement.textContent = "Minha Flor - " + newSubject;
      }
      
      document.getElementById('monthlyMotivation').textContent = newMotivation;
      
      const captureCode = document.getElementById('captureFlowerCode');
      const captureMotivation = document.getElementById('captureFlowerMotivation');
      
      if (captureCode) {
        if (formattedName) {
          captureCode.innerHTML = `My Flower - ${newSubject} / ${formattedName} ${userEmoji}`;
        } else {
          captureCode.textContent = "My Flower - " + newSubject;
        }
      }
      
      if (captureMotivation) captureMotivation.textContent = newMotivation;
      
      this.style.transition = 'transform 0.5s ease';
      this.style.transform = 'rotate(360deg)';
      
      setTimeout(() => {
        this.style.transition = 'none';
        this.style.transform = 'rotate(0deg)';
      }, 500);
    });
    
    document.getElementById('createAccountButton').addEventListener('click', async function() {
      const dobInput = document.getElementById('dobInput');
      const professionInput = document.getElementById('professionInput');
      const fullNameInput = document.getElementById('fullNameInput');
      
      if (!fullNameInput.value) {
        alert("Please enter your full name.");
        return;
      }
      
      if (!dobInput.value) {
        alert("Please enter your date of birth.");
        return;
      }
      
      if (!professionInput.value) {
        alert("Please enter your profession.");
        return;
      }
      
      document.getElementById('loadingSpinner').style.display = 'block';
      document.getElementById('createAccountButton').disabled = true;
      
      try {
        await authenticateAnonymously();
        
        userFullName = fullNameInput.value;
        userDateOfBirth = dobInput.value;
        userProfession = professionInput.value;
        
        userUniqueId = generateUniqueId();
        console.log("Generated unique ID:", userUniqueId);
        
        userFlowerCode = generateFlowerCode();
        
        userEmoji = await getUserRankAndEmoji();
        
        const subject = getRandomSubject();
        localStorage.setItem('flowerSubject', subject);
        
        currentMotivation = generatePersonalizedMotivation(userFlowerCode, userProfession, userDateOfBirth);
        
        const createButton = document.getElementById('createAccountButton');
        createButton.innerHTML = '<i class="fas fa-check"></i> Done';
        createButton.style.backgroundColor = '#4CAF50';
        
        const userData = {
          date: new Date().toISOString(),
          uid: userUid,
          uniqueId: userUniqueId,
          flowerCode: userFlowerCode,
          motivation: currentMotivation,
          dateOfBirth: userDateOfBirth,
          profession: userProfession,
          fullName: userFullName,
          formattedName: formatUserName(userFullName),
          timestamp: Date.now(),
          theme: currentTheme,
          subject: subject,
          shareCount: 0,
          rank: userRank,
          emoji: userEmoji
        };
        
        localStorage.setItem('userFlowerData', JSON.stringify(userData));
        localStorage.setItem('isInstalled', 'true');
        setCookie('userUniqueId', userUniqueId, 365);
        setCookie('userFlowerCode', userFlowerCode, 365);
        setCookie('userDateOfBirth', userDateOfBirth, 365);
        setCookie('userProfession', userProfession, 365);
        setCookie('userFullName', userFullName, 365);
        setCookie('userEmoji', userEmoji, 365);
        setCookie('userRank', userRank.toString(), 365);
        setCookie('isInstalled', 'true', 365);
        isInstalled = true;
        
        setTimeout(() => {
          const welcomeModal = document.getElementById('welcomeModal');
          welcomeModal.classList.remove('show');
          
          setTimeout(() => {
            welcomeModal.style.display = 'none';
            document.getElementById('loadingSpinner').style.display = 'none';
            createButton.innerHTML = 'Create Account';
            createButton.style.backgroundColor = '';
            createButton.disabled = false;
            
            submitToFirebase().then(submitted => {
              console.log("Firebase submission result:", submitted);
              
              const welcomeToast = document.getElementById('welcomeToast');
              welcomeToast.style.display = 'block';
              setTimeout(() => {
                welcomeToast.style.opacity = '1';
              }, 100);
              setTimeout(() => {
                welcomeToast.style.opacity = '0';
                setTimeout(() => {
                  welcomeToast.style.display = 'none';
                }, 500);
              }, 2000);
              
              updateFlowerDisplay();
              const flowerModal = document.getElementById('flowerModal');
              flowerModal.style.display = 'block';
              setTimeout(() => {
                flowerModal.classList.add('show');
              }, 10);
              document.getElementById('shareFlowerButton').style.display = 'flex';
            });
          }, 300);
        }, 2000);
        
        console.log("Setup complete and data stored locally and in cookies");
      } catch (error) {
        console.error("Error during setup:", error);
        document.getElementById('loadingSpinner').style.display = 'none';
        document.getElementById('createAccountButton').disabled = false;
        alert("There was a problem setting up your flower. Please try again.");
      }
    });
    
    async function captureFlower() {
      try {
        const captureContainer = document.getElementById('flowerCaptureContainer');
        
        updateCaptureStyles(currentTheme);
        
        if (typeof html2canvas !== 'function') {
          console.error("html2canvas not loaded or not available as a function");
          alert("Cannot capture flower. The capture library is not loaded.");
          return;
        }
        
        let bgColor = 'white';
        if (currentTheme === 'red-black') bgColor = 'black';
        else if (currentTheme === 'green-blue') bgColor = '#1A2E4D';
        else if (currentTheme === 'orange-pink' || currentTheme === 'yellow-purple') bgColor = '#4B0082';
        
        const canvas = await html2canvas(captureContainer, {
          backgroundColor: bgColor,
          scale: 7,
          logging: true,
          useCORS: true,
          allowTaint: true,
          letterRendering: true
        });
        
        const imageUrl = canvas.toDataURL('image/png');
        
        const capturedImage = document.getElementById('capturedImage');
        if (capturedImage) {
          capturedImage.src = imageUrl;
          document.getElementById('capturedFlower').style.display = 'flex';
          document.getElementById('shareWarning').style.display = 'block';
          
          updateShareCount();
        } else {
          console.error("capturedImage element not found");
        }
      } catch (error) {
        console.error('Error capturing flower:', error);
        alert('Could not capture your flower. Please try again.');
      }
    }
    
    document.getElementById('shareCapture').addEventListener('click', function() {
      const imageUrl = document.getElementById('capturedImage').src;
      
      if (navigator.share) {
        fetch(imageUrl)
          .then(res => res.blob())
          .then(blob => {
            const file = new File([blob], 'my-gz-flower.png', { type: 'image/png' });
            navigator.share({
              title: 'My G-Z Flower',
              text: 'Discover yours at g-z.online',
              files: [file]
            }).catch(err => {
              console.log('Error sharing:', err);
              fallbackShare();
            });
          })
          .catch(err => {
            console.log('Error preparing image:', err);
            fallbackShare();
          });
      } else {
        fallbackShare();
      }
    });
    
    function fallbackShare() {
      try {
        const shareText = `
Check out my Flower of Life from G-Z: ${userUniqueId}. Discover yours at g-z.online`;
        
        navigator.clipboard.writeText(shareText).then(function() {
          alert('Share text copied to clipboard!');
        }).catch(function() {
          alert('Could not copy share text.');
        });
      } catch (error) {
        console.error('Fallback share error:', error);
        alert('An error occurred.');
      }
    }
    
    document.getElementById('closeCapture').addEventListener('click', function() {
      const imageUrl = document.getElementById('capturedImage').src;
      
      // Cr√©er un lien temporaire pour t√©l√©charger l'image
      const downloadLink = document.createElement('a');
      downloadLink.href = imageUrl;
      downloadLink.download = 'minha-flor-gz.png';
      
      // Ajouter le lien au document, cliquer dessus, puis le supprimer
      document.body.appendChild(downloadLink);
      downloadLink.click();
      document.body.removeChild(downloadLink);
      
      // Cacher la vue de capture apr√®s le t√©l√©chargement
      document.getElementById('capturedFlower').style.display = 'none';
    });
    
    document.getElementById('closeFlowerModal').addEventListener('click', function() {
      const flowerModal = document.getElementById('flowerModal');
      flowerModal.classList.remove('show');
      setTimeout(() => {
        flowerModal.style.display = 'none';
        document.getElementById('shareFlowerButton').style.display = 'none';
      }, 300);
    });

    window.onclick = function(event) {
      const flowerModal = document.getElementById('flowerModal');
      const capturedFlower = document.getElementById('capturedFlower');
      const idModal = document.getElementById('idModal');
      const welcomeModal = document.getElementById('welcomeModal');
      
      if (event.target == flowerModal) {
        flowerModal.classList.remove('show');
        setTimeout(() => {
          flowerModal.style.display = "none";
          document.getElementById('shareFlowerButton').style.display = 'none';
        }, 300);
      }
      
      if (event.target == capturedFlower) {
        capturedFlower.style.display = "none";
      }
      
      if (event.target == idModal) {
        idModal.classList.remove('show');
        setTimeout(() => {
          idModal.style.display = "none";
        }, 300);
      }
      
      if (event.target == welcomeModal && isInstalled) {
        welcomeModal.classList.remove('show');
        setTimeout(() => {
          welcomeModal.style.display = "none";
        }, 300);
      }
    };
    
    document.getElementById('shareFlowerButton').style.display = 'none';
    document.getElementById('shareWarning').style.display = 'none';
    
    document.querySelectorAll('.style-option').forEach(option => {
      option.addEventListener('click', function() {
        const theme = this.dataset.theme;
        setTheme(theme);
      });
    });
  </script>
</body>
