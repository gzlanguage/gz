
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>G-Z</title>
    <link rel="icon" href="https://firebasestorage.googleapis.com/v0/b/genz-abb36.firebasestorage.app/o/file_00000000182461f694cccea0b9e89e1f.png?alt=media&token=3fda1ca9-1d47-4b35-9b07-af86c3098c41">
    <link href="https://fonts.googleapis.com/css2?family=Billabong&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#000000">
    <link rel="apple-touch-icon" href="https://firebasestorage.googleapis.com/v0/b/genz-abb36.firebasestorage.app/o/file_00000000182461f694cccea0b9e89e1f.png?alt=media&token=3fda1ca9-1d47-4b35-9b07-af86c3098c41">
    <link rel="manifest" id="manifest-placeholder">
    <style>
        /* Style pour l'écran de chargement en noir */
        body {
            background-color: #000000;
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }
        
        .splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000000;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease-out;
        }
        
        .splash-icon {
            width: 100px;
            height: 100px;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(0.8); opacity: 0.7; }
            50% { transform: scale(1); opacity: 1; }
            100% { transform: scale(0.8); opacity: 0.7; }
        }
    </style>
</head>
<body>
    <!-- Écran de chargement -->
    <div class="splash-screen" id="splash-screen">
        <img src="https://firebasestorage.googleapis.com/v0/b/genz-abb36.firebasestorage.app/o/file_00000000182461f694cccea0b9e89e1f.png?alt=media&token=3fda1ca9-1d47-4b35-9b07-af86c3098c41" alt="Logo" class="splash-icon">
    </div>
    
    <!-- Contenu principal de la page (qui sera affiché après le chargement) -->
    <div id="main-content" style="display: none;">
        <!-- Votre contenu principal ici -->
    </div>
    
    <script>
        // Création dynamique du fichier manifest
        const manifestData = {
            "name": "Flower of life",
            "short_name": "Flower",
            "description": "G-Z Application",
            "start_url": "/",
            "display": "standalone",
            "background_color": "#000000",
            "theme_color": "#000000",
            "icons": [
                {
                    "src": "https://firebasestorage.googleapis.com/v0/b/genz-abb36.firebasestorage.app/o/file_00000000182461f694cccea0b9e89e1f.png?alt=media&token=3fda1ca9-1d47-4b35-9b07-af86c3098c41",
                    "sizes": "192x192",
                    "type": "image/png"
                },
                {
                    "src": "https://firebasestorage.googleapis.com/v0/b/genz-abb36.firebasestorage.app/o/file_00000000182461f694cccea0b9e89e1f.png?alt=media&token=3fda1ca9-1d47-4b35-9b07-af86c3098c41",
                    "sizes": "512x512",
                    "type": "image/png"
                }
            ]
        };
        
        const blob = new Blob([JSON.stringify(manifestData)], {type: 'application/json'});
        const manifestURL = URL.createObjectURL(blob);
        document.querySelector('#manifest-placeholder').setAttribute('href', manifestURL);
        
        // Simulation de chargement et affichage du contenu principal
        window.addEventListener('load', function() {
            // Simuler un temps de chargement (peut être ajusté ou remplacé par votre vrai logique)
            setTimeout(function() {
                // Masquer l'écran de chargement
                const splashScreen = document.getElementById('splash-screen');
                splashScreen.style.opacity = '0';
                
                // Afficher le contenu principal
                setTimeout(function() {
                    splashScreen.style.display = 'none';
                    document.getElementById('main-content').style.display = 'block';
                }, 500); // Attendre que l'animation de fondu soit terminée
            }, 1500); // 2 secondes de chargement simulé
        });
    </script>
</body>
</html>
    <style>
        input, textarea, select, button {
            font-size: 16px;
            touch-action: manipulation;
        }
        
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: white;
            position: relative;
            transition: background-color 0.3s ease;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            -webkit-text-size-adjust: 100%;
        }
        header {
            background-color: white;
            padding: 6px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            transition: background-color 0.3s ease;
        }
        
        h1 {
            margin: 0;
            font-size: 1.4em;
            font-family: 'Billabong', cursive;
            color: #007bff;
            border: 2px solid #007bff;
            padding: 4px;
            border-radius: 12px;
            font-weight: bold;
            transition: color 0.3s ease, border-color 0.3s ease;
        }
        .divider {
            height: 0.6px;
            background-color: #007bff;
            width: 100%;
            margin-top: 5px;
            transition: background-color 0.3s ease;
        }
        .button-container {
            display: flex;
            justify-content: center;
            margin-top: 5px;
            padding: 5px 0;
            overflow-x: auto;
            white-space: nowrap;
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        .button-container::-webkit-scrollbar {
            display: none;
        }
        .button {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 8px;
            padding: 5px 10px;
            margin: 0 3px;
            font-size: 0.8em;
            cursor: pointer;
            text-decoration: none;
            display: flex;
            align-items: center;
            flex-shrink: 0;
            transition: background-color 0.3s ease;
        }
        .button i {
            margin-right: 2px;
        }
        .notification {
            text-align: center;
            margin-top: 10px;
            font-size: 0.8em;
            color: #0056b3;
            font-weight: bold;
            transition: color 0.3s ease;
            padding: 3px 0;
            max-height: 30px;
            overflow: hidden;
        }
        .share-icon {
            color: #007bff;
            cursor: pointer;
            font-size: 1.3em;
            border: 1px solid #007bff;
            border-radius: 7px;
            padding: 4px;
            background-color: white;
            transition: color 0.3s ease, border-color 0.3s ease;
        }
        footer {
            background-color: white;
            color: black;
            padding: 10px 15px;
            margin-top: auto;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .logo-container {
            display: flex;
        }
        .logo {
            color: #007bff;
            font-size: 1.6em;
            margin-right: 10px;
            border: 1px solid #007bff;
            border-radius: 10px;
            padding: 5px;
            background-color: rgba(0, 119, 190, 0.1);
            transition: background-color 0.3s, color 0.3s, border-color 0.3s;
        }
        .logo:hover {
            background-color: #007bff;
            color: white;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.5);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .modal.show {
            opacity: 1;
        }
        .modal-content {
            background-color: white;
            margin: 50% auto;
            padding: 14px;
            border: 1px solid #007bff;
            border-radius: 60px;
            width: 280px;
            max-width: 70%;
            text-align: center;
            max-height: 60vh;
            overflow-y: auto;
            position: relative;
            transition: background-color 0.3s ease, border-color 0.3s ease, transform 0.3s ease;
            transform: scale(0.8);
        }
        .modal.show .modal-content {
            transform: scale(1);
        }
        .modal-header {
            font-size: 1.8em;
            font-family: 'Billabong', cursive;
            margin-bottom: 10px;
            font-weight: bold;
            color: #007bff;
            text-decoration: underline;
            transition: color 0.3s ease;
        }
        
        .modal-footer {
            margin-top: 15px;
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 6px;
        }
        .close-button {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 12px;
            padding: 8px 10px;
            cursor: pointer;
            font-size: 0.9em;
            width: 120px;
            margin: 4px;
            transition: background-color 0.3s ease;
        }
        .close-button:hover {
            background-color: #0056b3;
        }
        
        @keyframes flowerRotate {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(15deg); }
            50% { transform: rotate(0deg); }
            75% { transform: rotate(-15deg); }
            100% { transform: rotate(0deg); }
        }
        
        .flower-icon {
            display: inline-block;
            animation: flowerRotate 2s infinite ease-in-out;
            color: #ff69b4;
        }
        
        .billabong-title {
            font-family: 'Billabong', cursive;
            font-size: 1.8em;
            margin-bottom: 8px;
            color: #007bff;
            transition: color 0.3s ease;
        }

        .monthly-motivation {
            margin: 15px 0;
            padding: 10px;
            border: 1px dashed #ff69b4;
            border-radius: 15px;
            background-color: white;
            font-style: italic;
            color: #333;
            font-size: 0.9em;
            line-height: 1.4;
            transition: border-color 0.3s ease, color 0.3s ease, background-color 0.3s ease;
            position: relative;
        }
        
        .flower-code {
            display: block;
            font-weight: bold;
            color: #ff69b4;
            font-size: 0.9em;
            margin-bottom: 8px;
            letter-spacing: 0.5px;
            background-color: #fff0f8;
            padding: 6px;
            border-radius: 8px;
            border: 1px solid #ff69b4;
            max-width: 220px;
            margin-left: auto;
            margin-right: auto;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            transition: color 0.3s ease, background-color 0.3s ease, border-color 0.3s ease;
        }
        
        .copy-icon {
            color: #007bff;
            cursor: pointer;
            margin-left: 10px;
            font-size: 1.2em;
            vertical-align: middle;
            transition: color 0.3s ease;
        }
        
        .header-controls {
            display: flex;
            align-items: center;
        }
        
        .celebrate-icon {
            font-size: 2em;
            color: gold;
            margin-bottom: 8px;
            animation: celebrate 2s infinite alternate;
        }
        
        @keyframes celebrate {
            0% { transform: scale(1); }
            50% { transform: scale(1.1) rotate(5deg); }
            100% { transform: scale(1) rotate(-5deg); }
        }
        
        .modal-close {
            position: absolute;
            top: 10px;
            right: 20px;
            color: #ff0000;
            font-size: 13px;
            cursor: pointer;
            background-color: transparent;
            border: none;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background-color 0.2s;
        }
        
        .modal-close:hover {
            background-color: rgba(255, 0, 0, 0.1);
        }
        
        .share-flower-button {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 14px;
            padding: 8px 16px;
            font-size: 0.9em;
            margin: 290px auto;
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.3s, color 0.3s, border-color 0.3s;
            max-width: 190px;
            position: relative;
            z-index: 1001;
            border: 1px solid #0056b3;
        }
        
        .share-flower-button:hover {
            background-color: #0056b3;
        }
        
        .share-flower-button i {
            margin-left: 8px;
        }
        
        #capturedFlower {
            position: fixed;
            z-index: 1003;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: none;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .captured-image-container {
            position: relative;
            max-width: 85%;
            max-height: 60vh;
            margin-bottom: 15px;
        }
        
        .captured-image {
            max-width: 100%;
            max-height: 60vh;
            border-radius: 15px;
            border: 2px solid white;
        }
        
        .share-message {
            background-color: white;
            color: #333;
            padding: 10px 15px;
            border-radius: 15px;
            font-size: 0.9em;
            margin: 10px auto;
            max-width: 90%;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        .share-message i {
            margin-left: 8px;
            color: #007bff;
            transition: color 0.3s ease;
        }
        
        .share-link {
            color: #007bff;
            font-weight: bold;
            text-decoration: none;
            transition: color 0.3s ease;
        }
        
        .capture-controls {
            display: flex;
            gap: 15px;
            margin-top: 15px;
        }
        
        .capture-button {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 20px;
            padding: 8px 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9em;
            transition: background-color 0.3s ease;
        }
        
        .capture-button i {
            margin-right: 5px;
        }
        
        .close-capture {
            background-color: #f0f0f0;
            color: #333;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        #flowerCaptureContainer {
            position: fixed;
            z-index: -1;
            top: 0;
            left: -9999px;
            background-color: white;
            border: 2px solid #007bff;
            border-radius: 20px;
            padding: 15px;
            width: 300px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            transition: background-color 0.3s ease, border-color 0.3s ease;
        }
        
        .capture-flower-header {
            font-family: 'Billabong', cursive;
            color: #007bff;
            font-size: 1.8em;
            margin-bottom: 8px;
            text-align: center;
            font-weight: bold;
            text-shadow: 0px 1px 1px rgba(0, 123, 255, 0.2);
            transition: color 0.3s ease;
        }
        
        .capture-flower-code {
            font-weight: bold;
            color: #ff69b4;
            font-size: 0.8em;
            background-color: #fff0f8;
            padding: 6px;
            border-radius: 10px;
            border: 1px solid #ff69b4;
            margin: 6px auto;
            text-align: center;
            max-width: 80%;
            letter-spacing: 0.5px;
            transition: color 0.3s ease, background-color 0.3s ease, border-color 0.3s ease;
        }
        
        .capture-flower-motivation {
            font-style: italic;
            color: #333;
            font-size: 0.95em;
            line-height: 1.4;
            background-color: #f9f9f9;
            border: 1px dashed #ff69b4;
            border-radius: 12px;
            padding: 12px;
            margin: 12px 0;
            text-align: center;
            transition: color 0.3s ease, background-color 0.3s ease, border-color 0.3s ease;
            position: relative;
        }
        
        .capture-flower-icon {
            text-align: center;
            font-size: 2.5em;
            color: #ff69b4;
            margin: 10px 0;
            transition: color 0.3s ease;
        }
        
        .gz-logo {
            font-family: 'Billabong', cursive;
            color: #007bff;
            font-size: 1.4em;
            text-align: center;
            margin-top: 10px;
            border: 2px solid #007bff;
            border-radius: 12px;
            padding: 4px;
            width: 50px;
            margin-left: auto;
            margin-right: auto;
            font-weight: bold;
            transition: color 0.3s ease, border-color 0.3s ease;
        }
        
        .share-warning {
            background-color: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
            border-radius: 15px;
            padding: 10px 15px;
            font-size: 0.85em;
            margin: 5px auto 15px auto;
            max-width: 90%;
            text-align: center;
            display: none;
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }
        
        .capture-website-url {
            text-align: center;
            font-size: 0.85em;
            color: #007bff;
            font-weight: bold;
            margin-top: 8px;
            font-family: Arial, sans-serif;
            padding: 3px 0;
            border-top: 1px dashed #007bff;
            transition: color 0.3s ease, border-color 0.3s ease;
        }
        
        .terms-text {
            font-size: 0.8em;
            color: black;
            text-align: center;
            margin: 10px auto;
            width: 330px;
            transition: color 0.3s ease;
        }
        
        .billabong-title {
            margin-bottom: 3px;
        }

        .header-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
            padding: 0 1px;
        }

        .header-icon {
            font-size: 1.4em;
            color: #007bff;
            border: 2px solid #007bff;
            padding: 4px;
            border-radius: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            transition: color 0.3s ease, border-color 0.3s ease;
        }

        .app-logo {
            font-family: 'Billabong', cursive;
            color: #007bff;
            border: 2px solid #007bff;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 1.4em;
            font-weight: bold;
            transition: color 0.3s ease, border-color 0.3s ease;
        }

        .header-flex {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
        }
        
        .right-controls {
            display: flex;
            align-items: center;
            gap: 3px;
        }

        #welcomeToast {
            position: fixed;
            top: 160px;
            left: 0;
            right: 0;
            background-color: rgba(0,0,0,0.7);
            color: white;
            padding: 10px;
            border-radius: 20px;
            width: 80%;
            max-width: 300px;
            margin: 0 auto;
            text-align: center;
            z-index: 2000;
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease;
            font-family: , cursive;
            font-size: 1.1em;
            border: 2px solid #4CAF50;
        }

        #welcomeModal {
            display: none;
            position: fixed;
            z-index: 10;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        #welcomeModal.show {
            opacity: 1;
        }

        #welcomeModal .modal-content {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            margin: 40% auto;
            padding: 15px 10px;
            border: 2px solid #4CAF50;
            border-radius: 25px;
            width: 85%;
            max-width: 290px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            text-align: center;
            transition: transform 0.3s ease;
            transform: scale(0.8);
        }
        #welcomeModal.show .modal-content {
            transform: scale(1);
        }

        #welcomeModal .close {
            color: red;
            font-size: 18px;
            font-weight: bold;
            display: block;
            text-align: center;
            margin-bottom: 3px;
            cursor: pointer;
        }

        #welcomeModal .welcome-header {
            color: #007bff;
            font-family: 'Billabong', cursive;
            font-size: 1.8em;
            margin-bottom: 8px;
            text-align: center;
            font-weight: bold;
        }

        #welcomeModal .welcome-text {
            margin: 10px 0 15px 0;
            font-size: 0.8em;
            color: #333;
            line-height: 1.4;
            transition: color 0.3s ease;
        }

        .dob-container {
            margin: 10px 0;
        }

        .dob-container label {
            display: block;
            font-size: 0.8em;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }

        .dob-input {
            width: 90%;
            padding: 8px;
            border-radius: 10px;
            border: 1px solid #ccc;
            font-size: 16px;
        }

        .profession-container {
            margin: 12px 0;
            position: relative;
        }

        .profession-container label {
            display: block;
            font-size: 0.8em;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }

        .profession-search {
            width: 90%;
            padding: 8px;
            border-radius: 10px;
            border: 1px solid #ccc;
            font-size: 16px;
        }

        .profession-dropdown {
            display: none;
            position: absolute;
            background-color: white;
            border: 1px solid #ccc;
            border-radius: 10px;
            width: 90%;
            max-height: 150px;
            overflow-y: auto;
            left: 5%;
            z-index: 10;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .profession-option {
            padding: 8px 10px;
            font-size: 0.8em;
            cursor: pointer;
            transition: background-color 0.2s;
            background-color: white;
            color: #333;
        }

        .profession-option:hover {
            background-color: #f5f5f5;
        }

        .name-container {
            margin: 10px 0;
        }

        .name-container label {
            display: block;
            font-size: 0.8em;
            font-weight: bold;
            margin-bottom: 5px;
            color: #333;
        }

        .name-input {
            width: 90%;
            padding: 8px;
            border-radius: 10px;
            border: 1px solid #ccc;
            font-size: 16px;
        }

        #createAccountButton {
            background: linear-gradient(135deg, #007bff 0%, #0056b3 100%);
            color: white;
            border: none;
            border-radius: 15px;
            padding: 10px 25px;
            cursor: pointer;
            font-size: 0.9em;
            font-weight: bold;
            margin: 10px auto 5px;
            display: block;
            width: 80%;
            transition: all 0.3s ease;
            box-shadow: 0 2px 5px rgba(0, 123, 255, 0.3);
        }
        
        #createAccountButton:hover {
            background: linear-gradient(135deg, #0056b3 0%, #003d80 100%);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 123, 255, 0.4);
        }
        
        #createAccountButton:active {
            transform: translateY(0);
            box-shadow: 0 1px 3px rgba(0, 123, 255, 0.3);
        }

        .loading-spinner {
            display: none;
            text-align: center;
            margin: 10px 0;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }

        .loading-dots::after {
            content: '...';
            animation: dots 1.5s infinite;
            display: inline-block;
            width: 20px;
            text-align: left;
        }

        #idModal {
            display: none;
            position: fixed;
            z-index: 1001;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        #idModal.show {
            opacity: 1;
        }

        #idModal .modal-content {
            background-color: #fff;
            margin: 45% auto;
            padding: 15px;
            border: 1px solid #007BFF;
            border-radius: 25px;
            width: 65%;
            max-width: 250px;
            text-align: center;
            transition: transform 0.3s ease;
            transform: scale(0.8);
        }
        #idModal.show .modal-content {
            transform: scale(1);
        }

        .id-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
        }

        .id-title {
            font-size: 1em;
            color: #007bff;
            margin-bottom: 5px;
            transition: color 0.3s ease;
        }

        .id-display {
            font-weight: bold;
            font-size: 1.2em;
            color: #ff69b4;
            background-color: #fff0f8;
            padding: 6px;
            border-radius: 8px;
            border: 1px solid #ff69b4;
            margin: 5px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            max-width: 80%;
            transition: color 0.3s ease, background-color 0.3s ease, border-color 0.3s ease;
        }

        .delete-account {
            background-color: #ff4d4d;
            color: white;
            border: none;
            border-radius: 12px;
            padding: 6px 10px;
            font-size: 0.7em;
            cursor: pointer;
            transition: background-color 0.3s;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .delete-account:hover {
            background-color: #e60000;
        }

        .copy-icon {
            margin-left: 6px;
        }

        .id-message {
            font-size: 0.7em;
            color: #333;
            margin: 5px 0;
            transition: color 0.3s ease;
        }

        #idModal .close-button {
            margin-top: 8px;
            width: auto;
            padding: 6px 15px;
            font-size: 0.7em;
            height: 28px;
        }

        .menu-link {
            text-decoration: none;
            color: #007bff;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: color 0.3s ease;
        }
        
        .style-selector {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            background-color: white;
            padding: 10px 0;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 100;
            transition: background-color 0.3s ease;
        }
        
        .style-selector h3 {
            text-align: center;
            margin: 0 0 10px 0;
            font-size: 1em;
            color: #333;
            transition: color 0.3s ease;
        }
        
        .style-options {
            display: flex;
            justify-content: center;
            gap: 10px;
            padding: 0 5px;
            overflow-x: auto;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }
        
        .style-options::-webkit-scrollbar {
            display: none;
        }
        
        .style-option {
            width: 60px;
            height: 40px;
            border-radius: 10px;
            cursor: pointer;
            flex-shrink: 0;
            position: relative;
            border: 1px solid #ddd;
            overflow: hidden;
        }
        
        .style-option.selected {
            border: 2px solid white;
            box-shadow: 0 0 0 2px #007bff;
        }
        
        .style-option.red-black {
            background: linear-gradient(to right, #FF4500, #8B0000, #121212, #121212);
        }
        
        .style-option.green-blue {
            background: linear-gradient(to right, #3EB489, #14532D, #0A2239, #1A2E4D);
        }
        
        .style-option.orange-pink {
            background: linear-gradient(to right, #FF7F50, #FF6F91, #C71585, #4B0082);
        }
        
        .style-option.yellow-purple {
            background: linear-gradient(to right, #FFD700, #FFA500, #8A2BE2, #4B0082);
        }
        
        .style-option.default {
            background: linear-gradient(to right, #007bff, #0056b3);
        }
        
        .main-content {
            padding-bottom: 80px;
            flex: 1;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
        }
        
        body.theme-default {
            background-color: white;
            color: #333;
        }
        
        body.theme-default header, 
        body.theme-default footer,
        body.theme-default .style-selector {
            background-color: white;
        }
        
        body.theme-default .app-logo,
        body.theme-default .header-icon,
        body.theme-default .divider,
        body.theme-default .notification,
        body.theme-default .billabong-title,
        body.theme-default .gz-logo,
        body.theme-default .capture-website-url,
        body.theme-default .capture-flower-header,
        body.theme-default .id-title {
            color: #007bff;
            border-color: #007bff;
        }
        
        body.theme-default .notification .notification-text {
            color: #007bff;
        }
        
        body.theme-default .button {
            background-color: #007bff;
        }
        
        body.theme-default .share-flower-button {
            background-color: #007bff;
            color: white;
            border-color: #0056b3;
        }
        
        body.theme-default .flower-code,
        body.theme-default .id-display {
            color: #ff69b4;
            background-color: #fff0f8;
            border-color: #ff69b4;
        }
        
        body.theme-default .monthly-motivation,
        body.theme-default .capture-flower-motivation {
            border-color: #ff69b4;
            color: #333;
            background-color: white;
        }
        
        body.theme-default .modal-content {
            background-color: white;
            border-color: #007bff;
        }
        
        body.theme-red-black {
            background: black;
            color: #E5E5E5;
        }
        
        body.theme-red-black header, 
        body.theme-red-black footer,
        body.theme-red-black .style-selector {
            background-color: black;
        }
        
        body.theme-red-black .app-logo,
        body.theme-red-black .header-icon,
        body.theme-red-black .gz-logo,
        body.theme-red-black .capture-flower-header,
        body.theme-red-black .capture-website-url,
        body.theme-red-black .id-title,
        body.theme-red-black .billabong-title {
            color: #FF4500;
            border-color: #FF4500;
        }
        
        body.theme-red-black .divider {
            background-color: #FF4500;
        }
        
        body.theme-red-black .notification .notification-text {
            color: #FF4500;
        }
        
        body.theme-red-black .notification,
        body.theme-red-black .welcome-text,
        body.theme-red-black .id-message {
            color: #CCCCCC;
        }
        
        body.theme-red-black .button {
            background-color: #8B0000;
        }
        
        body.theme-red-black .share-flower-button {
            background-color: #8B0000;
            color: white;
            border-color: #FF4500;
        }
        
        body.theme-red-black .flower-code,
        body.theme-red-black .id-display {
            color: #FF4500;
            background-color: black;
            border-color: #FF4500;
        }
        
        body.theme-red-black .monthly-motivation,
        body.theme-red-black .capture-flower-motivation {
            border-color: #FF4500;
            color: #E5E5E5;
            background-color: black;
        }
        
        body.theme-red-black .modal-content,
        body.theme-red-black #flowerCaptureContainer {
            background-color: black;
            border-color: #8B0000;
        }
        
        body.theme-green-blue {
            background: #1A2E4D;
            color: #F5F5F5;
        }
        
        body.theme-green-blue header, 
        body.theme-green-blue footer,
        body.theme-green-blue .style-selector {
            background-color: #1A2E4D;
        }
        
        body.theme-green-blue .app-logo,
        body.theme-green-blue .header-icon,
        body.theme-green-blue .gz-logo,
        body.theme-green-blue .capture-flower-header,
        body.theme-green-blue .capture-website-url,
        body.theme-green-blue .id-title,
        body.theme-green-blue .billabong-title {
            color: #3EB489;
            border-color: #3EB489;
        }
        
        body.theme-green-blue .divider {
            background-color: #3EB489;
        }
        
        body.theme-green-blue .notification .notification-text {
            color: #3EB489;
        }
        
        body.theme-green-blue .notification,
        body.theme-green-blue .welcome-text,
        body.theme-green-blue .id-message {
            color: #A0A0A0;
        }
        
        body.theme-green-blue .button {
            background-color: #14532D;
        }
        
        body.theme-green-blue .share-flower-button {
            background-color: #14532D;
            color: white;
            border-color: #3EB489;
        }
        
        body.theme-green-blue .flower-code,
        body.theme-green-blue .id-display {
            color: #3EB489;
            background-color: #36454F;
            border-color: #3EB489;
        }
        
        body.theme-green-blue .monthly-motivation,
        body.theme-green-blue .capture-flower-motivation {
            border-color: #3EB489;
            color: #F5F5F5;
            background-color: #1A2E4D;
        }
        
        body.theme-green-blue .modal-content,
        body.theme-green-blue #flowerCaptureContainer {
            background-color: #1A2E4D;
            border-color: #3EB489;
        }
        
        body.theme-orange-pink {
            background: #4B0082;
            color: #FFFFFF;
        }
        
        body.theme-orange-pink header, 
        body.theme-orange-pink footer,
        body.theme-orange-pink .style-selector {
            background-color: #4B0082;
        }
        
        body.theme-orange-pink .app-logo,
        body.theme-orange-pink .header-icon,
        body.theme-orange-pink .gz-logo,
        body.theme-orange-pink .capture-flower-header,
        body.theme-orange-pink .capture-website-url,
        body.theme-orange-pink .id-title,
        body.theme-orange-pink .billabong-title {
            color: #FF7F50;
            border-color: #FF7F50;
        }
        
        body.theme-orange-pink .divider {
            background-color: #FF7F50;
        }
        
        body.theme-orange-pink .notification .notification-text {
            color: #FF7F50;
        }
        
        body.theme-orange-pink .notification,
        body.theme-orange-pink .welcome-text,
        body.theme-orange-pink .id-message {
            color: #D3D3D3;
        }
        
        body.theme-orange-pink .button {
            background-color: #C71585;
        }
        
        body.theme-orange-pink .share-flower-button {
            background-color: #C71585;
            color: white;
            border-color: #FF7F50;
        }
        
        body.theme-orange-pink .flower-code,
        body.theme-orange-pink .id-display {
            color: #FF7F50;
            background-color: #6A0DAD;
            border-color: #FF7F50;
        }
        
        body.theme-orange-pink .monthly-motivation,
        body.theme-orange-pink .capture-flower-motivation {
            border-color: #FF7F50;
            color: #FFFFFF;
            background-color: #4B0082;
        }
        
        body.theme-orange-pink .modal-content,
        body.theme-orange-pink #flowerCaptureContainer {
            background-color: #4B0082;
            border-color: #FF7F50;
        }

        body.theme-yellow-purple {
            background: #4B0082;
            color: #FFFFFF;
        }
        
        body.theme-yellow-purple header, 
        body.theme-yellow-purple footer,
        body.theme-yellow-purple .style-selector {
            background-color: #4B0082;
        }
        
        body.theme-yellow-purple .app-logo,
        body.theme-yellow-purple .header-icon,
        body.theme-yellow-purple .gz-logo,
        body.theme-yellow-purple .capture-flower-header,
        body.theme-yellow-purple .capture-website-url,
        body.theme-yellow-purple .id-title,
        body.theme-yellow-purple .billabong-title {
            color: #FFD700;
            border-color: #FFD700;
        }
        
        body.theme-yellow-purple .divider {
            background-color: #FFD700;
        }
        
        body.theme-yellow-purple .notification .notification-text {
            color: #FFD700;
        }
        
        body.theme-yellow-purple .notification,
        body.theme-yellow-purple .welcome-text,
        body.theme-yellow-purple .id-message {
            color: #D3D3D3;
        }
        
        body.theme-yellow-purple .button {
            background-color: #8A2BE2;
        }
        
        body.theme-yellow-purple .share-flower-button {
            background-color: #8A2BE2;
            color: white;
            border-color: #FFD700;
        }
        
        body.theme-yellow-purple .flower-code,
        body.theme-yellow-purple .id-display {
            color: #FFD700;
            background-color: #6A0DAD;
            border-color: #FFD700;
        }
        
        body.theme-yellow-purple .monthly-motivation,
        body.theme-yellow-purple .capture-flower-motivation {
            border-color: #FFD700;
            color: #FFFFFF;
            background-color: #4B0082;
        }
        
        body.theme-yellow-purple .modal-content,
        body.theme-yellow-purple #flowerCaptureContainer {
            background-color: #4B0082;
            border-color: #FFD700;
        }
        
        .refresh-motivation {
            position: absolute;
            right: 15px;
            top: 70px;
            color: #007bff;
            cursor: pointer;
            font-size: 1.2em;
            padding: 5px;
            background-color: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            transition: transform 0.3s ease, color 0.3s ease;
        }
        
        .refresh-motivation:hover {
            transform: rotate(180deg);
        }
        
        body.theme-red-black .refresh-motivation {
            color: #FF4500;
        }
        
        body.theme-green-blue .refresh-motivation {
            color: #3EB489;
        }
        
        body.theme-orange-pink .refresh-motivation {
            color: #FF7F50;
        }
        
        body.theme-yellow-purple .refresh-motivation {
            color: #FFD700;
        }
        
        .user-name {
            font-size: 0.75em;
            font-weight: bold;
        }

        .install-prompt {
            display: none;
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 0.9em;
            z-index: 1000;
            width: 80%;
            max-width: 300px;
            text-align: center;
        }
        
        .install-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 10px;
        }
        
        .install-btn {
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            font-size: 0.8em;
            cursor: pointer;
        }
        
        .dismiss-btn {
            background-color: transparent;
            color: #ccc;
            border: 1px solid #ccc;
            border-radius: 5px;
            padding: 5px 10px;
            font-size: 0.8em;
            cursor: pointer;
        }
    </style>
</head>
<body class="theme-green-blue">

  <header>
   
    <div class="header-container">
      <div class="app-logo">G-Z</div>
      
      <div class="right-controls">
        
   
        <div class="header-icon" id="showIdButton"><i class="fas fa-user"></i></div>
        
         <a href="https://g-z.online/translate.html" class="header-icon menu-link"><i class="fas fa-globe"></i></a>
        
        <a href="https://g-z.online/us.html" class="header-icon menu-link"><i class="fas fa-bars"></i></a>
      </div>
    </div>
  </header>

  <div class="divider"></div>

  <div class="main-content">
    <div class="button-container">
      <a class="button" href="#" id="flowerButton"><i class="fas fa-spa flower-icon"></i><span>Bunga kehidupan</span></a>
      
    

    </div>

    <div class="divider"></div>
    <div class="notification">
      <span class="notification-text">💠 Bunga -- Pesan yang alam semesta tulis khusus untukmu ¯\_(ツ)_/¯</span>
    </div>

    <div class="divider"></div>
  </div>

  <div class="style-selector">
    <h3>Gaya</h3>
    <div class="style-options">
      <div class="style-option red-black" data-theme="red-black"></div>
      <div class="style-option green-blue selected" data-theme="green-blue"></div>
      <div class="style-option orange-pink" data-theme="orange-pink"></div>
      <div class="style-option yellow-purple" data-theme="yellow-purple"></div>
      <div class="style-option default" data-theme="default"></div>
    </div>
  </div>

  <div id="welcomeToast">
    
    Selamat datang kembali    ¯\_(ツ)_/¯
  </div>

  <div id="welcomeModal" class="modal">
    <div class="modal-content">
      <div class="welcome-header">💠 Selamat datang 💠</div>
      <div class="welcome-text">
        Pembuatan akun memerlukan tanggal lahir, profesi, dan nama Anda untuk membuat bunga unik Anda.
      </div>
      
      <div class="name-container">
        <label for="fullNameInput">Nama Lengkap Anda:</label>
        <input type="text" id="fullNameInput" class="name-input" placeholder="Masukkan nama lengkap Anda...">
      </div>
      
      <div class="dob-container">
        <label for="dobInput">Tanggal Lahir:</label>
        <input type="date" id="dobInput" class="dob-input" max="">
      </div>
      
      <div class="profession-container">
        <label for="professionInput">Profesi Anda:</label>
        <input type="text" id="professionInput" class="profession-search" placeholder="Ketik profesi Anda...">
        <div id="professionDropdown" class="profession-dropdown"></div>
      </div>
      
      <div class="loading-spinner" id="loadingSpinner">
        <span>Membuat bunga unik Anda</span>
        <span class="loading-dots"></span>
      </div>
      
      <button id="createAccountButton">Buat Akun</button>
    </div>
  </div>

  <div id="idModal" class="modal">
    <div class="modal-content">
      <div class="id-title">ID Pengguna Anda</div>
      <div class="id-display">
        <span id="userIdDisplay"></span>
        <i class="fas fa-copy copy-icon" id="copyIdButton"></i>
      </div>
      <div class="id-message">Simpan ID ini dengan aman!</div>
      <div class="id-actions">
        <button class="delete-account" id="deleteAccountButton">Hapus Akun</button>
        <button class="close-button" id="closeIdModal">Tutup</button>
      </div>
    </div>
  </div>

  <div id="flowerModal" class="modal">
    <div class="modal-content">
      <button class="modal-close" id="closeFlowerModal"><i class="fas fa-times"></i></button>
      <div class="billabong-title"><strong id="flowerTypeTitle">Bunga Kehidupan</strong></div>
      
      <div id="flowerCodeDisplay" class="flower-code"></div>
      
      <i class="fas fa-sync-alt refresh-motivation" id="refreshMotivation" title="Buat motivasi baru"></i>
      
      <div class="monthly-motivation" id="monthlyMotivation">
      </div>
      
      <div style="margin: 10px auto; font-size: 3em; color: #ff69b4;" id="flowerIconContainer">
        <i class="fas fa-spa"></i>
      </div>
    </div>
  </div>
  
  <button class="share-flower-button" id="shareFlowerButton">
    <span>Bagikan Bunga Saya</span> <i class="fas fa-arrow-right send-icon"></i>
  </button>
  
  <div id="capturedFlower">
    <div class="captured-image-container">
      <img id="capturedImage" class="captured-image" src="" alt="Bunga yang Ditangkap">
    </div>

    <div class="share-warning" id="shareWarning">
      <i class="fas fa-exclamation-triangle" style="margin-right: 5px;"></i>
      <span>Sempurna untuk dibagikan, dari Google/Safari.</span>
    </div>
    
    <div class="capture-controls">
      <button class="capture-button" id="shareCapture">
        <i class="fas fa-share"></i> <span>Bagikan</span>
      </button>
      
      <button class="capture-button close-capture" id="closeCapture">
        <i class="fas fa-download"></i> <span>Simpan</span>
      </button>
    </div>
  </div>
  
  <div id="flowerCaptureContainer">
    <div class="capture-flower-header" id="captureFlowerHeader">Bunga Kehidupan</div>
    
    <div id="captureFlowerCode" class="capture-flower-code"></div>
    
    <div id="captureFlowerMotivation" class="capture-flower-motivation">
    </div>
    
    <div class="capture-flower-icon" id="captureFlowerIcon">
      <i class="fas fa-spa"></i>
    </div>
    
    <div class="gz-logo">G-Z</div>
    
    <div class="capture-website-url">Temukan milikmu di www.g-z.online</div>
  </div>

  <div class="install-prompt" id="installPrompt">
    <p>Tambahkan G-Z ke layar beranda Anda untuk pengalaman yang lebih baik!</p>
    <div class="install-buttons">
      <button class="install-btn" id="installBtn">Pasang</button>
      <button class="dismiss-btn" id="dismissBtn">Nanti</button>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyCrPKQOqw4zciASa_5PbI_etfkvrBaDPDI",
      authDomain: "genz-abb36.firebaseapp.com",
      databaseURL: "https://genz-abb36-default-rtdb.firebaseio.com",
      projectId: "genz-abb36",
      storageBucket: "genz-abb36.firebasestorage.app",
      messagingSenderId: "405021535683",
      appId: "1:405021535683:web:ee5a28fde27f5558046176",
      measurementId: "G-XZNQND2J00"
    };

    firebase.initializeApp(firebaseConfig);
    
    const auth = firebase.auth();
    const database = firebase.database();
    const firestore = firebase.firestore();
    
    let userUid = null;
    let userFlowerCode = null;
    let currentMotivation = null;
    let currentCountry = null;
    let userCity = null;
    let userUniqueId = null;
    let isAuthenticated = false;
    let isInstalled = false;
    let currentTheme = "green-blue";
    let userDateOfBirth = null;
    let userProfession = null;
    let userFullName = null;
    let seenSubjects = [];
    let shareCount = 0;
    let deferredPrompt = null;

    const professions = [
      "Musisi", "Rapper", "Pemain Sepak Bola", "Pemain Basket", "Petinju", 
      "Pelajar", "Guru", "Dokter", "Perawat", "Insinyur", 
      "Pengembang Perangkat Lunak", "Desainer", "Seniman", "Penulis", "Jurnalis", 
      "Koki", "Pelayan", "Pembantu Rumah Tangga", "TikToker", "YouTuber", 
      "Influencer", "Fotografer", "Videografer", "Penari", "Aktor/Aktris", 
      "Model", "Arsitek", "Pengacara", "Akuntan", "Penasihat Keuangan", 
      "Bankir", "Pengusaha", "Pemilik Bisnis", "Manajer", "Eksekutif", 
      "Tenaga Penjualan", "Pemasar", "Manajer Media Sosial", "Pengemudi", "Pilot", 
      "Pramugari", "Mekanik", "Tukang Listrik", "Tukang Ledeng", "Pekerja Konstruksi", 
      "Petani", "Tukang Kebun", "Dokter Hewan", "Pelatih Pribadi", "Instruktur Kebugaran", 
      "Guru Yoga", "Terapis", "Psikolog", "Konselor", "Pastor/Pemimpin Agama",
      "Ilmuwan", "Peneliti", "Profesor", "Polisi", "Pemadam Kebakaran",
      "Personel Militer", "Petugas Keamanan", "Agen Real Estate", "Apoteker", "Dokter Gigi",
      "Optometris", "Terapis Fisik", "Terapis Okupasi", "Terapis Wicara", "Ahli Gizi",
      "Ahli Nutrisi", "Penata Rambut", "Penata Rias", "Ahli Estetika", "Penjahit",
      "Perancang Busana", "Pekerja Ritel", "Kasir", "Perwakilan Layanan Pelanggan", "Agen Call Center",
      "Penerjemah", "Juru Bahasa", "Pemandu Wisata", "Agen Perjalanan", "Manajer Hotel",
      "Resepsionis", "Sekretaris", "Asisten Administratif", "Pustakawan", "Arsiparis",
      "Sejarawan", "Arkeolog", "Antropolog", "Sosiolog", "Ilmuwan Politik",
      "Ekonom", "Statistikawan", "Analis Data", "Ilmuwan Data", "Desainer UX/UI",
      "Pengembang Game", "Pengembang Aplikasi", "Pengembang Web", "Administrator Jaringan", "Spesialis Keamanan Siber",
      "Dukungan TI", "Teknisi", "Spesialis Perbaikan", "Pembuat Roti", "Tukang Daging",
      "Nelayan", "Penambang", "Rimbawan", "Tukang Taman", "Desainer Interior",
      "Perencana Acara", "Perencana Pernikahan", "Floris", "Tukang Perhiasan", "Pengrajin",
      "Programmer", "Desainer Web", "Pemasar Digital", "Spesialis SEO", "Pembuat Konten",
      "Manajer Produk", "Manajer Proyek", "Penjamin Mutu", "Analis Bisnis", "Konsultan",
      "Perekrut", "Manajer SDM", "Pelatih Karir", "Pelatih Kehidupan", "Pembicara Motivasi",
      "Pembicara Publik", "Penyiar Radio", "Pembawa Acara TV", "Penyiar", "Podcaster",
      "Penulis", "Penulis Skenario", "Penulis Naskah", "Penulis Teknis", "Editor",
      "Penerbit", "Agen Sastra", "Pemilik Toko Buku", "Pustakawan", "Pengulas Buku",
      "Desainer Grafis", "Ilustrator", "Animator", "Seniman 3D", "Seniman VFX",
      "Sutradara Film", "Produser", "Operator Kamera", "Teknisi Suara", "Teknisi Pencahayaan",
      "Editor Film", "Asisten Produksi", "Perancang Set", "Perancang Kostum", "Penata Rias Film",
      "Seniman Efek Khusus", "Pemain Stunt", "Pengisi Suara", "Agen Bakat", "Direktur Casting"
    ];

    const subjectDictionary = {
      "Success": "Kesuksesan",
      "Achievement": "Prestasi",
      "Victory": "Kemenangan",
      "Triumph": "Kejayaan",
      "Accomplishment": "Pencapaian",
      
      "Richest": "Kekayaan",
      "Prosperity": "Kemakmuran",
      "Abundance": "Kelimpahan",
      "Fortune": "Keberuntungan",
      "Affluence": "Kemewahan",
      
      "Joy": "Kegembiraan",
      "Happiness": "Kebahagiaan",
      "Bliss": "Kebahagiaan",
      "Delight": "Kesenangan",
      "Contentment": "Kepuasan",
      
      "Growth": "Pertumbuhan",
      "Progress": "Kemajuan",
      "Advancement": "Kemajuan",
      "Development": "Perkembangan",
      "Improvement": "Peningkatan",
      
      "Power": "Kekuatan",
      "Strength": "Kekuatan",
      "Might": "Kekuasaan",
      "Force": "Daya",
      "Energy": "Energi",
      
      "Wisdom": "Kebijaksanaan",
      "Intelligence": "Kecerdasan",
      "Knowledge": "Pengetahuan",
      "Insight": "Wawasan",
      "Understanding": "Pemahaman",
      
      "Creativity": "Kreativitas",
      "Innovation": "Inovasi",
      "Imagination": "Imajinasi",
      "Invention": "Penemuan",
      "Originality": "Keaslian",
      
      "Leadership": "Kepemimpinan",
      "Authority": "Otoritas",
      "Influence": "Pengaruh",
      "Command": "Komando",
      "Direction": "Arahan",
      
      "Peace": "Kedamaian",
      "Harmony": "Harmoni",
      "Tranquility": "Ketenangan",
      "Serenity": "Ketenangan",
      "Calm": "Ketenangan",
      
      "Love": "Cinta",
      "Affection": "Kasih Sayang",
      "Adoration": "Kekaguman",
      "Devotion": "Pengabdian",
      "Passion": "Gairah",
      
      "Courage": "Keberanian",
      "Bravery": "Keberanian",
      "Valor": "Keberanian",
      "Heroism": "Kepahlawanan",
      "Fearlessness": "Ketidaktakutan",
      
      "Health": "Kesehatan",
      "Vitality": "Vitalitas",
      "Wellness": "Kesejahteraan",
      "Vigor": "Kekuatan",
      "Fitness": "Kebugaran",
      
      "Freedom": "Kebebasan",
      "Liberty": "Kemerdekaan",
      "Independence": "Kemandirian",
      "Autonomy": "Otonomi",
      "Self-determination": "Penentuan Nasib Sendiri",
      
      "Purpose": "Tujuan",
      "Meaning": "Makna",
      "Mission": "Misi",
      "Calling": "Panggilan",
      "Destiny": "Takdir",
      
      "Resilience": "Ketahanan",
      "Tenacity": "Keteguhan",
      "Perseverance": "Ketekunan",
      "Endurance": "Daya Tahan",
      "Grit": "Keteguhan",
      
      "Authenticity": "Keaslian",
      "Genuineness": "Ketulusan",
      "Honesty": "Kejujuran",
      "Integrity": "Integritas",
      "Sincerity": "Ketulusan",
      
      "Transformation": "Transformasi",
      "Change": "Perubahan",
      "Evolution": "Evolusi",
      "Rebirth": "Kelahiran Kembali",
      "Metamorphosis": "Metamorfosis",
      
      "Connection": "Koneksi",
      "Relationship": "Hubungan",
      "Community": "Komunitas",
      "Belonging": "Rasa Memiliki",
      "Unity": "Persatuan",
      
      "Gratitude": "Rasa Syukur",
      "Thankfulness": "Terima Kasih",
      "Appreciation": "Penghargaan",
      "Recognition": "Pengakuan",
      "Acknowledgment": "Pengakuan",
      
      "Mindfulness": "Kesadaran",
      "Presence": "Kehadiran",
      "Awareness": "Kesadaran",
      "Consciousness": "Kesadaran",
      "Attentiveness": "Perhatian",
      
      "Compassion": "Belas Kasih",
      "Empathy": "Empati",
      "Kindness": "Kebaikan",
      "Generosity": "Kemurahan Hati",
      "Altruism": "Altruisme",
      
      "Balance": "Keseimbangan",
      "Equilibrium": "Keseimbangan",
      "Harmony": "Harmoni",
      "Proportion": "Proporsi",
      "Symmetry": "Simetri",
      
      "Inspiration": "Inspirasi",
      "Motivation": "Motivasi",
      "Enthusiasm": "Antusiasme",
      "Excitement": "Kegembiraan",
      "Passion": "Gairah",
      
      "Focus": "Fokus",
      "Concentration": "Konsentrasi",
      "Attention": "Perhatian",
      "Discipline": "Disiplin",
      "Dedication": "Dedikasi",
      
      "Humility": "Kerendahan Hati",
      "Modesty": "Kesederhanaan",
      "Simplicity": "Kesederhanaan",
      "Unpretentiousness": "Kesederhanaan",
      "Groundedness": "Keterdaratan",
      
      "Patience": "Kesabaran",
      "Tolerance": "Toleransi",
      "Forbearance": "Kesabaran",
      "Endurance": "Ketahanan",
      "Persistence": "Ketekunan",
      
      "Joy": "Kegembiraan",
      "Delight": "Kesenangan",
      "Gladness": "Kegembiraan",
      "Exultation": "Kegirangan",
      "Jubilation": "Kegembiraan",
      
      "Trust": "Kepercayaan",
      "Faith": "Iman",
      "Confidence": "Percaya Diri",
      "Reliance": "Ketergantungan",
      "Dependability": "Keandalan",
      
      "Self-confidence": "Kepercayaan Diri",
      "Self-esteem": "Harga Diri",
      "Self-belief": "Keyakinan Diri",
      "Self-assurance": "Keyakinan Diri",
      "Self-trust": "Kepercayaan Diri",
      
      "Enthusiasm": "Antusiasme",
      "Zeal": "Semangat",
      "Eagerness": "Keinginan",
      "Ardor": "Gairah",
      "Fervor": "Semangat",
      
      "Clarity": "Kejelasan",
      "Lucidity": "Kejernihan",
      "Transparency": "Transparansi",
      "Precision": "Ketepatan",
      "Sharpness": "Ketajaman",
      
      "Adaptability": "Kemampuan Beradaptasi",
      "Flexibility": "Fleksibilitas",
      "Versatility": "Serba Bisa",
      "Adjustability": "Kemampuan Menyesuaikan",
      "Malleability": "Kelenturan",
      
      "Communication": "Komunikasi",
      "Expression": "Ekspresi",
      "Articulation": "Artikulasi",
      "Dialogue": "Dialog",
      "Conversation": "Percakapan",
      
      "Career": "Karir",
      "Profession": "Profesi",
      "Vocation": "Pekerjaan",
      "Occupation": "Pekerjaan",
      "Calling": "Panggilan"
    };

    function formatUserName(fullName) {
      if (!fullName) return "";
      
      const nameParts = fullName.trim().split(' ');
      
      if (nameParts.length === 1) {
        return nameParts[0];
      }
      
      const firstName = nameParts[0];
      const lastNameInitial = nameParts[nameParts.length - 1].charAt(0).toUpperCase();
      
      return `👑 ${firstName} ${lastNameInitial}.`;
    }

    function generateUniqueId() {
      const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      const numbers = '0123456789';
      let id = '';
      
      for (let i = 0; i < 3; i++) {
        id += letters.charAt(Math.floor(Math.random() * letters.length));
      }
      
      for (let i = 0; i < 3; i++) {
        id += numbers.charAt(Math.floor(Math.random() * numbers.length));
      }
      
      return id;
    }

    async function detectUserLocation() {
      try {
        const response = await fetch('https://ipapi.co/json/');
        const data = await response.json();
        currentCountry = data.country_name;
        userCity = data.city;
        console.log("Detected user location:", currentCountry, userCity);
        return { country: currentCountry, city: userCity };
      } catch (error) {
        console.error("Error detecting user location:", error);
        return { country: "Unknown", city: "Unknown" };
      }
    }

    function generatePersonalizedMotivation(flowerCode, profession, dob) {
      if (!flowerCode || flowerCode.length < 8) {
        return "Motivasi bunga ini ada untuk menginspirasi dan membimbing Anda.";
      }
      
      let month = 0;
      if (dob) {
        const dobDate = new Date(dob);
        month = dobDate.getMonth();
      }
      
      const lifeTraits = [
        "Kreativitas membawa ide-ide segar untuk setiap tantangan yang Anda hadapi.",
        "Kebaikan di hati Anda menginspirasi orang lain di sekitar Anda setiap hari.",
        "Ketekunan membantu Anda mengatasi rintangan yang orang lain anggap mustahil.",
        "Perspektif unik memungkinkan Anda memecahkan masalah dengan cara yang inovatif.",
        "Kehadiran energik mencerahkan hari bagi semua orang yang Anda temui.",
        "Kesabaran memungkinkan Anda melihat gambaran yang lebih besar ketika orang lain tidak bisa.",
        "Keberanian memungkinkan Anda menghadapi tantangan baru dengan tekad.",
        "Kebijaksanaan membimbing Anda melalui keputusan sulit dengan kejelasan.",
        "Optimisme membantu Anda menemukan peluang dalam situasi apa pun yang Anda hadapi.",
        "Fokus mendorong Anda untuk mencapai tujuan langkah demi langkah dengan presisi.",
        "Kemampuan beradaptasi menjadi kekuatan terbesar Anda di masa-masa perubahan.",
        "Intuisi membimbing Anda ke jalan yang benar ketika pilihan tampak tidak jelas.",
        "Empati menghubungkan Anda secara mendalam dengan orang lain dalam cara yang bermakna.",
        "Ketahanan membantu Anda bangkit lebih kuat dari kemunduran apa pun.",
        "Keaslian menarik orang pada diri Anda yang sebenarnya tanpa kepura-puraan.",
        "Rasa syukur melipatgandakan kegembiraan dalam hidup Anda setiap hari yang berlalu.",
        "Keingintahuan mengarah pada penemuan baru yang mungkin diabaikan orang lain.",
        "Rasa humor mencerahkan bahkan saat-saat paling sulit.",
        "Kemurahan hati menciptakan riak kebaikan di seluruh komunitas Anda.",
        "Tekad mengubah tantangan menjadi prestasi yang layak dirayakan.",
        "Belas kasih menyembuhkan orang-orang di sekitar Anda dengan cara yang halus namun kuat.",
        "Kejelasan membantu Anda membuat pilihan bijak ketika kebingungan mengelilingi Anda.",
        "Kepercayaan diri menginspirasi kepercayaan pada orang lain yang mengikuti kepemimpinan Anda.",
        "Kesadaran membuat Anda tetap terpusat bahkan di tengah kekacauan dan ketidakpastian.",
        "Integritas mendapatkan rasa hormat ke mana pun Anda pergi di antara rekan-rekan dan pemimpin.",
        "Antusiasme menyalakan gairah pada orang lain yang menyaksikan energi Anda.",
        "Kehangatan membuat orang merasa langsung disambut dalam kehadiran Anda.",
        "Imajinasi membuka pintu ke kemungkinan yang tidak dapat dilihat orang lain.",
        "Keseimbangan membantu Anda menavigasi kompleksitas kehidupan dengan anggun.",
        "Visi memungkinkan Anda melihat melampaui cakrawala ketika orang lain berhenti.",
        "Karisma menarik orang menuju energi magnetik Anda secara alami.",
        "Disiplin membangun fondasi untuk kesuksesan dalam semua usaha.",
        "Sifat intuitif membantu Anda memahami kebenaran halus yang dilewatkan orang lain.",
        "Keceriaan menjaga semangat Anda tetap muda dan bersemangat melalui tantangan.",
        "Pikiran analitis menemukan solusi yang diabaikan orang lain sepenuhnya.",
        "Perhatian menciptakan hubungan yang bermakna yang bertahan seumur hidup.",
        "Sensitivitas memungkinkan Anda merasakan apa yang dibutuhkan orang lain tanpa bertanya.",
        "Ketegasan memajukan proyek ketika orang lain ragu-ragu.",
        "Konsistensi membangun kepercayaan dari waktu ke waktu dalam semua hubungan Anda.",
        "Ekspresi mengkomunikasikan kebenaran Anda dengan indah kepada dunia.",
        "Kecerdikan mengubah keterbatasan menjadi peluang untuk pertumbuhan.",
        "Ketekunan memastikan kualitas dalam segala hal yang Anda sentuh atau ciptakan.",
        "Fleksibilitas beradaptasi dengan keadaan yang berubah dengan kelembutan yang luar biasa.",
        "Pragmatisme mendasarkan tindakan Anda pada kenyataan sambil bermimpi besar.",
        "Kefasihan mengartikulasikan ide-ide kompleks dengan jelas agar orang lain mengerti.",
        "Kemampuan melihat ke depan membantu Anda mempersiapkan tantangan masa depan sebelum tiba.",
        "Kelembutan menyembuhkan luka tanpa meninggalkan bekas di hati yang lembut.",
        "Ketegasan membela apa yang benar tanpa ragu-ragu.",
        "Kemandirian menumbuhkan kemandirian dan kekuatan dalam kesulitan.",
        "Kehati-hatian memperhatikan detail penting yang dilewatkan orang lain.",
        "Ketangkasan mental membantu Anda beradaptasi dengan situasi baru dengan mudah.",
        "Kesadaran diri menerangi jalan Anda menuju pertumbuhan dan pemenuhan.",
        "Kekuatan batin bersinar paling terang selama masa-masa sulit ujian.",
        "Kepribadian magnetik menarik orang ke dalam orbit Anda tanpa upaya.",
        "Kecerdasan emosional membantu Anda menavigasi hubungan yang kompleks.",
        "Pemikiran cepat menemukan solusi ketika orang lain hanya melihat masalah.",
        "Kepercayaan diri yang tenang berbicara banyak tanpa mengucapkan sepatah kata pun.",
        "Kepemimpinan alami menginspirasi orang lain untuk mengikuti naluri terbaik mereka.",
        "Etika yang tak tergoyahkan membimbing keputusan Anda bahkan dalam kegelapan.",
        "Sensibilitas artistik menemukan keindahan di tempat dan momen yang tak terduga.",
        "Pikiran strategis mengantisipasi perkembangan masa depan dengan akurasi.",
        "Spontanitas membawa energi segar ke situasi basi dengan cepat.",
        "Perhatian teliti terhadap detail mencegah komplikasi di masa depan.",
        "Kehadiran damai menenangkan bahkan lingkungan yang paling kacau.",
        "Pemikiran inovatif menembus batasan konvensional.",
        "Diplomasi alami menyelesaikan konflik dengan anggun dan keadilan.",
        "Kepercayaan membuat Anda menjadi tempat curhat bagi mereka yang membutuhkan.",
        "Antusiasme yang menular mengangkat semua orang di sekitar Anda lebih tinggi."
      ];
      
      const lifeEncouragements = [
        "Teruslah berbagi karunia ini dengan dunia di sekitar Anda.",
        "Percayalah pada naluri ini - mereka jarang menyesatkan Anda.",
        "Bakat alami ini dimaksudkan untuk dibagikan secara luas.",
        "Jalan di depan mungkin memiliki tantangan, tetapi Anda sangat siap.",
        "Langkah kecil hari ini mengarah pada pencapaian besar besok.",
        "Ingatlah untuk merayakan kemajuan sepanjang jalan ke depan.",
        "Perjalanan unik ini layak untuk setiap langkah yang Anda ambil.",
        "Jangan lupa untuk menikmati prosesnya, bukan hanya hasilnya.",
        "Hari-hari terbaik masih di depan dalam petualangan ini.",
        "Usaha hari ini membangun cerita sukses masa depan.",
        "Tetaplah menjadi diri sendiri dalam semua situasi dan tantangan.",
        "Rangkullah perubahan sebagai kesempatan untuk tumbuh lebih kuat.",
        "Dengarkan kebijaksanaan batin lebih sering - itu tahu jalannya.",
        "Izinkan diri Anda beristirahat saat diperlukan tanpa rasa bersalah.",
        "Tetap fokus pada apa yang benar-benar penting dalam gambaran yang lebih besar.",
        "Kehadiran Anda adalah hadiah bagi mereka yang cukup beruntung mengenal Anda.",
        "Pelihara gairah secara konsisten meskipun jadwal sibuk.",
        "Berlembutlah pada diri sendiri selama tantangan dan kemunduran.",
        "Jalan unik ini sangat tepat untuk ke mana Anda perlu pergi.",
        "Percayalah pada waktu terungkapnya misteri kehidupan.",
        "Temukan kegembiraan dalam momen-momen kecil setiap hari tanpa gagal.",
        "Perspektif ini berharga - bagikan lebih sering.",
        "Percayalah pada kemampuan untuk menciptakan perubahan yang berarti.",
        "Ingatlah mengapa perjalanan ini dimulai pada awalnya.",
        "Setiap hari menawarkan awal yang baru untuk memulai kembali.",
        "Ketahanan ini menginspirasi orang lain lebih dari yang Anda sadari.",
        "Luangkan waktu untuk merayakan kemenangan kecil di sepanjang jalan.",
        "Setiap tantangan yang dihadapi memperkuat karakter secara mendalam.",
        "Alam semesta mendukung jalan autentik ini sepenuhnya.",
        "Cahaya bersinar paling terang ketika keaslian memimpin jalan.",
        "Dunia membutuhkan kontribusi unik ini yang hanya Anda yang bisa berikan.",
        "Biarkan pekerjaan yang bermakna berbicara untuk dirinya sendiri tanpa penjelasan.",
        "Usaha yang konsisten bertambah seiring waktu menjadi kebesaran.",
        "Apa yang tampak mustahil hari ini akan menjadi kenyataan besok.",
        "Kekuatan di dalam melebihi tantangan apa pun di depan.",
        "Perjalanan ini menginspirasi orang lain lebih dari yang akan pernah diketahui.",
        "Hambatan hanyalah pengalihan ke jalan yang lebih baik ke depan.",
        "Kedalaman karakter terlihat paling jelas dalam momen-momen sulit.",
        "Pertumbuhan terjadi di luar zona nyaman, bukan di dalamnya.",
        "Bahkan kemajuan kecil layak dirayakan dan diakui.",
        "Tetap fokus pada 'mengapa' pribadi selama masa-masa sulit.",
        "Pilihan sehari-hari menciptakan warisan abadi yang layak diingat.",
        "Pelajaran yang dipelajari sekarang akan melayani selamanya dalam berbagai cara.",
        "Jangan pernah meremehkan dampak kebaikan pada orang lain.",
        "Suara autentik beresonansi dengan mereka yang perlu mendengarnya.",
        "Tantangan yang diatasi hari ini membangun kekuatan untuk ujian esok.",
        "Masa lalu tidak menentukan potensi masa depan atau kemungkinan.",
        "Setiap langkah maju, sekecil apa pun, menciptakan momentum.",
        "Pendekatan unik menjadi keunggulan kompetitif yang tidak dimiliki orang lain.",
        "Percayalah bahwa posisi saat ini adalah tepat di mana pertumbuhan perlu terjadi.",
        "Pencapaian terbesar sering kali mengikuti tantangan terbesar yang diatasi.",
        "Cerita ini terus ditulis dengan bab-bab luar biasa di depan.",
        "Alam semesta bersekongkol mendukung impian autentik yang dikejar.",
        "Sumber daya paling kuat tetap keyakinan diri yang tak tergoyahkan.",
        "Dampak pada orang lain menjangkau jauh melampaui apa yang dapat diukur.",
        "Keterbatasan saat ini bersifat sementara, sementara potensi tetap tak terbatas.",
        "Persetujuan paling penting berasal dari dalam, bukan dari luar.",
        "Intuisi berfungsi sebagai kompas batin yang menunjuk ke utara sejati.",
        "Disiplin hari ini menciptakan kebebasan dan peluang masa depan.",
        "Setiap pengalaman menambah kedalaman karakter dan kebijaksanaan.",
        "Tujuan hidup terungkap melalui kegembiraan dan kesulitan secara sama.",
        "Bagaimana kesulitan ditangani mengungkapkan kekuatan karakter yang sebenarnya.",
        "Keunikan menjadi keunggulan kompetitif terbesar dalam hidup.",
        "Izinkan evolusi pribadi seiring impian dan tujuan berkembang secara alami.",
        "Komitmen untuk tumbuh sudah mengubah hasil masa depan secara positif.",
        "Jangan pernah meremehkan seberapa jauh konsistensi dapat membawa tujuan yang layak.",
        "Tekad melebihi kemunduran sementara yang dihadapi.",
        "Jalan yang benar tidak selalu yang termudah, tetapi tetap paling berharga.",
        "Keberanian untuk memulai menginspirasi orang lain untuk memulai perjalanan mereka sendiri.",
        "Memilih pertumbuhan daripada kenyamanan memperluas potensi secara eksponensial.",
        "Potensi tertinggi menunggu tepat di luar tepi zona nyaman.",
        "Setiap tantangan mempersiapkan untuk sesuatu yang lebih besar di cakrawala."
      ];
      
      const professionMotivations = {
        "Musisi": [
          "Bakat musik membawa harmoni ke dunia yang kacau yang mencari kedamaian.",
          "Setiap nada yang dimainkan beresonansi dengan jiwa seseorang yang membutuhkan kenyamanan.",
          "Melodi ini memiliki kekuatan untuk menyembuhkan dan mengubah jiwa yang rusak.",
          "Ekspresi artistik mengungkapkan kebenaran universal yang tidak dapat disampaikan dengan kata-kata.",
          "Musik di dalam layak didengar oleh penonton yang menunggu."
        ],
        "Rapper": [
          "Kata-kata puitis melukiskan cerita-cerita kuat yang perlu diceritakan dengan berani.",
          "Aliran dan ritme ini menangkap emosi yang tidak dapat diungkapkan hanya dengan kata-kata.",
          "Lirik-lirik ini memberi suara pada pengalaman yang dirasakan banyak orang tetapi tidak dapat diartikulasikan.",
          "Suara autentik beresonansi dengan pencari kebenaran di setiap komunitas.",
          "Kepiawaian lirik membuka pikiran dan hati untuk perspektif baru."
        ],
        "Pemain Sepak Bola": [
          "Dedikasi di lapangan menginspirasi kerja tim melampaui permainan itu sendiri.",
          "Disiplin atletik diterjemahkan ke semua bidang kehidupan dengan mulus.",
          "Pemikiran strategis di lapangan menunjukkan kemampuan kepemimpinan alami.",
          "Gairah untuk permainan indah mengangkat mereka yang menonton dan bermain.",
          "Sportivitas menetapkan standar bagi orang lain untuk diikuti dan dihormati."
        ],
        "Pemain Basket": [
          "Visi lapangan diterjemahkan menjadi melihat peluang dalam semua permainan kehidupan.",
          "Tampil di bawah tekanan melayani dengan baik dalam setiap tantangan yang dihadapi.",
          "Mentalitas tim terlebih dahulu menciptakan kesuksesan dalam semua hubungan yang terbentuk.",
          "Lompatan vertikal cocok dengan ambisi untuk mencapai ketinggian baru yang mengesankan.",
          "Kerja keras defensif menunjukkan komitmen untuk keunggulan dalam segala hal."
        ],
        "Petinju": [
          "Ketangguhan mental mengesankan sebanyak kekuatan fisik yang ditampilkan.",
          "Disiplin latihan mencerminkan karakter dalam semua keadaan hidup.",
          "Menerima pukulan dan terus maju menjadi kekuatan super kehidupan.",
          "Gerakan kaki di ring mencerminkan kemampuan untuk menavigasi tantangan kehidupan.",
          "Semangat bertarung tidak pernah mundur dari tantangan yang layak dihadapi."
        ],
        "Pelajar": [
          "Keingintahuan membuka pintu ke kemungkinan dan penemuan tak terbatas.",
          "Komitmen untuk belajar melayani sepanjang banyak bab kehidupan.",
          "Perspektif segar membawa wawasan baru ke masalah lama yang membutuhkan solusi.",
          "Perjalanan pendidikan mempersiapkan untuk peluang yang belum terlihat.",
          "Disiplin akademik membangun kebiasaan yang memastikan kesuksesan seumur hidup."
        ],
        "Guru": [
          "Pengaruh meluas jauh melampaui dinding kelas ke masa depan yang tidak terlihat.",
          "Kesabaran memupuk potensi yang mungkin dilewatkan atau diabaikan oleh orang lain.",
          "Bimbingan membentuk masa depan dengan cara yang tidak pernah sepenuhnya dihargai atau diukur.",
          "Kebijaksanaan menanam benih yang bermekaran untuk generasi setelah pelajaran hari ini.",
          "Dedikasi terhadap pengetahuan menciptakan riak perubahan positif di mana-mana."
        ],
        "TikToker": [
          "Konten kreatif membawa kegembiraan dan koneksi dalam lanskap digital kita.",
          "Suara autentik menjangkau mereka yang membutuhkan pesan ini sekarang.",
          "Berkomunikasi secara ringkas menunjukkan penguasaan keterampilan yang langka dan berharga.",
          "Pengaruh budaya mengarah pada perubahan positif bagi pemirsa di seluruh dunia.",
          "Kehadiran digital membuat dampak dunia nyata melampaui batas layar."
        ],
        "Pengusaha": [
          "Pemikiran visioner menciptakan peluang di mana orang lain hanya melihat hambatan.",
          "Mengambil risiko yang diperhitungkan membedakan inovator sejati dari pengikut.",
          "Solusi inovatif memecahkan masalah pada akar penyebabnya secara efektif.",
          "Kepemimpinan menginspirasi orang lain untuk bergabung dalam misi bermakna yang layak dikejar.",
          "Ketekunan melalui tantangan mendefinisikan cerita sukses kewirausahaan."
        ],
        "Dokter": [
          "Tangan penyembuh membawa kenyamanan dalam kesusahan ketika pasien paling membutuhkannya.",
          "Komitmen terhadap perawatan kesehatan mengubah kehidupan setiap hari dengan cara yang mendalam.",
          "Pengetahuan medis yang dikombinasikan dengan empati menciptakan momen penyembuhan sejati.",
          "Dedikasi untuk perawatan pasien mencontohkan panggilan profesional tertinggi.",
          "Keterampilan diagnostik cocok dengan hati yang penuh kasih dalam keseimbangan sempurna."
        ],
        "Insinyur": [
          "Kemampuan pemecahan masalah menciptakan solusi yang memperbaiki kehidupan tak terhitung banyaknya.",
          "Keahlian teknis membangun fondasi untuk inovasi masa depan.",
          "Pikiran analitis melihat pola yang sama sekali dilewatkan orang lain dalam sistem yang kompleks.",
          "Presisi dan perhatian terhadap detail memastikan kualitas dalam setiap kreasi.",
          "Pendekatan inovatif terhadap tantangan memajukan seluruh bidang ke depan."
        ],
        "Pengembang Perangkat Lunak": [
          "Kode menciptakan kemungkinan yang tidak ada sebelum implementasi.",
          "Solusi teknis memecahkan masalah manusia nyata yang dihadapi masyarakat.",
          "Pemikiran logis berpadu indah dengan inovasi kreatif.",
          "Kreasi digital berdampak pada pengguna tak terhitung jumlahnya setiap hari di seluruh platform.",
          "Mempelajari teknologi baru mempertahankan posisi profesional terdepan."
        ],
        "Seniman": [
          "Visi kreatif menunjukkan kepada orang lain cara baru untuk melihat dunia yang akrab.",
          "Ekspresi artistik menyentuh emosi yang tidak dapat dijangkau kata-kata.",
          "Perspektif unik menambah keindahan pada pengalaman sehari-hari bagi pemirsa.",
          "Karya kreatif memicu percakapan penting melintasi batas.",
          "Keberanian artistik menginspirasi orang lain untuk mengekspresikan kebenaran mereka secara autentik."
        ],
        "Perawat": [
          "Perawatan yang penuh kasih menyembuhkan lebih dari sekedar penyakit fisik.",
          "Perhatian memperhatikan apa yang mungkin dilewatkan orang lain dalam perawatan pasien.",
          "Kehadiran yang tenang memberikan kenyamanan dalam momen perawatan kesehatan yang sulit.",
          "Dedikasi membuat perbedaan setiap shift bagi pasien yang tak terhitung jumlahnya.",
          "Keseimbangan keterampilan teknis dan kehangatan manusia terbukti sangat berharga."
        ],
        "Penulis": [
          "Kata-kata menciptakan dunia dalam pikiran pembaca yang menunggu untuk dijelajahi.",
          "Bercerita menghubungkan orang di seluruh pengalaman yang sangat berbeda.",
          "Kefasihan memberi suara pada apa yang orang lain sulit ungkapkan dengan jelas.",
          "Wawasan tertulis menawarkan perspektif baru tentang tantangan yang sudah dikenal.",
          "Kerajinan sastra melestarikan kebenaran penting untuk generasi mendatang."
        ],
        "Pengacara": [
          "Advokasi membawa keadilan bagi mereka yang membutuhkan suara dalam sistem yang kompleks.",
          "Pikiran analitis menavigasi tantangan hukum dengan presisi yang mengesankan.",
          "Komitmen terhadap prinsip-prinsip hukum memperkuat fondasi masyarakat.",
          "Argumen yang meyakinkan mengubah hasil bagi klien yang mencari keadilan.",
          "Pendekatan etis terhadap praktik hukum menetapkan standar bagi profesi."
        ],
        "Koki": [
          "Kreasi kuliner membawa kegembiraan melalui semua indera kepada pelanggan yang menghargai.",
          "Memasak menghubungkan orang di meja makan dan latar belakang budaya yang beragam.",
          "Kombinasi rasa menunjukkan intuisi artistik dan keterampilan teknis.",
          "Dedikasi terhadap bahan-bahan berkualitas menghormati tradisi dan inovasi.",
          "Kepemimpinan dapur mengeluarkan yang terbaik dalam seluruh tim kuliner."
        ],
        "Akuntan": [
          "Keahlian keuangan memberikan keamanan dan ketenangan pikiran kepada klien.",
          "Perhatian terhadap detail menangkap apa yang pasti akan dilewatkan orang lain.",
          "Keterampilan analitis membawa kejelasan pada situasi keuangan yang kompleks.",
          "Integritas profesional memastikan kepercayaan dalam semua hubungan bisnis.",
          "Kemampuan organisasi menciptakan keteraturan dari kompleksitas keuangan."
        ],
        "Desainer": [
          "Solusi visual menggabungkan keindahan dengan fungsi praktis tanpa cacat.",
          "Pemikiran desain mengubah pengalaman pengguna dengan cara yang bermakna.",
          "Sensibilitas estetika meningkatkan objek dan interaksi sehari-hari.",
          "Proses kreatif menyeimbangkan inovasi dengan kegunaan penting.",
          "Bahasa desain berkomunikasi melintasi hambatan secara efektif."
        ],
        "Polisi": [
          "Komitmen terhadap keselamatan publik membuat komunitas terbukti lebih kuat.",
          "Keberanian dalam situasi yang menantang melindungi warga yang rentan.",
          "Pengambilan keputusan cepat di bawah tekanan menunjukkan ketenangan yang luar biasa.",
          "Dedikasi terhadap keadilan membimbing perilaku profesional secara konsisten.",
          "Kehadiran membawa keamanan ke situasi tegang yang membutuhkan intervensi."
        ],
        "Pemadam Kebakaran": [
          "Keberanian dalam situasi berbahaya menyelamatkan nyawa dan properti berharga.",
          "Pemikiran cepat di bawah tekanan ekstrem menunjukkan keterampilan luar biasa.",
          "Persiapan fisik dan mental memungkinkan respon darurat yang heroik.",
          "Kerja tim dalam situasi krisis mencontohkan kerja sama manusia.",
          "Komitmen terhadap keselamatan masyarakat melampaui situasi darurat."
        ],
        "Personel Militer": [
          "Pelayanan menunjukkan komitmen tertinggi untuk melindungi orang lain.",
          "Disiplin dalam kondisi yang menantang menetapkan standar luar biasa.",
          "Pemikiran strategis menyeimbangkan tujuan misi dengan keselamatan tim.",
          "Kemampuan beradaptasi dengan situasi yang berubah memastikan keberhasilan misi secara konsisten.",
          "Kesetiaan kepada unit menciptakan ikatan yang melampaui persahabatan biasa."
        ],
        "Jurnalis": [
          "Pengejaran kebenaran membawa kejelasan di masa-masa yang membingungkan dan kompleks.",
          "Bercerita membantu audiens memahami masalah penting yang kompleks.",
          "Keterampilan investigasi mengungkap apa yang sangat membutuhkan visibilitas.",
          "Komitmen terhadap fakta menyeimbangkan ekosistem informasi secara bertanggung jawab.",
          "Suara jurnalistik menambahkan perspektif penting pada wacana publik."
        ],
        "Psikolog": [
          "Mendengarkan dengan empati menciptakan ruang aman untuk penyembuhan yang diperlukan.",
          "Wawasan membantu klien menavigasi lanskap batin mereka secara efektif.",
          "Pendekatan terapeutik menyeimbangkan kasih sayang dengan praktik berbasis bukti.",
          "Bimbingan yang sabar memungkinkan orang lain menemukan solusi mereka sendiri.",
          "Batasan profesional memungkinkan hubungan penyembuhan yang berkelanjutan."
        ],
        "Guru": [
          "Bimbingan membentuk masa depan melampaui apa yang dapat segera dilihat.",
          "Kesabaran dengan proses belajar memungkinkan pertumbuhan berkembang secara alami.",
          "Kemampuan untuk menjelaskan konsep kompleks membuat pengetahuan dapat diakses.",
          "Manajemen kelas menciptakan ruang aman untuk eksplorasi intelektual.",
          "Pengakuan terhadap gaya belajar yang berbeda menjangkau setiap siswa secara unik."
        ],
        "Programmer": [
          "Keterampilan coding mengubah ide-ide abstrak menjadi kenyataan fungsional.",
          "Pendekatan pemecahan masalah memecah tantangan kompleks menjadi bagian-bagian yang dapat dikelola.",
          "Perhatian terhadap detail mencegah komplikasi masa depan dalam kode yang canggih.",
          "Pembelajaran berkelanjutan menjaga keterampilan tetap relevan di bidang yang berubah dengan cepat.",
          "Kreativitas teknis menemukan solusi elegan untuk masalah sulit."
        ]
      };
      
      const monthTraits = [
        "Kelahiran Januari memberikan kualitas kepemimpinan alami dan fokus yang teguh.",
        "Kelahiran Februari memberkati dengan pemahaman intuitif dan visi kemanusiaan.",
        "Kelahiran Maret memberikan kreativitas imajinatif dan ketahanan yang adaptif.",
        "Kelahiran April memberikan ketekunan yang teguh dan inisiatif yang berani.",
        "Kelahiran Mei memberikan keterampilan komunikasi yang persuasif dan sensibilitas praktis.",
        "Kelahiran Juni menawarkan keserbagunaan yang adaptif dan kecerdasan emosional.",
        "Kelahiran Juli memberikan empati yang penuh kasih dan naluri pengasuhan yang protektif.",
        "Kelahiran Agustus memberkati dengan karisma magnetik dan kepercayaan diri yang murah hati.",
        "Kelahiran September memberikan presisi analitis dan organisasi metodis.",
        "Kelahiran Oktober memberikan perspektif seimbang dan harmoni diplomatik.",
        "Kelahiran November memberikan wawasan yang tajam dan intensitas transformatif.",
        "Kelahiran Desember menawarkan optimisme visioner dan kebijaksanaan filosofis."
      ];
      
      let selectedTrait;
      
      if (profession && professionMotivations[profession] && Math.random() < 0.25) {
        const profMotivations = professionMotivations[profession];
        selectedTrait = profMotivations[Math.floor(Math.random() * profMotivations.length)];
      } 
      else if (dob && Math.random() < 0.2) {
        selectedTrait = monthTraits[month];
      }
      else {
        selectedTrait = lifeTraits[Math.floor(Math.random() * lifeTraits.length)];
      }
      
      const encourageIndex = Math.floor(Math.random() * lifeEncouragements.length);
      
      return selectedTrait + " " + lifeEncouragements[encourageIndex];
    }

    function generateFlowerCode() {
      const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      let code = '';
      for (let i = 0; i < 8; i++) {
        const randomIndex = Math.floor(Math.random() * characters.length);
        code += characters.charAt(randomIndex);
      }
      return code;
    }

    function getRandomSubject() {
      let availableSubjects = Object.keys(subjectDictionary).filter(subject => !seenSubjects.includes(subject));
      
      if (availableSubjects.length === 0) {
        seenSubjects = [];
        availableSubjects = Object.keys(subjectDictionary);
      }
      
      const randomIndex = Math.floor(Math.random() * availableSubjects.length);
      const selectedSubject = availableSubjects[randomIndex];
      
      seenSubjects.push(selectedSubject);
      
      return selectedSubject;
    }

    function updateFlowerDisplay() {
      const flowerCodeElement = document.getElementById('flowerCodeDisplay');
      const motivationElement = document.getElementById('monthlyMotivation');
      
      if (!flowerCodeElement || !motivationElement) {
        console.error("Required elements not found in the DOM");
        return;
      }
      
      let subject = localStorage.getItem('flowerSubject');
      if (!subject) {
        subject = getRandomSubject();
        localStorage.setItem('flowerSubject', subject);
      }
      
      const formattedName = formatUserName(userFullName);
      
      if (formattedName) {
        flowerCodeElement.innerHTML = `Bunga Saya - ${subjectDictionary[subject] || subject} / ${formattedName}`;
      } else {
        flowerCodeElement.textContent = "Bunga Saya - " + (subjectDictionary[subject] || subject);
      }
      
      if (!currentMotivation) {
        currentMotivation = generatePersonalizedMotivation(userFlowerCode, userProfession, userDateOfBirth);
      }
      
      motivationElement.textContent = currentMotivation;
      
      const captureCode = document.getElementById('captureFlowerCode');
      const captureMotivation = document.getElementById('captureFlowerMotivation');
      
      if (captureCode) {
        if (formattedName) {
          captureCode.innerHTML = `Bunga Saya - ${subjectDictionary[subject] || subject} / ${formattedName}`;
        } else {
          captureCode.textContent = "Bunga Saya - " + (subjectDictionary[subject] || subject);
        }
      }
      
      if (captureMotivation) captureMotivation.textContent = currentMotivation;
      
      return currentMotivation;
    }

    function setCookie(name, value, days) {
      let expires = "";
      if (days) {
        const date = new Date();
        date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
        expires = "; expires=" + date.toUTCString();
      }
      document.cookie = name + "=" + (value || "") + expires + "; path=/; SameSite=Lax";
    }

    function getCookie(name) {
      const nameEQ = name + "=";
      const ca = document.cookie.split(';');
      for (let i = 0; i < ca.length; i++) {
        let c = ca[i];
        while (c.charAt(0) === ' ') c = c.substring(1, c.length);
        if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
      }
      return null;
    }

    function removeCookie(name) {
      document.cookie = name + "=; Max-Age=-99999999; path=/";
    }

    function setTheme(theme) {
      document.body.classList.remove('theme-default', 'theme-red-black', 'theme-green-blue', 'theme-orange-pink', 'theme-yellow-purple');
      
      document.body.classList.add('theme-' + theme);
      
      currentTheme = theme;
      
      localStorage.setItem('preferredTheme', theme);
      setCookie('preferredTheme', theme, 365);
      
      const options = document.querySelectorAll('.style-option');
      options.forEach(option => {
        option.classList.remove('selected');
        if (option.dataset.theme === theme) {
          option.classList.add('selected');
        }
      });
      
      updateCaptureStyles(theme);
      
      let themeColor = '#1A2E4D';
      switch(theme) {
        case 'red-black':
          themeColor = '#000000';
          break;
        case 'green-blue':
          themeColor = '#1A2E4D';
          break;
        case 'orange-pink':
        case 'yellow-purple':
          themeColor = '#4B0082';
          break;
        case 'default':
          themeColor = '#FFFFFF';
          break;
      }
      
      document.querySelector('meta[name="theme-color"]').setAttribute('content', themeColor);
      document.querySelector('meta[name="apple-mobile-web-app-status-bar-style"]').setAttribute('content', theme === 'default' ? 'default' : 'black-translucent');
    }
    
    function updateCaptureStyles(theme) {
      const captureContainer = document.getElementById('flowerCaptureContainer');
      const captureCode = document.getElementById('captureFlowerCode');
      const captureHeader = document.getElementById('captureFlowerHeader');
      const captureWebsiteUrl = document.querySelector('.capture-website-url');
      const captureLogo = document.querySelector('.gz-logo');
      const captureMotivation = document.getElementById('captureFlowerMotivation');
      
      if (!captureContainer || !captureCode || !captureHeader || !captureWebsiteUrl || 
          !captureLogo || !captureMotivation) {
        console.error("One or more capture elements not found");
        return;
      }
      
      captureContainer.style.borderColor = '';
      captureCode.style.borderColor = '';
      captureCode.style.color = '';
      captureCode.style.backgroundColor = '';
      captureHeader.style.color = '';
      captureWebsiteUrl.style.color = '';
      captureLogo.style.color = '';
      captureLogo.style.borderColor = '';
      captureMotivation.style.color = '';
      captureMotivation.style.backgroundColor = '';
      captureMotivation.style.borderColor = '';
      
      switch(theme) {
        case 'red-black':
          captureContainer.style.borderColor = '#8B0000';
          captureContainer.style.backgroundColor = 'black';
          captureCode.style.borderColor = '#FF4500';
          captureCode.style.color = '#FF4500';
          captureCode.style.backgroundColor = 'black';
          captureHeader.style.color = '#FF4500';
          captureWebsiteUrl.style.color = '#FF4500';
          captureLogo.style.color = '#FF4500';
          captureLogo.style.borderColor = '#FF4500';
          captureMotivation.style.color = '#E5E5E5';
          captureMotivation.style.backgroundColor = 'black';
          captureMotivation.style.borderColor = '#FF4500';
          break;
          
        case 'green-blue':
          captureContainer.style.borderColor = '#3EB489';
          captureContainer.style.backgroundColor = '#1A2E4D';
          captureCode.style.borderColor = '#3EB489';
          captureCode.style.color = '#3EB489';
          captureCode.style.backgroundColor = '#36454F';
          captureHeader.style.color = '#3EB489';
          captureWebsiteUrl.style.color = '#3EB489';
          captureLogo.style.color = '#3EB489';
          captureLogo.style.borderColor = '#3EB489';
          captureMotivation.style.color = '#F5F5F5';
          captureMotivation.style.backgroundColor = '#1A2E4D';
          captureMotivation.style.borderColor = '#3EB489';
          break;
          
        case 'orange-pink':
          captureContainer.style.borderColor = '#FF7F50';
          captureContainer.style.backgroundColor = '#4B0082';
          captureCode.style.borderColor = '#FF7F50';
          captureCode.style.color = '#FF7F50';
          captureCode.style.backgroundColor = '#6A0DAD';
          captureHeader.style.color = '#FF7F50';
          captureWebsiteUrl.style.color = '#FF7F50';
          captureLogo.style.color = '#FF7F50';
          captureLogo.style.borderColor = '#FF7F50';
          captureMotivation.style.color = '#FFFFFF';
          captureMotivation.style.backgroundColor = '#4B0082';
          captureMotivation.style.borderColor = '#FF7F50';
          break;
          
        case 'yellow-purple':
          captureContainer.style.borderColor = '#FFD700';
          captureContainer.style.backgroundColor = '#4B0082';
          captureCode.style.borderColor = '#FFD700';
          captureCode.style.color = '#FFD700';
          captureCode.style.backgroundColor = '#6A0DAD';
          captureHeader.style.color = '#FFD700';
          captureWebsiteUrl.style.color = '#FFD700';
          captureLogo.style.color = '#FFD700';
          captureLogo.style.borderColor = '#FFD700';
          captureMotivation.style.color = '#FFFFFF';
          captureMotivation.style.backgroundColor = '#4B0082';
          captureMotivation.style.borderColor = '#FFD700';
          break;
          
        default:
          captureContainer.style.borderColor = '#007bff';
          captureContainer.style.backgroundColor = 'white';
          captureCode.style.borderColor = '#ff69b4';
          captureCode.style.color = '#ff69b4';
          captureCode.style.backgroundColor = '#fff0f8';
          captureHeader.style.color = '#007bff';
          captureWebsiteUrl.style.color = '#007bff';
          captureLogo.style.color = '#007bff';
          captureLogo.style.borderColor = '#007bff';
          captureMotivation.style.color = '#333';
          captureMotivation.style.backgroundColor = 'white';
          captureMotivation.style.borderColor = '#ff69b4';
      }
    }

    function authenticateAnonymously() {
      return new Promise((resolve, reject) => {
        auth.signInAnonymously()
          .then((userCredential) => {
            console.log("User authenticated anonymously:", userCredential.user.uid);
            userUid = userCredential.user.uid;
            isAuthenticated = true;
            resolve(userCredential.user);
          })
          .catch((error) => {
            console.error("Authentication error:", error);
            reject(error);
          });
      });
    }

    auth.onAuthStateChanged((user) => {
      if (user) {
        userUid = user.uid;
        isAuthenticated = true;
        console.log("Auth state changed: user is signed in", user.uid);
      } else {
        isAuthenticated = false;
        console.log("Auth state changed: user is signed out");
      }
    });

    async function submitToFirebase() {
      try {
        if (!isAuthenticated) {
          console.log("User not authenticated, authenticating now...");
          await authenticateAnonymously();
        }
        
        const location = await detectUserLocation();
        
        const userData = {
          date: new Date().toISOString(),
          country: location.country || "Unknown",
          city: location.city || "Unknown",
          uid: userUid,
          uniqueId: userUniqueId,
          flowerCode: userFlowerCode,
          motivation: currentMotivation,
          dateOfBirth: userDateOfBirth,
          profession: userProfession,
          fullName: userFullName,
          formattedName: formatUserName(userFullName),
          timestamp: Date.now(),
          theme: currentTheme,
          subject: localStorage.getItem('flowerSubject') || getRandomSubject(),
          shareCount: shareCount
        };

        console.log("Submitting data to Firebase:", userData);
        
        try {
          const newEntryRef = database.ref('birthdates').push(userData);
          console.log("Data submitted to Realtime Database:", newEntryRef.key);
        } catch (dbError) {
          console.error("Error with Realtime Database:", dbError);
        }
        
        try {
          const docRef = await firestore.collection('flowers').add(userData);
          console.log("Document written to Firestore with ID: ", docRef.id);
        } catch (firestoreError) {
          console.error("Error adding document to Firestore: ", firestoreError);
        }
        
        try {
          await firestore.collection('flowerCodes').doc(userUniqueId).set({
            ...userData,
            createdAt: new Date()
          });
          console.log("Flower code added to specific collection");
        } catch (codeError) {
          console.error("Error adding flower code to collection: ", codeError);
        }
        
        localStorage.setItem('userFlowerData', JSON.stringify(userData));
        localStorage.setItem('isInstalled', 'true');
        setCookie('userUniqueId', userUniqueId, 365);
        setCookie('userFlowerCode', userFlowerCode, 365);
        setCookie('userDateOfBirth', userDateOfBirth, 365);
        setCookie('userProfession', userProfession, 365);
        setCookie('userFullName', userFullName, 365);
        setCookie('isInstalled', 'true', 365);
        isInstalled = true;
        
        return true;
      } catch (error) {
        console.error("Firebase submission error:", error);
        const userData = {
          date: new Date().toISOString(),
          uniqueId: userUniqueId,
          flowerCode: userFlowerCode,
          motivation: currentMotivation,
          dateOfBirth: userDateOfBirth,
          profession: userProfession,
          fullName: userFullName,
          formattedName: formatUserName(userFullName),
          timestamp: Date.now(),
          theme: currentTheme,
          subject: localStorage.getItem('flowerSubject') || getRandomSubject(),
          shareCount: 0
        };
        
        localStorage.setItem('userFlowerData', JSON.stringify(userData));
        localStorage.setItem('isInstalled', 'true');
        setCookie('userUniqueId', userUniqueId, 365);
        setCookie('userFlowerCode', userFlowerCode, 365);
        setCookie('userDateOfBirth', userDateOfBirth, 365);
        setCookie('userProfession', userProfession, 365);
        setCookie('userFullName', userFullName, 365);
        setCookie('isInstalled', 'true', 365);
        isInstalled = true;
        
        return true;
      }
    }

    async function updateShareCount() {
      if (!isAuthenticated || !userUniqueId) return;
      
      try {
        shareCount++;
        
        const savedData = localStorage.getItem('userFlowerData');
        if (savedData) {
          const userData = JSON.parse(savedData);
          userData.shareCount = shareCount;
          localStorage.setItem('userFlowerData', JSON.stringify(userData));
        }
        
        await firestore.collection('flowerCodes').doc(userUniqueId).set({
          shareCount: shareCount,
          lastShared: new Date().toISOString(),
          country: currentCountry || "Unknown",
          city: userCity || "Unknown",
          uid: userUid,
          uniqueId: userUniqueId
        }, { merge: true });
        
        console.log("Share count updated:", shareCount);
      } catch (error) {
        console.error("Error updating share count:", error);
      }
    }

    function checkSavedUserData() {
      const cookieUniqueId = getCookie('userUniqueId');
      const cookieFlowerCode = getCookie('userFlowerCode');
      const cookieInstalled = getCookie('isInstalled');
      const cookieDOB = getCookie('userDateOfBirth');
      const cookieProfession = getCookie('userProfession');
      const cookieFullName = getCookie('userFullName');
      
      if (cookieUniqueId && cookieFlowerCode) {
        userUniqueId = cookieUniqueId;
        userFlowerCode = cookieFlowerCode;
        userDateOfBirth = cookieDOB || null;
        userProfession = cookieProfession || null;
        userFullName = cookieFullName || null;
        isInstalled = cookieInstalled === 'true';
        
        currentMotivation = generatePersonalizedMotivation(userFlowerCode, userProfession, userDateOfBirth);
        
        console.log("Found saved user data in cookies:", { userUniqueId, userFlowerCode, userDateOfBirth, userProfession, userFullName });
        return true;
      }
      
      const savedData = localStorage.getItem('userFlowerData');
      if (savedData) {
        try {
          const userData = JSON.parse(savedData);
          userUniqueId = userData.uniqueId;
          userFlowerCode = userData.flowerCode;
          userDateOfBirth = userData.dateOfBirth || null;
          userProfession = userData.profession || null;
          userFullName = userData.fullName || null;
          shareCount = userData.shareCount || 0;
          currentMotivation = userData.motivation || generatePersonalizedMotivation(userData.flowerCode, userData.profession, userData.dateOfBirth);
          userUid = userData.uid;
          isInstalled = localStorage.getItem('isInstalled') === 'true';
          
          setCookie('userUniqueId', userUniqueId, 365);
          setCookie('userFlowerCode', userFlowerCode, 365);
          setCookie('userDateOfBirth', userDateOfBirth, 365);
          setCookie('userProfession', userProfession, 365);
          setCookie('userFullName', userFullName, 365);
          setCookie('isInstalled', 'true', 365);
          
          console.log("Found saved user data in localStorage:", userData);
          return true;
        } catch (e) {
          console.error("Error parsing saved user data:", e);
          return false;
        }
      }
      return false;
    }

    async function deleteUserAccount() {
      if (!userUniqueId) return false;
      
      try {
        if (!confirm("Apakah Anda yakin ingin menghapus SEMUA data Anda? Tindakan ini tidak dapat diubah.")) {
          return false;
        }
        
        console.log("Suppression du compte utilisateur:", userUniqueId);
        
        try {
          await firestore.collection('flowerCodes').doc(userUniqueId).delete();
          console.log("Données supprimées de la collection flowerCodes");
        } catch (error) {
          console.error("Erreur lors de la suppression de flowerCodes:", error);
        }
        
        try {
          const flowersQuery = await firestore.collection('flowers').where('uniqueId', '==', userUniqueId).get();
          
          const batch = firestore.batch();
          let count = 0;
          
          flowersQuery.forEach((doc) => {
            batch.delete(doc.ref);
            count++;
          });
          
          if (count > 0) {
            await batch.commit();
            console.log(`${count} documents supprimés de la collection flowers`);
          }
        } catch (error) {
          console.error("Erreur lors de la suppression de flowers:", error);
        }
        
        try {
          const birthdatesRef = database.ref('birthdates');
          const query = birthdatesRef.orderByChild('uniqueId').equalTo(userUniqueId);
          
          query.once('value', (snapshot) => {
            snapshot.forEach((childSnapshot) => {
              birthdatesRef.child(childSnapshot.key).remove();
            });
          });
          
          console.log("Données supprimées de la base de données en temps réel");
        } catch (error) {
          console.error("Erreur lors de la suppression de la base de données en temps réel:", error);
        }
        
        localStorage.removeItem('userFlowerData');
        localStorage.removeItem('isInstalled');
        localStorage.removeItem('flowerSubject');
        localStorage.removeItem('preferredTheme');
        
        removeCookie('userUniqueId');
        removeCookie('userFlowerCode');
        removeCookie('isInstalled');
        removeCookie('userDateOfBirth');
        removeCookie('userProfession');
        removeCookie('userFullName');
        removeCookie('preferredTheme');
        
        userUniqueId = null;
        userFlowerCode = null;
        currentMotivation = null;
        userDateOfBirth = null;
        userProfession = null;
        userFullName = null;
        isInstalled = false;
        seenSubjects = [];
        shareCount = 0;
        
        try {
          if (auth.currentUser) {
            await auth.currentUser.delete();
            console.log("Utilisateur Firebase supprimé");
          }
        } catch (authError) {
          console.error("Erreur lors de la suppression de l'authentification:", authError);
        }
        
        console.log("Compte utilisateur complètement supprimé");
        return true;
      } catch (error) {
        console.error("Erreur lors de la suppression du compte:", error);
        return false;
      }
    }
    
    function createWebAppManifest() {
      const manifestData = {
        name: "G-Z Flower",
        short_name: "G-Z",
        description: "Temukan Bunga Kehidupan unik Anda",
        start_url: window.location.href,
        display: "standalone",
        background_color: "#1A2E4D",
        theme_color: "#1A2E4D",
        icons: [
          {
            src: "https://firebasestorage.googleapis.com/v0/b/genz-abb36.firebasestorage.app/o/IMG_20250723_083736_652.webp?alt=media&token=0919c124-8818-4376-854c-7e95719e6e76",
            sizes: "192x192",
            type: "image/webp"
          },
          {
            src: "https://firebasestorage.googleapis.com/v0/b/genz-abb36.firebasestorage.app/o/IMG_20250723_083736_652.webp?alt=media&token=0919c124-8818-4376-854c-7e95719e6e76",
            sizes: "512x512",
            type: "image/webp"
          }
        ]
      };
      
      const manifestStr = JSON.stringify(manifestData);
      const manifestBlob = new Blob([manifestStr], {type: 'application/json'});
      const manifestURL = URL.createObjectURL(manifestBlob);
      
      const manifestLink = document.getElementById('manifest-placeholder');
      manifestLink.setAttribute('href', manifestURL);
      manifestLink.setAttribute('rel', 'manifest');
    }
    
    function setupInstallPrompt() {
      window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        
        const isInstallPromptShownBefore = localStorage.getItem('installPromptShown');
        if (!isInstallPromptShownBefore) {
          setTimeout(() => {
            document.getElementById('installPrompt').style.display = 'block';
          }, 3000);
        }
      });
      
      document.getElementById('installBtn').addEventListener('click', async () => {
        if (!deferredPrompt) {
          window.location.href = "https://g-z.online/install.html";
          return;
        }
        
        deferredPrompt.prompt();
        const choiceResult = await deferredPrompt.userChoice;
        
        if (choiceResult.outcome === 'accepted') {
          console.log('User accepted the install prompt');
        } else {
          console.log('User dismissed the install prompt');
        }
        
        deferredPrompt = null;
        document.getElementById('installPrompt').style.display = 'none';
        localStorage.setItem('installPromptShown', 'true');
      });
      
      document.getElementById('dismissBtn').addEventListener('click', () => {
        document.getElementById('installPrompt').style.display = 'none';
        localStorage.setItem('installPromptShown', 'true');
      });
      
      window.addEventListener('appinstalled', (evt) => {
        console.log('App was installed');
        document.getElementById('installPrompt').style.display = 'none';
      });
    }

    window.addEventListener('load', async () => {
      createWebAppManifest();
      setupInstallPrompt();
      
      const today = new Date();
      const twoYearsAgo = new Date(today.getFullYear() - 5, today.getMonth(), today.getDate());
      document.getElementById('dobInput').max = twoYearsAgo.toISOString().split('T')[0];
      
      const savedTheme = localStorage.getItem('preferredTheme') || getCookie('preferredTheme');
      if (savedTheme) {
        setTheme(savedTheme);
      } else {
        setTheme('green-blue');
      }
      
      if (checkSavedUserData()) {
        console.log("User already has data, hiding welcome modal");
        const welcomeToast = document.getElementById('welcomeToast');
        welcomeToast.style.display = 'block';
        setTimeout(() => {
          welcomeToast.style.opacity = '1';
        }, 100);
        setTimeout(() => {
          welcomeToast.style.opacity = '0';
          setTimeout(() => {
            welcomeToast.style.display = 'none';
          }, 500);
        }, 6500);
        
        if (!isAuthenticated) {
          try {
            await authenticateAnonymously();
          } catch (error) {
            console.error("Error during authentication:", error);
          }
        }
      } else {
        console.log("No saved user data found, showing welcome modal");
        const welcomeModal = document.getElementById('welcomeModal');
        welcomeModal.style.display = 'block';
        setTimeout(() => {
          welcomeModal.classList.add('show');
        }, 100);
      }
      
      setupProfessionDropdown();
    });

    function setupProfessionDropdown() {
      const professionInput = document.getElementById('professionInput');
      const professionDropdown = document.getElementById('professionDropdown');
      
      if (!professionInput || !professionDropdown) {
        console.error("Profession dropdown elements not found");
        return;
      }
      
      function filterProfessions(input) {
        if (!input) return [];
        
        input = input.toLowerCase();
        return professions.filter(profession => 
          profession.toLowerCase().includes(input)
        );
      }
      
      function renderDropdownOptions(filteredProfessions) {
        professionDropdown.innerHTML = '';
        
        if (filteredProfessions.length === 0) {
          const option = document.createElement('div');
          option.className = 'profession-option';
          option.textContent = 'Tidak ada yang cocok';
          professionDropdown.appendChild(option);
        } else {
          filteredProfessions.forEach(profession => {
            const option = document.createElement('div');
            option.className = 'profession-option';
            option.textContent = profession;
            option.addEventListener('click', () => {
              professionInput.value = profession;
              professionDropdown.style.display = 'none';
            });
            professionDropdown.appendChild(option);
          });
        }
      }
      
      professionInput.addEventListener('input', () => {
        const filtered = filterProfessions(professionInput.value);
        renderDropdownOptions(filtered);
        
        if (filtered.length > 0) {
          professionDropdown.style.display = 'block';
        } else {
          professionDropdown.style.display = 'none';
        }
      });
      
      professionInput.addEventListener('focus', () => {
        if (professionInput.value) {
          const filtered = filterProfessions(professionInput.value);
          renderDropdownOptions(filtered);
          professionDropdown.style.display = 'block';
        }
      });
      
      document.addEventListener('click', (e) => {
        if (!professionInput.contains(e.target) && !professionDropdown.contains(e.target)) {
          professionDropdown.style.display = 'none';
        }
      });
    }

    document.getElementById('flowerButton').addEventListener('click', function() {
      if (!userUniqueId) {
        alert("Silakan buat akun bunga Anda terlebih dahulu.");
        return;
      }
      
      updateFlowerDisplay();
      const flowerModal = document.getElementById('flowerModal');
      flowerModal.style.display = 'block';
      setTimeout(() => {
        flowerModal.classList.add('show');
      }, 10);
      document.getElementById('shareFlowerButton').style.display = 'flex';
    });

    document.getElementById('shareFlowerButton').addEventListener('click', function() {
      captureFlower();
    });
    
    document.getElementById('showIdButton').addEventListener('click', function() {
      if (userUniqueId) {
        document.getElementById('userIdDisplay').textContent = userUniqueId;
        const idModal = document.getElementById('idModal');
        idModal.style.display = 'block';
        setTimeout(() => {
          idModal.classList.add('show');
        }, 10);
      } else {
        alert("Silakan buat akun bunga Anda terlebih dahulu untuk mendapatkan ID unik Anda.");
      }
    });
    
    document.getElementById('copyIdButton').addEventListener('click', function() {
      const idText = document.getElementById('userIdDisplay').textContent;
      navigator.clipboard.writeText(idText).then(function() {
        alert('ID disalin ke clipboard!');
      }).catch(function() {
        alert('Tidak dapat menyalin ID. Silakan pilih dan salin secara manual.');
      });
    });
    
    document.getElementById('closeIdModal').addEventListener('click', function() {
      const idModal = document.getElementById('idModal');
      idModal.classList.remove('show');
      setTimeout(() => {
        idModal.style.display = 'none';
      }, 300);
    });
    
    document.getElementById('deleteAccountButton').addEventListener('click', function() {
      deleteUserAccount().then(success => {
        if (success) {
          alert("Akun berhasil dihapus. Anda harus membuat akun baru untuk menggunakan aplikasi ini.");
          const idModal = document.getElementById('idModal');
          idModal.classList.remove('show');
          setTimeout(() => {
            idModal.style.display = 'none';
            const welcomeModal = document.getElementById('welcomeModal');
            welcomeModal.style.display = 'block';
            setTimeout(() => {
              welcomeModal.classList.add('show');
            }, 100);
          }, 300);
        } else {
          alert("Kesalahan, coba lagi nanti");
        }
      });
    });
    
    document.getElementById('refreshMotivation').addEventListener('click', function() {
      const newMotivation = generatePersonalizedMotivation(userFlowerCode, userProfession, userDateOfBirth);
      currentMotivation = newMotivation;
      
      const newSubject = getRandomSubject();
      localStorage.setItem('flowerSubject', newSubject);
      
      const formattedName = formatUserName(userFullName);
      
      const flowerCodeElement = document.getElementById('flowerCodeDisplay');
      if (formattedName) {
        flowerCodeElement.innerHTML = `Bunga Saya - ${subjectDictionary[newSubject] || newSubject} / ${formattedName}`;
      } else {
        flowerCodeElement.textContent = "Bunga Saya - " + (subjectDictionary[newSubject] || newSubject);
      }
      
      document.getElementById('monthlyMotivation').textContent = newMotivation;
      
      const captureCode = document.getElementById('captureFlowerCode');
      const captureMotivation = document.getElementById('captureFlowerMotivation');
      
      if (captureCode) {
        if (formattedName) {
          captureCode.innerHTML = `Bunga Saya - ${subjectDictionary[newSubject] || newSubject} / ${formattedName}`;
        } else {
          captureCode.textContent = "Bunga Saya - " + (subjectDictionary[newSubject] || newSubject);
        }
      }
      
      if (captureMotivation) captureMotivation.textContent = newMotivation;
      
      this.style.transition = 'transform 0.5s ease';
      this.style.transform = 'rotate(360deg)';
      
      setTimeout(() => {
        this.style.transition = 'none';
        this.style.transform = 'rotate(0deg)';
      }, 500);
    });
    
    document.getElementById('createAccountButton').addEventListener('click', async function() {
      const dobInput = document.getElementById('dobInput');
      const professionInput = document.getElementById('professionInput');
      const fullNameInput = document.getElementById('fullNameInput');
      
      if (!fullNameInput.value) {
        alert("Silakan masukkan nama lengkap Anda.");
        return;
      }
      
      if (!dobInput.value) {
        alert("Silakan masukkan tanggal lahir Anda.");
        return;
      }
      
      if (!professionInput.value) {
        alert("Silakan masukkan profesi Anda.");
        return;
      }
      
      document.getElementById('loadingSpinner').style.display = 'block';
      document.getElementById('createAccountButton').disabled = true;
      
      try {
        await authenticateAnonymously();
        
        userFullName = fullNameInput.value;
        userDateOfBirth = dobInput.value;
        userProfession = professionInput.value;
        
        userUniqueId = generateUniqueId();
        console.log("Generated unique ID:", userUniqueId);
        
        userFlowerCode = generateFlowerCode();
        
        const subject = getRandomSubject();
        localStorage.setItem('flowerSubject', subject);
        
        currentMotivation = generatePersonalizedMotivation(userFlowerCode, userProfession, userDateOfBirth);
        
        const createButton = document.getElementById('createAccountButton');
        createButton.innerHTML = '<i class="fas fa-check"></i> Selesai';
        createButton.style.backgroundColor = '#4CAF50';
        
        const userData = {
          date: new Date().toISOString(),
          uid: userUid,
          uniqueId: userUniqueId,
          flowerCode: userFlowerCode,
          motivation: currentMotivation,
          dateOfBirth: userDateOfBirth,
          profession: userProfession,
          fullName: userFullName,
          formattedName: formatUserName(userFullName),
          timestamp: Date.now(),
          theme: currentTheme,
          subject: subject,
          shareCount: 0
        };
        
        localStorage.setItem('userFlowerData', JSON.stringify(userData));
        localStorage.setItem('isInstalled', 'true');
        setCookie('userUniqueId', userUniqueId, 365);
        setCookie('userFlowerCode', userFlowerCode, 365);
        setCookie('userDateOfBirth', userDateOfBirth, 365);
        setCookie('userProfession', userProfession, 365);
        setCookie('userFullName', userFullName, 365);
        setCookie('isInstalled', 'true', 365);
        isInstalled = true;
        
        setTimeout(() => {
          const welcomeModal = document.getElementById('welcomeModal');
          welcomeModal.classList.remove('show');
          
          setTimeout(() => {
            welcomeModal.style.display = 'none';
            document.getElementById('loadingSpinner').style.display = 'none';
            createButton.innerHTML = 'Buat Akun';
            createButton.style.backgroundColor = '';
            createButton.disabled = false;
            
            submitToFirebase().then(submitted => {
              console.log("Firebase submission result:", submitted);
              
              const welcomeToast = document.getElementById('welcomeToast');
              welcomeToast.style.display = 'block';
              setTimeout(() => {
                welcomeToast.style.opacity = '1';
              }, 100);
              setTimeout(() => {
                welcomeToast.style.opacity = '0';
                setTimeout(() => {
                  welcomeToast.style.display = 'none';
                }, 500);
              }, 2000);
              
              updateFlowerDisplay();
              const flowerModal = document.getElementById('flowerModal');
              flowerModal.style.display = 'block';
              setTimeout(() => {
                flowerModal.classList.add('show');
              }, 10);
              document.getElementById('shareFlowerButton').style.display = 'flex';
            });
          }, 300);
        }, 2000);
        
        console.log("Setup complete and data stored locally and in cookies");
      } catch (error) {
        console.error("Error during setup:", error);
        document.getElementById('loadingSpinner').style.display = 'none';
        document.getElementById('createAccountButton').disabled = false;
        alert("Ada masalah dalam menyiapkan bunga Anda. Silakan coba lagi.");
      }
    });
    
    async function captureFlower() {
      try {
        const captureContainer = document.getElementById('flowerCaptureContainer');
        
        updateCaptureStyles(currentTheme);
        
        if (typeof html2canvas !== 'function') {
          console.error("html2canvas not loaded or not available as a function");
          alert("Tidak dapat menangkap bunga. Perpustakaan penangkapan tidak dimuat.");
          return;
        }
        
        let bgColor = 'white';
        if (currentTheme === 'red-black') bgColor = 'black';
        else if (currentTheme === 'green-blue') bgColor = '#1A2E4D';
        else if (currentTheme === 'orange-pink' || currentTheme === 'yellow-purple') bgColor = '#4B0082';
        
        const canvas = await html2canvas(captureContainer, {
          backgroundColor: bgColor,
          scale: 7,
          logging: true,
          useCORS: true,
          allowTaint: true,
          letterRendering: true
        });
        
        const imageUrl = canvas.toDataURL('image/png');
        
        const capturedImage = document.getElementById('capturedImage');
        if (capturedImage) {
          capturedImage.src = imageUrl;
          document.getElementById('capturedFlower').style.display = 'flex';
          document.getElementById('shareWarning').style.display = 'block';
          
          updateShareCount();
        } else {
          console.error("capturedImage element not found");
        }
      } catch (error) {
        console.error('Error capturing flower:', error);
        alert('Tidak dapat menangkap bunga Anda. Silakan coba lagi.');
      }
    }
    
    document.getElementById('shareCapture').addEventListener('click', function() {
      const imageUrl = document.getElementById('capturedImage').src;
if (navigator.share) {
        fetch(imageUrl)
          .then(res => res.blob())
          .then(blob => {
            const file = new File([blob], 'my-gz-flower.png', { type: 'image/png' });
            navigator.share({
              title: 'Bunga G-Z Saya',
              text: 'Temukan milikmu di g-z.online',
              files: [file]
            }).catch(err => {
              console.log('Error sharing:', err);
              fallbackShare();
            });
          })
          .catch(err => {
            console.log('Error preparing image:', err);
            fallbackShare();
          });
      } else {
        fallbackShare();
      }
    });
    
    function fallbackShare() {
      try {
        const shareText = `
Lihat Bunga Kehidupan saya dari G-Z: ${userUniqueId}. Temukan milikmu di g-z.online`;
        
        navigator.clipboard.writeText(shareText).then(function() {
          alert('Teks berbagi disalin ke clipboard!');
        }).catch(function() {
          alert('Tidak dapat menyalin teks berbagi.');
        });
      } catch (error) {
        console.error('Fallback share error:', error);
        alert('Terjadi kesalahan.');
      }
    }
    
    document.getElementById('closeCapture').addEventListener('click', function() {
      const imageUrl = document.getElementById('capturedImage').src;
      
      // Create an invisible anchor element to download the image
      const downloadLink = document.createElement('a');
      downloadLink.href = imageUrl;
      downloadLink.download = 'bunga-gz.png';
      document.body.appendChild(downloadLink);
      downloadLink.click();
      document.body.removeChild(downloadLink);
      
      // Close the captured flower display
      document.getElementById('capturedFlower').style.display = 'none';
    });
    
    document.getElementById('closeFlowerModal').addEventListener('click', function() {
      const flowerModal = document.getElementById('flowerModal');
      flowerModal.classList.remove('show');
      setTimeout(() => {
        flowerModal.style.display = 'none';
        document.getElementById('shareFlowerButton').style.display = 'none';
      }, 300);
    });

    window.onclick = function(event) {
      const flowerModal = document.getElementById('flowerModal');
      const capturedFlower = document.getElementById('capturedFlower');
      const idModal = document.getElementById('idModal');
      const welcomeModal = document.getElementById('welcomeModal');
      
      if (event.target == flowerModal) {
        flowerModal.classList.remove('show');
        setTimeout(() => {
          flowerModal.style.display = "none";
          document.getElementById('shareFlowerButton').style.display = 'none';
        }, 300);
      }
      
      if (event.target == capturedFlower) {
        capturedFlower.style.display = "none";
      }
      
      if (event.target == idModal) {
        idModal.classList.remove('show');
        setTimeout(() => {
          idModal.style.display = "none";
        }, 300);
      }
      
      if (event.target == welcomeModal && isInstalled) {
        welcomeModal.classList.remove('show');
        setTimeout(() => {
          welcomeModal.style.display = "none";
        }, 300);
      }
    };
    
    document.getElementById('shareFlowerButton').style.display = 'none';
    document.getElementById('shareWarning').style.display = 'none';
    
    document.querySelectorAll('.style-option').forEach(option => {
      option.addEventListener('click', function() {
        const theme = this.dataset.theme;
        setTheme(theme);
      });
    });
  </script>
</body>
